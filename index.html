<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=Pops:wght@300;400;600;700;800&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
  <title>JAMIASTO - Mapa: toalety, wodopoje, bankomaty, apteki, skateparki i place zabaw </title>
  <link rel="manifest" href="./manifest.json">
<meta name="theme-color" content="#0d6efd">

  <style>
    :root {
      --primary-blue: #1976d2;
      --primary-red: #d32f2f;
      --primary-green: #2e7d32;
      --primary-orange: #f57c00;
      --primary-purple: #7b1fa2;
     --primary-brown: brown;
     --primary-yellow: #ffc107;
      --text-gray: #333;
      --bg-light: #f8f9fa;
      --border-light: #e0e0e0;
      --shadow: 0 4px 20px rgba(0,0,0,0.1);
      --shadow-hover: 0 8px 30px rgba(0,0,0,0.15);
      --gradient-poland: linear-gradient(135deg, #d32f2f 0%, #1976d2 100%);
      --gradient-bg: linear-gradient(135deg, #f8f9fa 0%, #e3f2fd 100%);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', sans-serif;
      background: var(--gradient-bg);
      color: var(--text-gray);
      line-height: 1.6;
      min-height: 100vh;
    }

    h1, h2, h3, h4, h5, h6 {
      font-family: 'Pops', sans-serif;
    }

    /* Header Styles */
    .hero-header {
      background: var(--gradient-poland);
      position: relative;
      overflow: hidden;
      padding: 3rem 0;
      text-align: center;
      color: white;
    }

    .hero-header::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(45deg, transparent 48%, rgba(255,255,255,0.05) 50%, transparent 52%);
      background-size: 20px 20px;
    }

    .jamiasto-title {
      font-family: 'Pops', sans-serif;
      font-size: 3.5rem;
      font-weight: 800;
      background: linear-gradient(45deg, #FFFFFF, #F0F0F0);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-shadow: 0 4px 8px rgba(0,0,0,0.3);
      letter-spacing: -0.02em;
      position: relative;
      z-index: 10;
      margin-bottom: 0.5rem;
    }

    .subtitle {
      font-size: 1.2rem;
      opacity: 0.9;
      position: relative;
      z-index: 10;
      max-width: 600px;
      margin: 0 auto 2rem;
    }

    .hero-features {
      display: flex;
      justify-content: center;
      gap: 2rem;
      margin-top: 2rem;
      flex-wrap: wrap;
      position: relative;
      z-index: 10;
    }

    .hero-feature {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 1rem;
      opacity: 0.9;
    }

    /* Container */
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 1.5rem;
    }

    /* Modern Card */
    .modern-card {
      background: white;
      border-radius: 2rem;
      box-shadow: var(--shadow);
      padding: 2rem;
      margin: 2rem 0;
      border: 1px solid rgba(255,255,255,0.8);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .modern-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 5px;
      background: var(--gradient-poland);
    }

    .modern-card:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-hover);
    }

    /* Section Headers */
    .section-header {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 2rem;
    }

    .section-icon {
      font-size: 2rem;
      color: var(--primary-blue);
    }

    .section-title {
      font-size: 1.4rem;
      font-weight: 700;
      color: var(--text-gray);
      margin: 0;
    }

    /* Voivodeship Grid */
    .voivodeship-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }

    .voivodeship-card {
      background: lavender;
      border-radius: 1.5rem;
      overflow: hidden;
      box-shadow: var(--shadow);
      transition: all 0.3s ease;
      cursor: pointer;
      position: relative;
      min-height: 160px;
      border: 2px solid transparent;
    }

    .voivodeship-card:hover {
      transform: translateY(-8px);
      box-shadow: var(--shadow-hover);
      border-color: var(--primary-blue);
    }


    .voivodeship-image {
      width: 100%;
      height: 0px;
      object-fit: cover;
      transition: transform 0.3s ease;
    }

    .voivodeship-card:hover .voivodeship-image {
      transform: scale(1.05);
    }

    .voivodeship-content {
      padding: 1.5rem;
    }

    .voivodeship-name {
      font-family: 'Pops', sans-serif;
      font-size: 1.2rem;
      font-weight: 600;
      color: var(--text-gray);
      margin-bottom: 0.5rem;
    }

    .voivodeship-cities {
      font-size: 0.9rem;
      color: #666;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    /* City Grid */
    .city-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
      max-height: 400px;
      overflow-y: auto;
      padding: 0.5rem;
    }

    .city-card {
      background: white;
      border: 2px solid var(--border-light);
      border-radius: 1rem;
      padding: 1.2rem;
      transition: all 0.3s ease;
      cursor: pointer;
      text-align: center;
      font-weight: 500;
      color: var(--text-gray);
      position: relative;
      overflow: hidden;
    }

    .city-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(25, 118, 210, 0.1), transparent);
      transition: left 0.5s ease;
    }

    .city-card:hover::before {
      left: 100%;
    }

    .city-card:hover {
      background: linear-gradient(135deg, var(--primary-blue), #1565c0);
      color: white;
      border-color: var(--primary-blue);
      transform: translateY(-4px);
      box-shadow: var(--shadow);
    }

    /* Improved Buttons */
    .modern-btn {
      padding: 1rem 2rem;
      border-radius: 1rem;
      font-weight: 600;
      font-size: 1rem;
      transition: all 0.3s ease;
      border: none;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      text-decoration: none;
      position: relative;
      overflow: hidden;
      min-height: 48px;
    }

    .modern-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      transition: left 0.5s ease;
    }

    .modern-btn:hover::before {
      left: 100%;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--primary-blue), #1565c0);
      color: white;
      box-shadow: 0 4px 15px rgba(25, 118, 210, 0.3);
    }

    .btn-primary:hover {
      background: linear-gradient(135deg, #1565c0, #0d47a1);
      transform: translateY(-2px);
      box-shadow: 0 6px 25px rgba(25, 118, 210, 0.4);
    }

    .btn-secondary {
      background: white;
      color: var(--text-gray);
      border: 2px solid var(--border-light);
      box-shadow: var(--shadow);
    }

    .btn-secondary:hover {
      background: var(--bg-light);
      border-color: var(--primary-blue);
      color: var(--primary-blue);
      transform: translateY(-2px);
    }

    /* Improved Green Button */
    .btn-success {
      background: linear-gradient(135deg, var(--primary-green), #1b5e20);
      color: white;
      box-shadow: 0 4px 15px rgba(46, 125, 50, 0.3);
    }

    .btn-success:hover {
      background: linear-gradient(135deg, #1b5e20, #0d4a11);
      transform: translateY(-2px);
      box-shadow: 0 6px 25px rgba(46, 125, 50, 0.4);
    }

    /* Improved Red Button */
    .btn-danger {
      background: linear-gradient(135deg, var(--primary-red), #b71c1c);
      color: white;
      box-shadow: 0 4px 15px rgba(211, 47, 47, 0.3);
    }

    .btn-danger:hover {
      background: linear-gradient(135deg, #b71c1c, #8e0000);
      transform: translateY(-2px);
      box-shadow: 0 6px 25px rgba(211, 47, 47, 0.4);
    }

    .geolocation-btn {
      background: linear-gradient(135deg, var(--primary-green), #1b5e20);
      color: white;
      border: none;
      padding: 1.2rem 2rem;
      border-radius: 1.2rem;
      cursor: pointer;
      font-size: 1.1rem;
      font-weight: 600;
      width: 100%;
      margin-bottom: 1.5rem;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.8rem;
      box-shadow: 0 4px 15px rgba(46, 125, 50, 0.3);
      position: relative;
      overflow: hidden;
    }

    .geolocation-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      transition: left 0.5s ease;
    }

    .geolocation-btn:hover::before {
      left: 100%;
    }

    .geolocation-btn:hover:not(:disabled) {
      background: linear-gradient(135deg, #1b5e20, #0d4a11);
      transform: translateY(-2px);
      box-shadow: 0 6px 25px rgba(46, 125, 50, 0.4);
    }

    .geolocation-btn:disabled {
      background: linear-gradient(135deg, #ccc, #aaa);
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    /* Back Button */
    .back-btn {
      background: var(--bg-light);
      border: 2px solid var(--border-light);
      border-radius: 0.8rem;
      padding: 0.5rem 1rem;
      cursor: pointer;
      font-size: 0.9rem;
      transition: all 0.3s ease;
      color: var(--text-gray);
    }

    .back-btn:hover {
      background: white;
      border-color: var(--primary-blue);
      color: var(--primary-blue);
    }

    /* Action Grid */
    .action-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
      margin-top: 1rem;
    }

    /* Info Box */
    .info-box {
      background: linear-gradient(135deg, #e3f2fd, #bbdefb);
      border: 2px solid #1976d2;
      border-radius: 1rem;
      padding: 1.5rem;
      margin-top: 2rem;
      color: #1565c0;
      font-size: 0.95rem;
    }

    /* Filter Panel */
    .filter-panel {
      background: linear-gradient(135deg, #f8f9fa, #ffffff);
      border: 2px solid #e3f2fd;
      border-radius: 2rem;
      padding: 2rem;
      margin: 2rem 0;
    }

    .filter-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
      flex-wrap: wrap;
      gap: 1rem;
    }

    .filter-title {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--text-gray);
      margin: 0;
      display: flex;
      align-items: center;
      gap: 0.8rem;
    }

    .filter-controls {
      display: flex;
      gap: 0.8rem;
      flex-wrap: wrap;
    }

    .filter-btn {
      padding: 0.6rem 1.2rem;
      border: none;
      border-radius: 0.8rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 0.9rem;
      position: relative;
      overflow: hidden;
    }

    .filter-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
      transition: left 0.5s ease;
    }

    .filter-btn:hover::before {
      left: 100%;
    }

    .filter-all-btn {
      background: linear-gradient(135deg, var(--primary-green), #1b5e20);
      color: white;
      box-shadow: 0 4px 12px rgba(46, 125, 50, 0.3);
    }

    .filter-none-btn {
      background: linear-gradient(135deg, var(--primary-red), #b71c1c);
      color: white;
      box-shadow: 0 4px 12px rgba(211, 47, 47, 0.3);
    }

    .filter-all-btn:hover, .filter-none-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 6px 16px rgba(0,0,0,0.3);
    }

    .filter-all-btn:hover {
      background: linear-gradient(135deg, #1b5e20, #0d4a11);
    }

    .filter-none-btn:hover {
      background: linear-gradient(135deg, #b71c1c, #8e0000);
    }

    .filter-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1rem;
    }

    .filter-item {
      background: white;
      border: 2px solid var(--border-light);
      border-radius: 1.2rem;
      padding: 1.2rem;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 1rem;
      position: relative;
      user-select: none;
    }

    .filter-item:hover {
      border-color: var(--primary-blue);
      background: #f8f9fa;
      transform: translateY(-2px);
    }

    .filter-item.active {
      border-color: var(--primary-blue);
      background: linear-gradient(135deg, #e3f2fd, #f8f9fa);
      box-shadow: 0 4px 15px rgba(25, 118, 210, 0.2);
    }

    .filter-checkbox {
      width: 24px;
      height: 24px;
      border: 2px solid #ccc;
      border-radius: 0.5rem;
      background: white;
      position: relative;
      flex-shrink: 0;
      transition: all 0.3s;
    }

    .filter-item.active .filter-checkbox {
      background: var(--primary-blue);
      border-color: var(--primary-blue);
    }

    .filter-item.active .filter-checkbox::after {
      content: '‚úì';
      color: white;
      font-weight: bold;
      font-size: 14px;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }

    .filter-icon {
      font-size: 2rem;
      flex-shrink: 0;
    }

    .filter-info {
      flex: 1;
    }

    .filter-name {
      font-weight: 600;
      font-size: 1rem;
      margin-bottom: 0.2rem;
    }

    .filter-count {
      font-size: 0.8rem;
      color: #666;
    }

    /* Map Section */
    .map-container {
      height: 70vh;
      min-height: 500px;
      border-radius: 1.5rem;
      border: 1px solid var(--border-light);
      box-shadow: var(--shadow);
      overflow: hidden;
    }

    .legend {
      background: white;
      border: 2px solid var(--border-light);
      border-radius: 1.2rem;
      padding: 1.5rem;
      margin-top: 1rem;
      box-shadow: var(--shadow);
    }

    .legend-title {
      font-weight: 600;
      margin-bottom: 1rem;
      color: var(--text-gray);
      font-size: 1.1rem;
    }

    .legend-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 0.8rem;
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 0.8rem;
      font-weight: 500;
      font-size: 0.95rem;
    }

    .legend-icon {
      font-size: 1.2rem;
    }

    /* Modal Styles */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(4px);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      padding: 1rem;
    }

    .modal-overlay.show {
      display: flex;
    }

    .modal-content {
      background: white;
      border-radius: 2rem;
      max-width: 600px;
      width: 100%;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      position: relative;
    }

    .modal-header {
      padding: 2rem 2rem 0;
      border-bottom: 2px solid #f0f0f0;
      margin-bottom: 1.5rem;
    }

    .modal-title {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--text-gray);
      margin: 0 0 1rem 0;
      display: flex;
      align-items: center;
      gap: 0.8rem;
    }

    .modal-body {
      padding: 0 2rem 2rem;
    }

    .close-btn {
      position: absolute;
      top: 1rem;
      right: 1rem;
      background: #f5f5f5;
      border: none;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      color: #666;
    }

    .close-btn:hover {
      background: #e0e0e0;
      color: var(--primary-red);
      transform: scale(1.1);
    }

    /* Form Styles */
    .form-group {
      margin-bottom: 1.5rem;
    }

    .form-label {
      display: block;
      font-weight: 600;
      margin-bottom: 0.5rem;
      color: var(--text-gray);
      font-size: 1rem;
    }

    .form-input, .form-textarea {
      width: 100%;
      padding: 1rem;
      border: 2px solid var(--border-light);
      border-radius: 0.8rem;
      font-size: 1rem;
      transition: all 0.3s ease;
      font-family: inherit;
    }

    .form-input:focus, .form-textarea:focus {
      outline: none;
      border-color: var(--primary-blue);
      box-shadow: 0 0 0 3px rgba(25, 118, 210, 0.1);
    }

    .form-textarea {
      min-height: 120px;
      resize: vertical;
    }

    .status-buttons {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 1rem;
      margin-top: 0.5rem;
    }

    .status-btn {
      padding: 1rem;
      border: 2px solid var(--border-light);
      border-radius: 1rem;
      background: white;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: center;
      font-weight: 600;
      position: relative;
      overflow: hidden;
    }

    .status-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
      transition: left 0.5s ease;
    }

    .status-btn:hover::before {
      left: 100%;
    }

    .status-btn:hover {
      border-color: var(--primary-blue);
      background: #f8f9fa;
      transform: translateY(-2px);
    }

    .status-btn.active.working {
      background: linear-gradient(135deg, #e8f5e8, #c8e6c9);
      border-color: var(--primary-green);
      color: var(--primary-green);
    }

    .status-btn.active.needs-repair {
      background: linear-gradient(135deg, #fff3e0, #ffe0b2);
      border-color: var(--primary-orange);
      color: var(--primary-orange);
    }

    .status-btn.active.not-working {
      background: linear-gradient(135deg, #ffebee, #ffcdd2);
      border-color: var(--primary-red);
      color: var(--primary-red);
    }

    .error-message {
      background: linear-gradient(135deg, #ffebee, #ffcdd2);
      border: 2px solid #f44336;
      border-radius: 1rem;
      padding: 1rem;
      margin: 1rem 0;
      color: #c62828;
      display: flex;
      align-items: center;
      gap: 1rem;
      font-size: 0.9rem;
    }

    .error-icon {
      font-size: 1.2rem;
      color: #f44336;
    }

    .char-counter {
      text-align: right;
      font-size: 0.8rem;
      color: #666;
      margin-top: 0.5rem;
    }

    .char-counter.warning {
      color: var(--primary-orange);
    }

    .char-counter.danger {
      color: var(--primary-red);
    }

    /* Comments Display */
    .comments-section {
      margin-top: 1rem;
      padding: 1rem;
      background: #f8f9fa;
      border-radius: 1rem;
      border: 1px solid var(--border-light);
    }

    .comments-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }

    .comments-title {
      font-weight: 600;
      color: var(--text-gray);
      font-size: 1rem;
    }

    .comment-item {
      background: white;
      border-radius: 0.8rem;
      padding: 1rem;
      margin-bottom: 0.8rem;
      border: 1px solid var(--border-light);
    }

    .comment-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.5rem;
    }

    .comment-author {
      font-weight: 600;
      color: var(--text-gray);
    }

    .comment-status {
      padding: 0.3rem 0.8rem;
      border-radius: 0.5rem;
      font-size: 0.8rem;
      font-weight: 600;
    }

    .comment-status.working {
      background: #e8f5e8;
      color: var(--primary-green);
    }

    .comment-status.needs-repair {
      background: #fff3e0;
      color: var(--primary-orange);
    }

    .comment-status.not-working {
      background: #ffebee;
      color: var(--primary-red);
    }

    .comment-text {
      color: #555;
      line-height: 1.5;
      margin-bottom: 0.5rem;
    }

    .comment-date {
      color: #888;
      font-size: 0.8rem;
    }

    /* Loading */
    .loading-overlay {
      position: fixed;
      inset: 0;
      background: rgba(255, 255, 255, 0.95);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1001;
      flex-direction: column;
      gap: 1rem;
    }

    .loading-overlay.show {
      display: flex;
    }

    .sner {
      width: 40px;
      height: 40px;
      border: 4px solid #e3f2fd;
      border-top: 4px solid var(--primary-blue);
      border-radius: 50%;
      animation: s 1s linear infinite;
    }

    @keyframes s {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .loading-text {
      font-weight: 600;
      color: var(--primary-blue);
      font-size: 1.1rem;
    }

    /* Ukrywanie element√≥w */
    .hidden {
      display: none !important;
    }

    /* Toast notifications */
    .toast {
      position: fixed;
      top: 2rem;
      right: 2rem;
      background: linear-gradient(135deg, #1976d2, #1565c0);
      color: white;
      padding: 1rem 1.5rem;
      border-radius: 1rem;
      box-shadow: 0 8px 32px rgba(25, 118, 210, 0.3);
      z-index: 1002;
      transform: translateX(100%);
      transition: transform 0.3s ease;
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      max-width: 400px;
    }

    /* NEW: Navigation Styles */
    .nav-option-btn {
      background: #f8f9fa;
      border: 2px solid #e9ecef;
      border-radius: 0.8rem;
      padding: 0.8rem;
      cursor: pointer;
      font-family: 'Inter', sans-serif;
      font-weight: 500;
      font-size: 0.9rem;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
    }

    .nav-option-btn:hover {
      background: #e9ecef;
      border-color: #adb5bd;
    }

    .nav-option-btn.active {
      background: #1976d2;
      color: white;
      border-color: #1976d2;
    }

    .nav-option-btn i {
      font-size: 1.1rem;
    }

    .direction-step {
      display: flex;
      align-items: flex-start;
      gap: 1rem;
      padding: 1rem;
      border-bottom: 1px solid #f0f0f0;
      background: white;
      transition: background-color 0.2s ease;
    }

    .direction-step:hover {
      background: #f8f9fa;
    }

    .direction-step:last-child {
      border-bottom: none;
    }

    .step-icon {
      background: #1976d2;
      color: white;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8rem;
      flex-shrink: 0;
      margin-top: 0.2rem;
    }

    .step-content {
      flex: 1;
    }

    .step-instruction {
      font-weight: 500;
      color: #333;
      line-height: 1.4;
      margin-bottom: 0.3rem;
    }

    .step-distance {
      color: #666;
      font-size: 0.8rem;
    }

    .route-polyline {
      stroke: #1976d2;
      stroke-width: 4;
      stroke-opacity: 0.8;
      fill: none;
    }

    /* Mobile Responsive */
    @media (max-width: 768px) {
      .jamiasto-title {
        font-size: 2.5rem;
      }

      .modern-card {
        padding: 1.5rem;
        margin: 1rem 0;
        border-radius:2rem;
      }

      .container {
        padding: 0 1rem;
      }

      .hero-header {
        padding: 1rem 0;
      }

      .voivodeship-grid {
        grid-template-columns: 1fr;
        gap: 1rem;
      }

      .city-grid {
        grid-template-columns: 1fr;
      }

      .action-grid {
        grid-template-columns: 1fr;
      }

      .filter-header {
        flex-direction: column;
        align-items: stretch;
      }

      .filter-grid {
        grid-template-columns: 1fr;
      }

      .legend-grid {
        grid-template-columns: 1fr;
      }

      .hero-features {
        flex-direction: column;
        gap: 1rem;
      }

      .status-buttons {
        grid-template-columns: 1fr;
      }

      .modal-content {
        margin: 1rem;
        border-radius: 1.5rem;
      }

      .modal-header, .modal-body {
        padding-left: 1.5rem;
        padding-right: 1.5rem;
      }
    }
   /* make .hidden actually hide elements */
.hidden { display: none !important; }
 /* ATRAKCJE: modal i emoji marker */
.attractions-modal {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.65);
  backdrop-filter: blur(3px);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10010;
  padding: 1rem;
}
.attractions-modal .modal-card {
  background: #fff;
  border-radius: 12px;
  max-width: 780px;
  width: 100%;
  max-height: 82vh;
  overflow: auto;
  position: relative;
  box-shadow: 0 16px 40px rgba(0,0,0,0.25);
}
.attractions-modal .modal-card .close-btn {
  position: absolute;
  right: 20px;
  top: 12px;
  border: none;
  background: #f5f5f5;
  width: 34px;
  height: 34px;
  border-radius: 50%;
  cursor: pointer;
  font-size: 20px;
}
.attractions-list-section { padding: 1rem 1.25rem; }
.attractions-section-title { display:flex; justify-content:space-between; align-items:center; gap:0.75rem; margin-bottom:0.5rem; }
.attraction-list { list-style:none; padding:0; margin:0 0 1rem 0; }
.attraction-list li { padding: 0.45rem 0.5rem; border-radius:8px; cursor:pointer; display:flex; justify-content:space-between; align-items:center; gap:0.6rem;}
.attraction-list li:hover { background:#f6f8fb; }
.attraction-emoji { font-size:28px; line-height:1; }
  </style>

<style>
.attractions-list-section {
  margin: 0.3rem !important;
  padding: 0.6rem 0 !important; /* oddech g√≥ra/d√≥≈Ç */
  border-bottom: 1px solid #eee;
}
.attractions-list-section:last-child {
  border-bottom: none;
}
.attraction-list {
  margin: 0.3rem !important;
  padding: 0 !important;
}
</style>

</head>
<body>
  <!-- Enhanced Header -->
 <header class="hero-header" id="main-header">
    <div class="container">
      <h1 class="jamiasto-title">JAMIASTO</h1>
      <p class="subtitle">Najwa≈ºniejsze punkty w twoim mie≈õcie w jednym miejscu</p>
      <div class="hero-features">
        <div class="hero-feature">
          <i class="fas fa-map-marked-alt"></i>
          <span>Lokalizacje</span>
        </div>
     
        <div class="hero-feature">
          <i class="fas fa-filter"></i>
          <span>Filtry</span>
           </div>
        <button id="geo-btn" onclick="getUserLocation()" 
    style="
      background: #1569C7;
      color: #fff;
      border: none;
      padding: 12px 20px;
      font-size: 16px;
      font-weight: 600;
      border-radius: 8px;
      cursor: pointer;
      box-shadow: 0 3px 8px rgba(0,0,0,0.2);
      transition: background 0.2s ease;
    "
    onmouseover="this.style.background='#1259a5'"
    onmouseout="this.style.background='#1976d2'">
    üìç Okre≈õl mojƒÖ lokalizacjƒô
  </button>
  <div id="location-text" style="margin-top:8px; font-size:14px; color:#555;"></div>
      </div>
    </div>
  </header>
<div style="text-align:center; margin:20px 0;">

</div>
    <!-- Location Selection Card -->
    <div class="modern-card">
      <div class="section-header">
        <i class="fas fa-location-arrow section-icon"></i>
        <h2 class="section-title">Wyb√≥r lokalizacji</h2>
      </div>
      
      <!-- NEW: Quick Search Section -->
      <div class="search-section" style="margin-bottom: 2rem;">
        <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
   
      </div>
       <div style="display: flex; align-items: center; justify-content: space-between; gap: 0.5rem; margin-bottom: 1rem;">
<div style="display: flex; align-items: center; justify-content: space-between; gap: 0.5rem; margin-bottom: 1rem;">
  <div style="display: flex; align-items: center; gap: 0.5rem;">
    <i class="fas fa-search" style="color: #1976d2;"></i>
    <h3 style="font-size: 1.1rem; color: #555; margin: 0; font-weight: 600;">Szybkie wyszukiwanie</h3>
  </div>

  <!-- PRZYCISK STRONA G≈Å√ìWNA (ukryty na starcie) -->
  <button id="home-btn" onclick="goHome()" 
    style="padding: 0.4rem 0.8rem; font-size: 0.8rem; border:none; border-radius:6px; background:#d32f2f; color:white; cursor:pointer;">
    <i class="fas fa-home"></i> Strona g≈Ç√≥wna
  </button>
</div>
</div>
        <div class="search-container" style="position: relative; margin-bottom: 1rem;">
          <input 
            type="text" 
            id="city-search" 
            class="search-input" 
            placeholder="Wpisz nazwƒô miasta (np. Warszawa, Krak√≥w, Gda≈Ñsk...)"
            style="width: 100%; padding: 1rem 3rem 1rem 1rem; border: 2px solid #e0e0e0; border-radius: 1rem; font-size: 1rem; transition: all 0.3s ease; outline: none;"
            oninput="searchCities(this.value)"
            onfocus="this.style.borderColor='#1976d2'; this.style.boxShadow='0 0 0 3px rgba(25,118,210,0.1)'"
            onblur="this.style.borderColor='#e0e0e0'; this.style.boxShadow='none'"
          />
          <i class="fas fa-search" style="position: absolute; right: 1rem; top: 50%; transform: translateY(-50%); color: #999;"></i>
        </div>
        <div id="search-results" style="display: none; max-height: 300px; overflow-y: auto; border: 1px solid #e0e0e0; border-radius: 0.8rem; background: white; box-shadow: 0 4px 12px rgba(0,0,0,0.1);"></div>
        <div style="text-align: center; margin: 1rem 0; color: #888; font-size: 0.9rem;">
          <i class="fas fa-info-circle" style="margin-right: 0.3rem;"></i>
          Lub wybierz z poni≈ºszych opcji tradycyjnie
        </div>
      </div>
<!-- PRZYCISK PO HERO HEADER -->
<div class="container" style="text-align:center; margin: 2rem 0;">
  <button id="installBtn" style="
    padding: 1rem 2rem;
    font-size: 1.5rem;
    border:none;
    border-radius:8px;
    background-color:#1976d2;
    color:white;
    cursor:pointer;
    display:none; /* ukryty domy≈õlnie */
  ">
    üì≤ Pobierz aplikacjƒô
  </button>
</div>
  <div class="container">
      <!-- Voivodeships Section -->
      <div id="voivodeship-section">
        <h3 style="font-size: 1.3rem; margin-bottom: 1.1rem; color: #555;">Wybierz wojew√≥dztwo</h3>
        <div class="voivodeship-grid" id="voivodeship-grid">
          <!-- Wojew√≥dztwa bƒôdƒÖ wygenerowane przez JavaScript -->
        </div>
      </div>

      <!-- Cities Section -->
      <div id="city-section" class="hidden">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; flex-wrap: wrap; gap: 1rem;">
          <h3 id="city-title" style="font-size: 1.3rem; color: #555; margin: 0;"></h3>
          <button class="back-btn" onclick="showVoivodeshipSelection()">
            <i class="fas fa-arrow-left"></i> Powr√≥t
          </button>
        </div>
        <div class="city-grid" id="city-grid">
          <!-- Miasta bƒôdƒÖ wygenerowane przez JavaScript -->
       
        </div>
      </div>

      <!-- Selected City Section -->
      <div id="selected-section" class="hidden">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; flex-wrap: wrap; gap: 1rem;">
          <h3 id="selected-title" style="font-size: 1.3rem; color: #555; margin: 0;"></h3>
          <button class="back-btn" onclick="showCitySelection()">
            <i class="fas fa-arrow-left"></i> Powr√≥t
          </button>
        </div>
        
        <!-- Geolocation Button -->
        <button class="geolocation-btn" onclick="getUserLocation()">
          <i class="fas fa-location-crosshairs"></i>
          <span id="location-text">Okre≈õl swojƒÖ lokalizacjƒô</span>
        </button>
        
        <div id="location-error" style="display: none;" class="error-message">
          <i class="fas fa-exclamation-triangle error-icon"></i>
          <span></span>
        </div>
        
        <div class="action-grid">
          <button id="show-city-btn" class="modern-btn btn-primary" onclick="showCityOnMap()">
            <i class="fas fa-map"></i> PodglƒÖd miasta
          </button>
          <button id="reset-view-btn" class="modern-btn btn-secondary" onclick="resetMapView()">
            <i class="fas fa-refresh"></i> Resetuj widok
          </button>
        </div>
      </div>

      <!-- Info Box -->
      <div class="info-box">
        <i class="fas fa-info-circle" style="margin-right: 0.5rem;"></i>
        Dane pobierane sƒÖ z <strong>OpenStreetMap (Overpass API)</strong>. 
        Informacje mogƒÖ r√≥≈ºniƒá siƒô od rzeczywistego stanu. 
      
      </div>
    </div>
<head>
  <meta charset="UTF-8">
  <title>Twoja strona</title>
  
  <!-- Filter Panel -->


    <!-- Zawarto≈õƒá panelu (ukrywana/pokazywana) -->
    <div id="filter-content" style="display: none;">
      <div class="filter-controls">
        <button class="filter-btn filter-all-btn" onclick="selectAllFilters(); event.stopPropagation();">
          <i class="fas fa-check-double"></i> Zaznacz wszystkie
        </button>
        <button class="filter-btn filter-none-btn" onclick="deselectAllFilters(); event.stopPropagation();">
          <i class="fas fa-times"></i> Odznacz wszystkie
        </button>
      </div>
      
      <div id="filter-status" style="display: none; background: #e3f2fd; border: 2px solid #1976d2; border-radius: 0.8rem; padding: 1rem; margin-bottom: 1.5rem; color: #1565c0; font-weight: 500; text-align: center;">
        Pokazujƒô <span id="active-filters-count">0</span> z <span id="total-filters-count">6</span> kategorii punkt√≥w
      </div>

      <div class="filter-grid" id="filter-grid">
        <div class="filter-item active" data-type="drinking_water" onclick="toggleFilter('drinking_water')">
          <div class="filter-checkbox"></div>
          <div class="filter-icon" style="color: #2196f3;">üíß</div>
          <div class="filter-info">
            <div class="filter-name">wodopoje</div>
            <div class="filter-count">0 punkt√≥w</div>
          </div>
        </div>

        <div class="filter-item active" data-type="toilets_free" onclick="toggleFilter('toilets_free')">
          <div class="filter-checkbox"></div>
          <div class="filter-icon" style="color: #4caf50;">üöΩ</div>
          <div class="filter-info">
            <div class="filter-name">Toalety bezp≈Çatne</div>
            <div class="filter-count">0 punkt√≥w</div>
          </div>
        </div>

        <div class="filter-item active" data-type="toilets_paid" onclick="toggleFilter('toilets_paid')">
          <div class="filter-checkbox"></div>
          <div class="filter-icon" style="color: #f44336;">üöæ</div>
          <div class="filter-info">
            <div class="filter-name">Toalety p≈Çatne</div>
            <div class="filter-count">0 punkt√≥w</div>
          </div>
        </div>

        <div class="filter-item active" data-type="toilets_unknown" onclick="toggleFilter('toilets_unknown')">
          <div class="filter-checkbox"></div>
          <div class="filter-icon" style="color: #9e9e9e;">üöª</div>
          <div class="filter-info">
            <div class="filter-name">Toalety (brak info)</div>
            <div class="filter-count">0 punkt√≥w</div>
          </div>
        </div>

        <div class="filter-item active" data-type="atm" onclick="toggleFilter('atm')">
          <div class="filter-checkbox"></div>
          <div class="filter-icon" style="color: #ff9800;">üèß</div>
          <div class="filter-info">
            <div class="filter-name">Bankomaty</div>
            <div class="filter-count">0 punkt√≥w</div>
          </div>
        </div>

        <div class="filter-item active" data-type="pharmacy" onclick="toggleFilter('pharmacy')">
          <div class="filter-checkbox"></div>
          <div class="filter-icon" style="color: #9c27b0;">üíä</div>
          <div class="filter-info">
            <div class="filter-name">Apteki</div>
            <div class="filter-count">0 punkt√≥w</div>
          </div>
        </div>
                <div class="filter-item active" data-type="skatepark" onclick="toggleFilter('skatepark')">
          <div class="filter-checkbox"></div>
          <div class="filter-icon" style="color: #795548;">üõπ</div>
          <div class="filter-info">
            <div class="filter-name">Skateparki</div>
            <div class="filter-count">0 punkt√≥w</div>
          </div>
        </div>

        <div class="filter-item active" data-type="playground" onclick="toggleFilter('playground')">
          <div class="filter-checkbox"></div>
          <div class="filter-icon" style="color: #ffc107;">üõù</div>
          <div class="filter-info">
            <div class="filter-name">Place zabaw</div>
            <div class="filter-count">0 punkt√≥w</div>
          </div>
          </div>
          <div class="filter-item active" data-type="restaurant" onclick="toggleFilter('restaurant')">
          <div class="filter-checkbox"></div>
          <div class="filter-icon" style="color: #ff9800;">üçΩ</div>
          <div class="filter-info">
            <div class="filter-name">restauracje</div>
            <div class="filter-count">0 punkt√≥w</div>
           </div>
          </div>
          </div>
        </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
function toggleFilterPanel() {
  const content = document.getElementById("filter-content");
  const arrow = document.getElementById("filter-arrow");

  if (content.style.display === "none") {
    content.style.display = "block";
    arrow.classList.remove("fa-chevron-down");
    arrow.classList.add("fa-chevron-up");
  } else {
    content.style.display = "none";
    arrow.classList.remove("fa-chevron-up");
    arrow.classList.add("fa-chevron-down");
  }
}
</script>

  <!-- Map Section -->
<div class="modern-card" id="map-card" style="display: none; position: relative;">
  <div class="section-header">
    <i class="fas fa-map section-icon"></i>
    <h2 class="section-title">Interaktywna mapa</h2>
  </div>

  <!-- Kontener mapy z absolutnymi elementami w ≈õrodku -->
  <div id="map" class="map-container" style="position: relative;">

    <!-- Floating Filter Button (prawy d√≥≈Ç mapy) -->
    <button id="open-filter-btn" onclick="openFilterPanel()" style="
      position: absolute;
      bottom: 120px;
      right: 0px;
      z-index: 1000;
      background: white;
      border: 2px solid #1976d2;
      border-radius: 12px;
      padding: 10px 16px;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      font-size: 1rem;
      display: flex;
      align-items: center;
      gap: 8px;
    ">
      <i class="fas fa-filter" style="color:#1976d2;"></i>
      Filtruj
    </button>
<!-- NOWY: Floating Attractions Button - wstaw zaraz po open-filter-btn -->
<button id="open-attractions-btn" onclick="openAttractionsPanel()" style="
  position: absolute;
  bottom: 70px;
  right: 0px;               /* przesuniƒôcie aby nie nachodzi≈Ç na Filtruj */
  z-index: 1000;
  background: white;
  border: 2px solid #1976d2;
  border-radius: 12px;
  padding: 10px 16px;
  cursor: pointer;
  box-shadow: 0 4px 12px rgba(0,0,0,0.18);
  font-size: 1rem;
  display: flex;
  align-items: center;
  gap: 8px;
">
  <i class="fas fa-star" style="color:#1976d2;"></i>
  Atrakcje
</button>
    <!-- MAP TOP DISTANCE -->
    <div id="map-top-distance" style="
      display:none;
      position: absolute;
      top: 12px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 9999;
      background: rgba(255,255,255,0.95);
      border: 1px solid rgba(0,0,0,0.08);
      padding: 8px 12px;
      border-radius: 10px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.12);
      font-family: Inter, sans-serif;
      font-size: 13px;
      color: #222;
    ">
      <strong>Trasa:</strong> <span id="map-top-distance-value">‚Äî</span>
      <button id="map-top-distance-close" style="margin-left:8px; border:none; background:transparent; cursor:pointer;">‚úï</button>
    </div>
  </div>
</div> <!-- koniec #map-card -->




    
    <!-- NEW: Navigation Panel -->
    <div class="modern-card" id="navigation-card" style="display: none;">
      <div class="section-header">
        <i class="fas fa-route section-icon"></i>
        <h2 class="section-title">Nawigacja</h2>
        <button class="close-btn" onclick="closeNavigation()" style="background: #f5f5f5; border: none; border-radius: 50%; width: 30px; height: 30px; cursor: pointer;">
          <i class="fas fa-times"></i>
        </button>
      </div>
      
      <div id="navigation-content">
        <div class="navigation-header" style="margin-bottom: 1.5rem;">
          <div class="destination-info" style="background: #e3f2fd; padding: 1rem; border-radius: 0.8rem; margin-bottom: 1rem;">
            <h3 style="margin: 0 0 0.5rem 0; color: #1565c0; font-size: 1.1rem;">
              <i class="fas fa-map-marker-alt" style="margin-right: 0.5rem;"></i>
              <span id="nav-destination-name">Cel podr√≥≈ºy</span>
            </h3>
            <p style="margin: 0; color: #1976d2; font-size: 0.9rem;" id="nav-destination-address">Adres</p>
          </div>
          
          <div class="navigation-options" style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.8rem; margin-bottom: 1rem;">
            <button class="nav-option-btn active" data-type="walking" onclick="setNavigationType('walking')">
              <i class="fas fa-walking"></i> Pieszo
            </button>
            <button class="nav-option-btn" data-type="driving" onclick="setNavigationType('driving')">
              <i class="fas fa-car"></i> Samochodem
            </button>
          </div>
          
          <div class="route-summary" id="route-summary" style="display: none; background: #f8f9fa; padding: 1rem; border-radius: 0.8rem; margin-bottom: 1rem;">
            <div style="display: flex; justify-content: space-between; align-items: center;">
              <div>
                <span id="route-distance" style="font-weight: 600; color: #333;">--</span>
                <span style="color: #666; margin-left: 0.5rem;">‚Ä¢</span>
                <span id="route-duration" style="color: #666; margin-left: 0.5rem;">--</span>
              </div>
              <button class="modern-btn btn-primary" onclick="startNavigation()" style="padding: 0.5rem 1rem;">
                <i class="fas fa-play"></i> Rozpocznij
              </button>
            </div>
          </div>
        </div>
        
        <div id="navigation-directions" style="max-height: 300px; overflow-y: auto;">
          <!-- Instrukcje bƒôdƒÖ tu dodane przez JavaScript -->
        </div>
      </div>
    </div>
  </div>

  <!-- Comment Modal -->
  <div class="modal-overlay" id="comment-modal">
    <div class="modal-content">
      <button class="close-btn" onclick="closeCommentModal()">
        <i class="fas fa-times"></i>
      </button>
      
     
      
      <div class="modal-body">
        <form id="comment-form">
          <div class="form-group">
            <label class="form-label">
              <i class="fas fa-traffic-light"></i>
              Status punktu: <span style="color: var(--primary-red);">*</span>
            </label>
            <div class="status-buttons">
              <button type="button" class="status-btn" data-status="working" onclick="selectStatus('working')">
                ‚úì Dzia≈Ça
              </button>
              <button type="button" class="status-btn" data-status="needs-repair" onclick="selectStatus('needs-repair')">
                ‚ö† Wymaga naprawy
              </button>
              <button type="button" class="status-btn" data-status="not-working" onclick="selectStatus('not-working')">
                ‚úó Nie dzia≈Ça
              </button>
            </div>
            <div id="status-error" class="error-message" style="display: none;">
              <i class="fas fa-exclamation-triangle error-icon"></i>
              <span>Proszƒô wybraƒá status punktu</span>
            </div>
          </div>

          <!-- NEW: Star Rating System -->
          <div class="form-group">
            <label class="form-label">
              <i class="fas fa-star" style="color: #ffd700;"></i>
              Ocena punktu: <span style="color: var(--primary-red);">*</span>
            </label>
            <div class="star-rating" style="display: flex; align-items: center; gap: 0.5rem; margin: 0.8rem 0;">
              <div class="stars" style="display: flex; gap: 0.2rem;">
                <span class="star" data-rating="1" onclick="selectRating(1)" style="font-size: 1.8rem; color: #ddd; cursor: pointer; transition: color 0.2s;" onmouseover="hoverRating(1)" onmouseout="resetRatingHover()">‚òÖ</span>
                <span class="star" data-rating="2" onclick="selectRating(2)" style="font-size: 1.8rem; color: #ddd; cursor: pointer; transition: color 0.2s;" onmouseover="hoverRating(2)" onmouseout="resetRatingHover()">‚òÖ</span>
                <span class="star" data-rating="3" onclick="selectRating(3)" style="font-size: 1.8rem; color: #ddd; cursor: pointer; transition: color 0.2s;" onmouseover="hoverRating(3)" onmouseout="resetRatingHover()">‚òÖ</span>
                <span class="star" data-rating="4" onclick="selectRating(4)" style="font-size: 1.8rem; color: #ddd; cursor: pointer; transition: color 0.2s;" onmouseover="hoverRating(4)" onmouseout="resetRatingHover()">‚òÖ</span>
                <span class="star" data-rating="5" onclick="selectRating(5)" style="font-size: 1.8rem; color: #ddd; cursor: pointer; transition: color 0.2s;" onmouseover="hoverRating(5)" onmouseout="resetRatingHover()">‚òÖ</span>
              </div>
              <span id="rating-text" style="color: #666; font-size: 0.9rem; margin-left: 0.5rem;">Kliknij gwiazdki aby oceniƒá</span>
            </div>
            <div id="rating-error" class="error-message" style="display: none;">
              <i class="fas fa-exclamation-triangle error-icon"></i>
              <span>Proszƒô wybraƒá ocenƒô punktu</span>
            </div>
          </div>

          <div class="form-group">
            <label class="form-label" for="comment-text">
              <i class="fas fa-edit"></i>
              Opis: <span style="color: var(--primary-red);">*</span>
            </label>
            <textarea
              id="comment-text"
              class="form-textarea"
              placeholder="Opisz stan punktu, problemy, dodatkowe informacje..."
              maxlength="500"
              oninput="updateCharCounter()"
            ></textarea>
            <div id="char-counter" class="char-counter">0/500 znak√≥w</div>
            <div id="text-error" class="error-message" style="display: none;">
              <i class="fas fa-exclamation-triangle error-icon"></i>
              <span></span>
            </div>
          </div>

          <div class="form-group">
            <label class="form-label" for="comment-author">
              <i class="fas fa-user"></i>
              Imiƒô/pseudonim: <span style="color: var(--primary-red);">*</span>
            </label>
            <input
              type="text"
              id="comment-author"
              class="form-input"
              placeholder="Jak chcesz byƒá podpisany?"
              maxlength="50"
            />
            <div id="author-error" class="error-message" style="display: none;">
              <i class="fas fa-exclamation-triangle error-icon"></i>
              <span></span>
            </div>
          </div>

     
        </form>
      </div>
    </div>
  </div>

  <!-- Loading Overlay -->
  <div class="loading-overlay" id="loading">
    <div class="sner"></div>
    <div class="loading-text">≈Åadowanie danych...</div>
  </div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    // Dane wojew√≥dztw z zabytkami kulturowymi dla ka≈ºdego regionu
    const WOJ_MIASTA = {
      "Dolno≈õlƒÖskie": {
        cities: ["Wroc≈Çaw", "Wa≈Çbrzych", "Legnica", "Jelenia G√≥ra", "Lubin", "G≈Çog√≥w", "≈öwidnica", "Boles≈Çawiec", "Ole≈õnica", "Dzier≈ºoni√≥w", "Zgorzelec", "Jawor", "Nowa Ruda", "K≈Çodzko", "≈öroda ≈ölƒÖska", "Bielawa", "O≈Çawa", "ZƒÖbkowice ≈ölƒÖskie", "≈öwiebodzice", "Kamienna G√≥ra", "Strzegom", "Luba≈Ñ", "Z≈Çotoryja", "Chojn√≥w", "Brzeg Dolny", "G√≥ra", "Milicz", "Polkowice", "Kowary", "Kudowa-Zdr√≥j", "Polanica-Zdr√≥j", "Duszniki-Zdr√≥j", "LƒÖdek-Zdr√≥j", "Pi≈Çawa G√≥rna", "Pieszyce", "Bystrzyca K≈Çodzka", "Lw√≥wek ≈ölƒÖski", "Trzebnica", "≈ªmigr√≥d", "Wo≈Ç√≥w", "Syc√≥w", "Miƒôdzyb√≥rz", "Twardog√≥ra", "Bierut√≥w", "Jelcz-Laskowice", "Sob√≥tka", "KƒÖty Wroc≈Çawskie", "Siechnice", "Bogusz√≥w-Gorce", "Jedlina-Zdr√≥j", "Szczawno-Zdr√≥j", "Szklarska Porƒôba", "Karpacz", "Stronie ≈ölƒÖskie", "Miƒôdzylesie", "Le≈õna", "Gryf√≥w ≈ölƒÖski", "Mirsk", "Pie≈Ñsk", "Wƒôgliniec", "Bogatynia", "Zawid√≥w", "Nowogrodziec", "Bolk√≥w", "Marcisz√≥w", "Wojciesz√≥w", "≈öwierzawa", "Pielgrzymka", "WiƒÖz√≥w", "Bardo", "Ziƒôbice", "Niemcza", "Radk√≥w", "Szczytna", "Mierosz√≥w", "G≈Çuszyca", "Walim", "Olszyna", "Prochowice", "Przemk√≥w", "Chocian√≥w", "≈öcinawa", "WƒÖsosz", "≈ªar√≥w", "Kliczk√≥w", "Polanica", "≈öwierzawa", "Z≈Çoty Stok", "Biedrzychowice", "WƒÖdro≈ºe Wielkie", "Lubiechowa", "Henryk√≥w", "Bystrzyca G√≥rna", "LƒÖdek-Zdr√≥j", "Podg√≥rzyn", "Mys≈Çakowice", "Cieplice ≈ölƒÖskie", "Bolk√≥w", "Wle≈Ñ", "Grodziec", "Prochowice"]
      },
      "Kujawsko-Pomorskie": {
        cities: ["Bydgoszcz", "Toru≈Ñ", "W≈Çoc≈Çawek", "GrudziƒÖdz", "Inowroc≈Çaw", "Brodnica", "≈öwiecie", "≈ªnin", "Nak≈Ço nad NoteciƒÖ", "Ry", "Solec Kujawski", "Che≈Çmno", "Golub-Dobrzy≈Ñ", "Tuchola", "Sƒôp√≥lno Kraje≈Ñskie", "WƒÖbrze≈∫no", "Aleksandr√≥w Kujawski", "Ciechocinek", "Mogilno", "Janikowo", "Kruszwica", "Strzelno", "Gniewkowo", "Barcin", "Pako≈õƒá", "Kcynia", "Szubin", "≈Åabiszyn", "Koronowo", "Nowe", "Che≈Çm≈ºa", "Kowalewo Pomorskie", "Radzy≈Ñ Che≈Çmi≈Ñski", "≈Åasin", "Radziej√≥w", "Piotrk√≥w Kujawski", "Brze≈õƒá Kujawski", "Kowal", "Izbica Kujawska", "Chodecz", "Lubraniec", "Lipno", "Skƒôpe", "Dobrzy≈Ñ nad Wis≈ÇƒÖ", "Mrocza", "Wiƒôcbork", "Kamie≈Ñ Kraje≈Ñski", "Jab≈Çonowo Pomorskie", "Zbiczno", "G√≥rzno", "Nieszawa", "Lubie≈Ñ Kujawski", "Dobre"],
      },
      "Lubelskie": {
        cities: ["Lublin", "Che≈Çm", "Zamo≈õƒá", "Bia≈Ça Podlaska", "Pu≈Çawy", "Kra≈õnik", "≈Åuk√≥w", "≈öwidnik", "Dƒôblin", "≈Åƒôczna", "Hrubiesz√≥w", "Tomasz√≥w Lubelski", "Parczew", "W≈Çodawa", "Krasnystaw", "Lubart√≥w", "Miƒôdzyrzec Podlaski", "Radzy≈Ñ Podlaski", "Bi≈Çgoraj", "Jan√≥w Lubelski", "Opole Lubelskie", "Poniatowa", "Ryki", "Terespol", "Stoczek ≈Åukowski", "Be≈Ç≈ºyce", "Bychawa", "Na≈Çƒôcz√≥w", "Kazimierz Dolny", "Rejowiec Fabryczny", "Piaski", "Tarnogr√≥d", "Krasnobr√≥d", "J√≥zef√≥w", "Szczebrzeszyn", "Zwierzyniec", "Frampol", "≈Åaszcz√≥w", "Tyszowce", "Kock", "Ostr√≥w Lubelski", "Urzƒôd√≥w", "Annopol", "J√≥zef√≥w nad Wis≈ÇƒÖ", "Modliborzyce", "Rejowiec", "Siedliszcze", "Krynice", "Urszulin", "Stƒô≈ºyca"],
      },
      "Lubuskie": {
        cities: ["Zielona G√≥ra", "Gorz√≥w Wielkopolski", "Nowa S√≥l", "≈ªary", "≈ªaga≈Ñ", "≈öwiebodzin", "Sulech√≥w", "Miƒôdzyrzecz", "Kostrzyn nad OdrƒÖ", "Gubin", "S≈Çubice", "Wschowa", "Szprotawa", "Lubsko", "Drezdenko", "Strzelce Kraje≈Ñskie", "Skwierzyna", "Sulƒôcin", "O≈õno Lubuskie", "Krosno Odrza≈Ñskie", "Witnica", "Babimost", "Czerwie≈Ñsk", "Nowogr√≥d Bobrza≈Ñski", "Ko≈ºuch√≥w", "Bytom Odrza≈Ñski", "ZbƒÖszynek", "ZbƒÖszy≈Ñ", "Jasie≈Ñ", "I≈Çowa", "Ma≈Çomice", "Gozdnica", "≈Åƒôknica", "≈ªaga≈Ñ", "S≈Çawa", "Rze", "Cybinka", "Torzym", "Lubniewice", "Dobiegniew", "Trzciel", "Kargowa", "Oty≈Ñ", "Szlichtyngowa"],
      },
      "≈Å√≥dzkie": {
        cities: ["≈Å√≥d≈∫", "Piotrk√≥w Trybunalski", "Pabianice", "Be≈Çchat√≥w", "Zgierz", "Tomasz√≥w Mazowiecki", "Sieradz", "Kutno", "Skierniewice", "Ozork√≥w", "Radomsko", "≈Åask", "Brzeziny", "Wielu≈Ñ", "Zdu≈Ñska Wola", "≈Åowicz", "Konstantyn√≥w ≈Å√≥dzki", "Aleksandr√≥w ≈Å√≥dzki", "Opoczno", "Rawa Mazowiecka", "≈Åƒôczyca", "Koluszki", "G≈Çowno", "Tuszyn", "Zel√≥w", "Wierusz√≥w", "Pajƒôczno", "Sulej√≥w", "Poddƒôbice", "Przedb√≥rz", "Kro≈õniewice", "≈ªychlin", "Dzia≈Çoszyn", "Z≈Çoczew", "Bia≈Ça Rawska", "Drzewica", "Uniej√≥w", "Wolb√≥rz", "Kamie≈Ñsk", "Stryk√≥w", "Rzg√≥w", "B≈Çaszki", "Warta", "Szadek", "Strzelce", "Ksawer√≥w", "Dru≈ºbice"],
      },
      "Ma≈Çopolskie": {
        cities: ["Krak√≥w", "Tarn√≥w", "Nowy SƒÖcz", "O≈õwiƒôcim", "Chrzan√≥w", "Olkusz", "Zakopane", "Wadowice", "Andrych√≥w", "Skawina", "Bochnia", "Gorlice", "Kƒôty", "My≈õlenice", "Brzeszcze", "Wieliczka", "Miech√≥w", "LibiƒÖ≈º", "Krzeszowice", "Trzebinia", "Nowy Targ", "Brzesko", "Proszowice", "Sucha Beskidzka", "Wolbrom", "DƒÖbrowa Tarnowska", "Stary SƒÖcz", "Krynica-Zdr√≥j", "Muszyna", "Piwniczna-Zdr√≥j", "Szczawnica", "Gryb√≥w", "Tuch√≥w", "Ryglice", "Wojnicz", "Radl√≥w", "≈ªabno", "Czch√≥w", "Nowe Brzesko", "Koszyce", "Mak√≥w Podhala≈Ñski", "Jordan√≥w", "Rabka-Zdr√≥j", "Mszana Dolna", "Limanowa", "Dobczyce", "Su≈Çkowice", "S≈Çomniki", "Niepo≈Çomice", "Bukowno", "Szczucin", "Zakliczyn", "Ciƒô≈ºkowice", "Bobowa", "Biecz", "Zator", "Kalwaria Zebrzydowska", "Alwernia"],
      },
      "Mazowieckie": {
        cities: ["Warszawa", "Radom", "P≈Çock", "Siedlce", "Pruszk√≥w", "Legionowo", "Ostro≈Çƒôka", "ZƒÖbki", "Piaseczno", "Marki", "Wo≈Çomin", "Piast√≥w", "Sochaczew", "Ciechan√≥w", "Mi≈Ñsk Mazowiecki", "Otwock", "M≈Çawa", "Grodzisk Mazowiecki", "Nowy Dw√≥r Mazowiecki", "O≈ºar√≥w Mazowiecki", "Wyszk√≥w", "Pu≈Çtusk", "J√≥zef√≥w", "Koby≈Çka", "Konstancin-Jeziorna", "Zielonka", "Mi≈Çan√≥wek", "Brwin√≥w", "Radzymi≈Ñ", "≈Åomianki", "B≈Çonie", "G√≥ra Kalwaria", "Sulej√≥wek", "Halin√≥w", "Karczew", "Gostynin", "Sierpc", "P≈Ço≈Ñsk", "Przasnysz", "Mak√≥w Mazowiecki", "Wyszogr√≥d", "Nasielsk", "Zakroczym", "Serock", "T≈Çuszcz", "Radzymi≈Ñ Mazowiecki", "Garwolin", "Pilawa", "Kozienice", "Zwole≈Ñ", "Pionki", "I≈ºa", "Bia≈Çobrzegi", "Przysucha", "Szyd≈Çowiec", "Warka", "Gr√≥jec", "Mogielnica", "Nowe Miasto nad PilicƒÖ", "Mszczon√≥w", "≈ªyrard√≥w", "Raszyn", "Podkowa Le≈õna", "Chyn√≥w", "Tarczyn", "Nadarzyn"],
      },
      "Opolskie": {
        cities: ["Opole", "Kƒôdzierzyn-Ko≈∫le", "Nysa", "Brzeg", "Kluczbork", "Prudnik", "Strzelce Opolskie", "Krapkowice", "G≈Çubczyce", "Namys≈Ç√≥w", "Ozimek", "Zdzieszowice", "G≈Çog√≥wek", "Niemodlin", "Paczk√≥w", "Otmuch√≥w", "Gogolin", "Le≈õnica", "Ujazd", "Kolonowskie", "Bia≈Ça", "Korfant√≥w", "Babor√≥w", "Kietrz", "Zawadzkie", "Dobrodzien", "Wo≈Çcz√≥w", "Byczyna", "Praszka", "Gorz√≥w ≈ölƒÖski", "Zƒôbowice", "Pok√≥j", "Komprachcice", "Niemodlin", "≈Åambinowice", "Skoroszyce", "DƒÖbrowa", "Mur√≥w", "Lubsza", "ChrzƒÖstowice", "Tu≈Çowice", "≈Åosi√≥w", "Re≈Ñska Wie≈õ", "CzarnowƒÖsy", "Popiel√≥w", "B≈Çƒôd√≥w", "Domaszowice", "Walce", "Izbicko"],
      },
      "Podkarpackie": {
        cities: ["Rzesz√≥w", "Przemy≈õl", "Stalowa Wola", "Mielec", "Tarnobrzeg", "Krosno", "Jaros≈Çaw", "Sanok", "Dƒôbica", "≈Åa≈Ñcut", "Jas≈Ço", "Przeworsk", "Ropczyce", "Le≈ºajsk", "Nisko", "Lubacz√≥w", "Ustrzyki Dolne", "Lesko", "Brzoz√≥w", "Strzy≈º√≥w", "Kolbuszowa", "Sƒôdzisz√≥w Ma≈Çopolski", "Rado≈õl", "G≈Çog√≥w Ma≈Çopolski", "Soko≈Ç√≥w Ma≈Çopolski", "Rudnik nad Sanem", "Ulan√≥w", "Baran√≥w Sandomierski", "Ka≈Ñczuga", "Sieniawa", "Radymno", "Dyn√≥w", "B≈Ça≈ºowa", "Tyczyn", "Ryman√≥w", "Dukla", "Jedlicze", "Iwonicz-Zdr√≥j", "Ko≈Çaczyce", "Pilzno", "Czudec", "Niebylec", "Zag√≥rz", "Oleszyce", "Narol", "Cieszan√≥w", "Nowa Dƒôba", "Nowa Sarzyna", "Przec≈Çaw", "Radomy≈õl Wielki"],
      },
      "Podlaskie": {
        cities: ["Bia≈Çystok", "≈Åom≈ºa", "Suwa≈Çki", "August√≥w", "Grajewo", "Hajn√≥wka", "Zambr√≥w", "Bielsk Podlaski", "Sok√≥≈Çka", "Wysokie Mazowieckie", "Mo≈Ñki", "Sejny", "Kolno", "Siemiatycze", "DƒÖbrowa Bia≈Çostocka", "Supra≈õl", "Wasilk√≥w", "Czarna Bia≈Çostocka", "Choroszcz", "≈Åapy", "Nowogr√≥d", "Jedwabne", "Stawiski", "Knyszyn", "GoniƒÖdz", "Suchowola", "Krynki", "Lipsk", "Szczuczyn", "Rajgr√≥d", "Bra≈Ñsk", "Ciechanowiec", "Czy≈ºew", "Kleszczele", "Drohiczyn", "Tykocin", "Zab≈Çud√≥w", "Micha≈Çowo", "Sura≈º", "Bia≈Çowie≈ºa", "Narew", "Turo≈õ≈Ñ Ko≈õcielna", "Juchnowiec Ko≈õcielny", "Boƒáki", "Rudka", "Czeremcha", "Narewka", "Dubicze Cerkiewne", "Orla", "Kruszyniany", "Krynki", "Filip√≥w", "Punsk", "Przero≈õl", "Giby", "Rutka-Tartak", "Raczki", "Szypliszki", "Wi≈ºajny", "Go≈Çdap"],
      },
      "Pomorskie": {
        cities: ["Gda≈Ñsk", "Gdynia", "S≈Çupsk", "Sopot", "Tczew", "Starogard Gda≈Ñski", "Wejherowo", "Rumia", "Reda", "Pruszcz Gda≈Ñski", "Lƒôbork", "Malbork", "Ko≈õcierzyna", "Kartuzy", "Chojnice", "Kwidzyn", "Sztum", "Puck", "W≈Çadys≈Çawowo", "Jastarnia", "Hel", "Ustka", "≈Åeba", "Bytow", "Cz≈Çuch√≥w", "Gniew", "Pe≈Çplin", "Skarszewy", "Sk√≥rcz", "Czarna a", "Brusy", "Dzierzgon", "Prabuty", "Nowy Dw√≥r Gda≈Ñski", "Krynica Morska", "Czersk", "≈ªukowo", "Koscierzyna", "Debrzno", "Czarne", "Jastrzƒôbia G√≥ra", "Karwia"],
      },
      "≈ölƒÖskie": {
        cities: ["Katowice", "Czƒôstochowa", "Sosnowiec", "Gliwice", "Zabrze", "Bytom", "Ruda ≈ölƒÖska", "Tychy", "DƒÖbrowa G√≥rnicza", "Chorz√≥w", "Jaworzno", "Jastrzƒôbie-Zdr√≥j", "Mys≈Çowice", "Siemianowice ≈ölƒÖskie", "≈ªory", "≈öwiƒôtoch≈Çowice", "Bƒôdzin", "Piekary ≈ölƒÖskie", "Tarnowskie G√≥ry", "Bielsko-Bia≈Ça", "Racib√≥rz", "Czelad≈∫", "Rybnik", "Miko≈Ç√≥w", "Knur√≥w", "W≈Çadys≈Çawice", "Pszczyna", "Czechowice-Dziedzice", "O≈õwiƒôcim", "≈ªywiec", "Rydultowy", "Cieszy≈Ñ", "Ustron", "Wis≈Ça", "Skocz√≥w", "Bierun", "Radlin", "zis≈Çaw ≈ölƒÖski", "Czerwionka-Leszczyny", "Radzionk√≥w", "≈öwierklany", "Ledziny", "Wojkowice", "Siewierz", "Sosz≈Çowice", "Orzesz√≥w", "Kozieg≈Çowy", "Poczesna", "Krzepice", "K≈Çobuck", "Myszk√≥w", "≈ªarki", "Koniecpol", "Blachownia", "Szczekociny", "Kazimierz G√≥rniczy", "≈Åazy", "Ogrodzieniec", "Pilica", "Worek", "Krzanowice", "Ku≈∫nia Raciborska", "Toszek", "Pyskowice", "Sosnicowice", "Ujazd", "Kalety", "Miasteczko ≈ölƒÖskie", "Szczyrk", "Buczkowice", "Wilamowice", "Koz≈Çy", "Poreby", "Bƒôdziny"],
      },
      "≈öwiƒôtokrzyskie": {
        cities: ["Kielce", "Ostrowiec ≈öwiƒôtokrzyski", "Starachowice", "Skar≈ºysko-Kamienna", "Ko≈Ñskie", "Sandomierz", "Jƒôdrzej√≥w", "Busko-Zdr√≥j", "Sopo≈õcice", "W≈Çoszczowa", "Stasz√≥w", "Opatow", "Pi≈Ñcz√≥w", "Po≈Çaniec", "Kazimierza Wielka", "Suched≈Ç√≥w", "MƒÖ≈Çogoszcz", "Chƒôciny", "Daleszyce", "Kunc√≥w", "O≈ºarow", "Zawichost", "Koprzywnica", "Osiek", "Pacan√≥w", "zis≈Çaw", "Stopnica", "Chmielnik", "Staporku√≥w", "Bodzentyn", "≈Åag√≥w", "Nowa S≈Çupia", "Wielebnow", "Dzia≈Çoszyce", "Soko≈Ç√≥w", "Miƒôdzyg√≥rz"],
      },
      "Warmi≈Ñsko-Mazurskie": {
        cities: ["Olsztyn", "ElblƒÖg", "E≈Çk", "Ostr√≥da", "I≈Çawa", "Kƒôtrzyn", "Gi≈ºycko", "Braniewo", "MrƒÖgowo", "Bartoszyce", "Lidzbark Warmi≈Ñski", "Szczytno", "Pisz", "Nidzica", "Dzia≈Çdowo", "Nowe Miasto Lubawskie", "Goldap", "Olecko", "Wƒôgorzewo", "Lubawa", "Morong", "Pas≈Çƒôk", "Orneta", "Biskupiec", "Dobre Miasto", "Barczewo", "Jeziorany", "Reszel", "Korsze", "Bisztynek", "Susz", "Kisielice", "Zalewo", "Mi≈Çakowo", "Mi≈Çom≈Çyn", "Tolkmicko", "Frombork", "Pieniƒô≈ºno", "G√≥rowo I≈Çaweckie", "Sepolno I≈Çaweckie", "Orzysz", "Ruciane-Nida", "Miko≈Çajki", "Ryn", "Bi≈Çgoraj", "Lidzbark", "Malbork"],
      },
      "Wielkopolskie": {
        cities: ["Pozna≈Ñ", "Kalisz", "Konin", "Leszno", "Gniezno", "Pi≈Ça", "Ostr√≥w Wielkopolski", "Krotoszyn", "Turek", "Jarocin", "≈örem", "Swarzƒôdz", "Lubo≈Ñ", "Mosina", "Wrze≈õnia", "Ko≈Ço", "S≈Çupca", "Wagrowiec", "Oborniku", "Wolsztyn", "Koscian", "Gosty≈Ñ", "Ko≈∫min Wielkopolski", "Pleszew", "Witkowo", "Rogo≈∫no", "Trzemeszno", "Kleparz", "Murowana Go≈õlina", "Puszczykowo", "K√≥rnik", "Buk", "Kostrzyn", "Pobiedziska", "Stresz√≥w", "Opalenica", "Nowy Tomy≈õl", "Zbasy≈Ñ", "Grzywna", "Grodzisk Wielkopolski", "Rakoniewice", "Wielichowo", "Knƒôpowo", "Miedzychod", "Sierakow", "Wronki", "Szamotu≈Çy", "Pniewy", "Kapiel", "Krajenka", "Z≈Çot√≥w", "Jastrowice", "Ujscie", "Chodzie≈º", "Margonin", "Czarnkow", "Trzcianka", "Wie≈Çe≈Ñ", "Krzy≈º Wielkopolski", "Drawsko", "Rawicko", "Borek Wielkopolski", "Poniec", "Kro≈õnice", "Miejska G√≥rka", "Jutrosin", "Sieraki", "Mieszk√≥w", "Czemio", "Brodniƒá", "Dolsk", "Klecz√≥w", "Stawiszyn", "Gozdowo", "Pyzdry", "Zagrow", "Rych≈Çy", "Lw√≥wek", "≈ölesin", "Kleczew", "Sompolno", "Golina", "Kazimierz Biskupi", "Wilczyn", "Orchowo", "Ostrzesz√≥w", "Mikolajow", "Grabowo nad Prosno", "Dorgon", "Olsz√≥wka", "Nekla", "Czerniejewo", "Kepno", "Soboty"],
      },
      "Zachodniopomorskie": {
        cities: ["Szczecin", "Koszalin", "Stargard", "Ko≈Çobrzeg", "≈öwinouj≈õcie", "Szczecinek", "Wa≈Çcz", "≈öwidwin", "Bia≈Çogard", "Gryfino", "Kamie≈Ñ Pomorski", "≈Åobez", "My≈õlib√≥rz", "Goleni√≥w", "Nowogard", "Police", "Gryfice", "Trzebiat√≥w", "Dar≈Çowo", "S≈Çawno", "Ustka", "Sian√≥w", "Polany", "Bobolice", "Barwice", "Borne Sulinowo", "Czaplinek", "Drawsko Pomorskie", "Ka≈Çuszko", "Zlotocieniec", "Miros≈Çawiec", "Tuczno", "P≈Çoty", "Resko", "Wegrzyno", "Dobra", "Chocin", "Radow Ma≈Çe", "Maszewo", "Golczewo", "Stepnica", "Miƒôdzyzdroje", "Wolin", "Dziwn√≥w", "Rewal", "Pogorzelica", "Niechorze", "Trzeb√≥sz", "Mielno", "Ustr√≥n Morski", "Sarbinowo", "Dbrzno", "I≈Ñsko", "P√≥≈Çczno", "Recz", "Salino", "Dobrzany", "Wieduchowa", "Chojnino", "Trzci≈Ñsko-Zdr√≥j", "Cedynia", "Mozyno", "Mieszkowice", "Debno", "Barlinek", "Pe≈Çczyce", "Lipiany", "Pyrzyce", "Bielice", "Kozielice", "Warnice", "Stare Czarnowo"],
      }
    };

    // Wsp√≥≈Çrzƒôdne wszystkich polskich miast
    const CITY_COORDINATES = {
      // Dolno≈õlƒÖskie
      "Wroc≈Çaw": { lat: 51.1079, lng: 17.0385 },
      "Wa≈Çbrzych": { lat: 50.7842, lng: 16.2844 },
      "Legnica": { lat: 51.2071, lng: 16.1559 },
      "Jelenia G√≥ra": { lat: 50.8977, lng: 15.7213 },
      "Lubin": { lat: 51.4002, lng: 16.2008 },
      "G≈Çog√≥w": { lat: 51.6654, lng: 16.0842 },
      "≈öwidnica": { lat: 50.8456, lng: 16.4967 },
      "Boles≈Çawiec": { lat: 51.2624, lng: 15.5697 },
      "Ole≈õnica": { lat: 51.2097, lng: 17.3783 },
      "Dzier≈ºoni√≥w": { lat: 50.7317, lng: 16.6564 },
      "Zgorzelec": { lat: 51.0504, lng: 15.0061 },
      "Jawor": { lat: 51.0552, lng: 16.1919 },
      "Nowa Ruda": { lat: 50.5836, lng: 16.4925 },
      "K≈Çodzko": { lat: 50.4351, lng: 16.6546 },
      "≈öroda ≈ölƒÖska": { lat: 51.1727, lng: 16.8643 },
      "ZƒÖbkowice ≈ölƒÖskie": { lat: 50.5927, lng: 16.8143 },
      "K≈Çodzko": { lat: 50.4351, lng: 16.6546 },
      "Nysa": { lat: 50.4737, lng: 17.3335 },
      "Prudnik": { lat: 50.3232, lng: 17.5859 },
      "Kamieniec ZƒÖbkowicki": { lat: 50.4327, lng: 16.8743 },
      "Bielawa": { lat: 50.6927, lng: 16.6343 },
      "O≈Çawa": { lat: 50.9427, lng: 17.2943 },
      "≈öwiebodzice": { lat: 50.8627, lng: 16.3243 },
      "Kamienna G√≥ra": { lat: 50.7827, lng: 16.0343 },
      "Strzegom": { lat: 50.9627, lng: 16.3543 },
      "Luba≈Ñ": { lat: 51.1227, lng: 15.2843 },
      "Z≈Çotoryja": { lat: 51.1227, lng: 15.9243 },
      "Chojn√≥w": { lat: 51.2827, lng: 15.9343 },
      "Brzeg Dolny": { lat: 51.0327, lng: 16.7443 },
      "G√≥ra": { lat: 51.6527, lng: 16.0843 },
      "Milicz": { lat: 51.5227, lng: 17.2243 },
      "Polkowice": { lat: 51.4927, lng: 16.0743 },
      "Kowary": { lat: 50.7927, lng: 15.8443 },
      "Kudowa-Zdr√≥j": { lat: 50.4427, lng: 16.2443 },
      "Polanica-Zdr√≥j": { lat: 50.4127, lng: 16.5143 },
      "Duszniki-Zdr√≥j": { lat: 50.3927, lng: 16.3843 },
      "LƒÖdek-Zdr√≥j": { lat: 50.3427, lng: 16.8743 },
      "Pi≈Çawa G√≥rna": { lat: 50.5927, lng: 16.4443 },
      "Pieszyce": { lat: 50.7327, lng: 16.2743 },
      "Bystrzyca K≈Çodzka": { lat: 50.2927, lng: 16.6443 },
      "Lw√≥wek ≈ölƒÖski": { lat: 51.1027, lng: 15.5943 },
      "Trzebnica": { lat: 51.3127, lng: 17.0643 },
      "≈ªmigr√≥d": { lat: 51.4727, lng: 16.9143 },
      "Wo≈Ç√≥w": { lat: 51.3427, lng: 16.6343 },
      "Syc√≥w": { lat: 51.3027, lng: 17.7243 },
      "Twardog√≥ra": { lat: 51.3827, lng: 17.4643 },
      "Bierut√≥w": { lat: 51.1627, lng: 17.5343 },
      "KƒÖty Wroc≈Çawskie": { lat: 51.0127, lng: 16.7743 },
      "Siechnice": { lat: 50.9927, lng: 17.1943 },
      "Szklarska Porƒôba": { lat: 50.8227, lng: 15.5143 },
      "Karpacz": { lat: 50.7727, lng: 15.7443 },
      "Stronie ≈ölƒÖskie": { lat: 50.2927, lng: 16.8743 },
      "Miƒôdzylesie": { lat: 50.1627, lng: 16.6543 },
      "Le≈õna": { lat: 51.0327, lng: 15.1443 },
      "Gryf√≥w ≈ölƒÖski": { lat: 50.9527, lng: 15.5243 },
      "Mirsk": { lat: 50.9727, lng: 15.3943 },
      "Pie≈Ñsk": { lat: 51.0527, lng: 14.8143 },
      "Wƒôgliniec": { lat: 51.2827, lng: 15.2043 },
      "Bogatynia": { lat: 50.9027, lng: 14.9543 },
      "Zawid√≥w": { lat: 50.9627, lng: 14.7943 },
      "Nowogrodziec": { lat: 51.1727, lng: 15.5643 },
      "Bolk√≥w": { lat: 50.9327, lng: 16.0943 },
      "Marcisz√≥w": { lat: 50.8827, lng: 15.8543 },
      "Wojciesz√≥w": { lat: 51.0027, lng: 15.9243 },
      "≈öwierzawa": { lat: 51.0227, lng: 15.5343 },
      "WiƒÖz√≥w": { lat: 50.9127, lng: 16.9843 },
      "Bardo": { lat: 50.4927, lng: 16.7643 },
      "Ziƒôbice": { lat: 50.6127, lng: 17.0443 },
      "Niemcza": { lat: 50.6827, lng: 16.9143 },
      "Radk√≥w": { lat: 50.3827, lng: 16.8343 },
      "Szczytna": { lat: 50.4027, lng: 16.8943 },
      "Mierosz√≥w": { lat: 50.6627, lng: 16.1843 },
      "G≈Çuszyca": { lat: 50.6827, lng: 16.3643 },
      "Walim": { lat: 50.7027, lng: 16.4343 },
      "Olszyna": { lat: 51.0827, lng: 15.0343 },
      "Prochowice": { lat: 51.0227, lng: 16.0643 },
      "Przemk√≥w": { lat: 51.5427, lng: 15.7843 },
      "Chocian√≥w": { lat: 51.4827, lng: 15.9443 },
      "≈öcinawa": { lat: 51.4227, lng: 16.2843 },
      "WƒÖsosz": { lat: 51.3727, lng: 15.7443 },
      "≈ªar√≥w": { lat: 50.9927, lng: 16.4743 },
      "Kliczk√≥w": { lat: 51.2627, lng: 15.4143 },
      "Z≈Çoty Stok": { lat: 50.4227, lng: 16.8643 },
      "Sob√≥tka": { lat: 50.8827, lng: 16.7343 },
      "Jelcz-Laskowice": { lat: 51.0427, lng: 17.3343 },
      "Bogusz√≥w-Gorce": { lat: 50.7527, lng: 16.2043 },
      "Jedlina-Zdr√≥j": { lat: 50.7227, lng: 16.0843 },
      "Szczawno-Zdr√≥j": { lat: 50.7927, lng: 16.2243 },
      "Podg√≥rzyn": { lat: 50.8327, lng: 15.7243 },
      "Mys≈Çakowice": { lat: 50.8927, lng: 15.7643 },
      "Wle≈Ñ": { lat: 51.0727, lng: 15.6543 },
      "Grodziec": { lat: 51.1527, lng: 15.6343 },
      "Biedrzychowice": { lat: 51.1227, lng: 15.3443 },
      "WƒÖdro≈ºe Wielkie": { lat: 51.2527, lng: 15.1443 },
      "Lubiechowa": { lat: 51.0827, lng: 14.9243 },
      "Henryk√≥w": { lat: 50.6527, lng: 16.9543 },
      "Bystrzyca G√≥rna": { lat: 50.3727, lng: 16.6443 },
      "Cieplice ≈ölƒÖskie": { lat: 50.8227, lng: 15.6943 },

      // Kujawsko-Pomorskie
      "Bydgoszcz": { lat: 53.1235, lng: 18.0084 },
      "Toru≈Ñ": { lat: 53.0138, lng: 18.5984 },
      "W≈Çoc≈Çawek": { lat: 52.6482, lng: 19.0677 },
      "GrudziƒÖdz": { lat: 53.4838, lng: 18.7537 },
      "Inowroc≈Çaw": { lat: 52.7988, lng: 18.2583 },
      "Brodnica": { lat: 53.2590, lng: 19.3995 },
      "≈öwiecie": { lat: 53.4101, lng: 18.4497 },
      "≈ªnin": { lat: 52.8460, lng: 17.7242 },
      "Nak≈Ço nad NoteciƒÖ": { lat: 53.1372, lng: 17.5998 },
      "Ry": { lat: 53.0710, lng: 19.4051 },
      "Solec Kujawski": { lat: 52.6946, lng: 18.2153 },
      "Che≈Çmno": { lat: 53.3487, lng: 18.4236 },
      "Golub-Dobrzy≈Ñ": { lat: 53.1088, lng: 19.0426 },
      "Tuchola": { lat: 53.5862, lng: 17.8548 },
      "Sƒôp√≥lno Kraje≈Ñskie": { lat: 53.4156, lng: 17.3886 },
      "WƒÖbrze≈∫no": { lat: 53.2849, lng: 18.9355 },
      "Aleksandr√≥w Kujawski": { lat: 52.8789, lng: 18.6951 },
      "Ciechocinek": { lat: 52.8780, lng: 18.7945 },
      "Mogilno": { lat: 52.6623, lng: 17.9502 },
      "Janikowo": { lat: 52.7479, lng: 17.6911 },
      "Kruszwica": { lat: 52.6769, lng: 18.3187 },
      "Strzelno": { lat: 52.6286, lng: 18.1689 },
      "Gniewkowo": { lat: 52.8945, lng: 18.4265 },
      "Barcin": { lat: 52.8572, lng: 17.9486 },
      "Pako≈õƒá": { lat: 52.8088, lng: 18.0936 },
      "Kcynia": { lat: 52.5913, lng: 17.9939 },
      "Szubin": { lat: 53.0126, lng: 17.7652 },
      "≈Åabiszyn": { lat: 52.9517, lng: 17.7286 },
      "Koronowo": { lat: 53.3166, lng: 17.9357 },
      "Nowe": { lat: 53.2634, lng: 18.7235 },
      "Che≈Çm≈ºa": { lat: 53.1853, lng: 18.6045 },
      "Kowalewo Pomorskie": { lat: 53.2076, lng: 18.9045 },
      "Radzy≈Ñ Che≈Çmi≈Ñski": { lat: 53.3899, lng: 18.9345 },
      "≈Åasin": { lat: 53.5234, lng: 19.0845 },
      "Radziej√≥w": { lat: 52.6123, lng: 18.5045 },
      "Piotrk√≥w Kujawski": { lat: 52.5934, lng: 19.3145 },
      "Brze≈õƒá Kujawski": { lat: 52.6045, lng: 19.1345 },
      "Kowal": { lat: 52.9145, lng: 19.1845 },
      "Izbica Kujawska": { lat: 52.4145, lng: 18.7845 },
      "Chodecz": { lat: 52.4045, lng: 19.0345 },
      "Lubraniec": { lat: 52.4945, lng: 18.8345 },
      "Lipno": { lat: 52.8445, lng: 19.1845 },
      "Skƒôpe": { lat: 52.9345, lng: 19.3345 },
      "Dobrzy≈Ñ nad Wis≈ÇƒÖ": { lat: 52.6145, lng: 19.3645 },
      "Mrocza": { lat: 53.4645, lng: 17.5645 },
      "Wiƒôcbork": { lat: 53.5545, lng: 17.1945 },
      "Kamie≈Ñ Kraje≈Ñski": { lat: 53.5245, lng: 17.4645 },
      "Jab≈Çonowo Pomorskie": { lat: 53.0545, lng: 19.2145 },
      "Zbiczno": { lat: 52.9245, lng: 18.9645 },
      "G√≥rzno": { lat: 53.1745, lng: 19.5145 },
      "Nieszawa": { lat: 52.8345, lng: 18.8945 },
      "Lubie≈Ñ Kujawski": { lat: 52.4745, lng: 18.6645 },
      "Dobre": { lat: 53.0345, lng: 18.8545 },

      // Lubelskie
      "Lublin": { lat: 51.2465, lng: 22.5684 },
      "Che≈Çm": { lat: 51.1432, lng: 23.4716 },
      "Zamo≈õƒá": { lat: 50.7232, lng: 23.2519 },
      "Bia≈Ça Podlaska": { lat: 52.0324, lng: 23.1165 },
      "Pu≈Çawy": { lat: 51.4164, lng: 21.9692 },
      "Kra≈õnik": { lat: 50.9242, lng: 22.2049 },
      "≈Åuk√≥w": { lat: 51.9306, lng: 22.3830 },
      "≈öwidnik": { lat: 51.2192, lng: 22.6951 },
      "Dƒôblin": { lat: 51.5514, lng: 21.8530 },
      "≈Åƒôczna": { lat: 51.3003, lng: 22.8837 },
      "Hrubiesz√≥w": { lat: 50.8054, lng: 23.8928 },
      "Tomasz√≥w Lubelski": { lat: 50.4479, lng: 23.4161 },
      "Parczew": { lat: 51.6378, lng: 22.9014 },
      "W≈Çodawa": { lat: 51.5522, lng: 23.5518 },
      "Radzy≈Ñ Podlaski": { lat: 51.7822, lng: 22.6218 },
      "Terespol": { lat: 52.0722, lng: 23.6118 },
      "Miƒôdzyrzec Podlaski": { lat: 51.9822, lng: 22.7818 },
      "Rejowiec Fabryczny": { lat: 51.3522, lng: 23.2518 },
      "Krasnystaw": { lat: 51.0022, lng: 23.1818 },
      "Lubart√≥w": { lat: 51.4622, lng: 22.6118 },
      "Bi≈Çgoraj": { lat: 50.5422, lng: 22.7218 },
      "Jan√≥w Lubelski": { lat: 50.7022, lng: 22.4018 },
      "Opole Lubelskie": { lat: 51.1522, lng: 21.9718 },
      "Poniatowa": { lat: 51.1822, lng: 22.0618 },
      "Ryki": { lat: 51.6322, lng: 21.9318 },
      "Stoczek ≈Åukowski": { lat: 51.9622, lng: 22.0118 },
      "Be≈Ç≈ºyce": { lat: 51.1722, lng: 22.3018 },
      "Bychawa": { lat: 51.3122, lng: 22.5318 },
      "Na≈Çƒôcz√≥w": { lat: 51.2822, lng: 22.2118 },
      "Kazimierz Dolny": { lat: 51.3222, lng: 21.9518 },
      "Piaski": { lat: 51.1922, lng: 22.8418 },
      "Tarnogr√≥d": { lat: 50.3522, lng: 22.7418 },
      "Krasnobr√≥d": { lat: 50.5322, lng: 23.2018 },
      "J√≥zef√≥w": { lat: 50.2422, lng: 23.4018 },
      "Szczebrzeszyn": { lat: 50.7022, lng: 22.9818 },
      "Zwierzyniec": { lat: 50.6122, lng: 22.9718 },
      "Frampol": { lat: 50.6822, lng: 22.6718 },
      "≈Åaszcz√≥w": { lat: 50.5022, lng: 23.9018 },
      "Tyszowce": { lat: 50.6322, lng: 23.7318 },
      "Kock": { lat: 51.6422, lng: 22.4518 },
      "Ostr√≥w Lubelski": { lat: 51.4222, lng: 22.1318 },
      "Urzƒôd√≥w": { lat: 50.9922, lng: 22.1718 },
      "Annopol": { lat: 50.8822, lng: 21.8618 },
      "J√≥zef√≥w nad Wis≈ÇƒÖ": { lat: 50.7522, lng: 21.9318 },
      "Modliborzyce": { lat: 50.7822, lng: 22.3318 },
      "Rejowiec": { lat: 51.3322, lng: 23.2318 },
      "Siedliszcze": { lat: 51.4822, lng: 23.6318 },
      "Krynice": { lat: 51.1322, lng: 23.9118 },
      "Urszulin": { lat: 51.4322, lng: 23.4718 },
      "Stƒô≈ºyca": { lat: 51.4922, lng: 23.6118 },

      // Lubuskie
      "Zielona G√≥ra": { lat: 51.9356, lng: 15.5062 },
      "Gorz√≥w Wielkopolski": { lat: 52.7325, lng: 15.2369 },
      "Nowa S√≥l": { lat: 51.8021, lng: 15.7218 },
      "≈ªary": { lat: 51.6417, lng: 15.1376 },
      "≈öwiebodzin": { lat: 52.2468, lng: 15.5365 },
      "Sulech√≥w": { lat: 52.0895, lng: 15.6188 },
      "Miƒôdzyrzecz": { lat: 52.4433, lng: 15.5856 },
      "Kostrzyn nad OdrƒÖ": { lat: 52.5893, lng: 14.6564 },
      "Gubin": { lat: 51.9495, lng: 14.7139 },
      "Krosno Odrza≈Ñskie": { lat: 51.8895, lng: 15.0939 },
      "S≈Çubice": { lat: 52.3595, lng: 14.5639 },
      "≈ªaga≈Ñ": { lat: 51.6177, lng: 15.3157 },
      "Lubsko": { lat: 51.7695, lng: 14.9739 },
      "Wschowa": { lat: 51.8095, lng: 16.0739 },
      "Szprotawa": { lat: 51.5695, lng: 15.5339 },
      "Drezdenko": { lat: 52.8495, lng: 15.8339 },
      "Strzelce Kraje≈Ñskie": { lat: 52.8795, lng: 15.8539 },
      "Skwierzyna": { lat: 52.5995, lng: 15.5039 },
      "Sulƒôcin": { lat: 52.4395, lng: 15.1239 },
      "O≈õno Lubuskie": { lat: 52.4495, lng: 14.8739 },
      "Witnica": { lat: 52.6795, lng: 14.9039 },
      "Babimost": { lat: 52.1395, lng: 15.8239 },
      "Czerwie≈Ñsk": { lat: 51.4895, lng: 15.3139 },
      "Nowogr√≥d Bobrza≈Ñski": { lat: 51.9095, lng: 15.7239 },
      "Ko≈ºuch√≥w": { lat: 51.7395, lng: 15.5939 },
      "Bytom Odrza≈Ñski": { lat: 51.6795, lng: 15.8139 },
      "ZbƒÖszynek": { lat: 52.2595, lng: 15.9139 },
      "ZbƒÖszy≈Ñ": { lat: 52.2495, lng: 15.9239 },
      "Jasie≈Ñ": { lat: 51.9595, lng: 14.8339 },
      "I≈Çowa": { lat: 51.5995, lng: 15.2239 },
      "Ma≈Çomice": { lat: 51.5695, lng: 14.9939 },
      "Gozdnica": { lat: 51.5495, lng: 15.1339 },
      "≈Åƒôknica": { lat: 51.5295, lng: 14.7739 },
      "S≈Çawa": { lat: 51.8795, lng: 16.0639 },
      "Rze": { lat: 52.3495, lng: 14.8339 },
      "Cybinka": { lat: 52.4095, lng: 14.7339 },
      "Torzym": { lat: 52.3795, lng: 15.3339 },
      "Lubniewice": { lat: 52.7595, lng: 15.2739 },
      "Dobiegniew": { lat: 52.9695, lng: 15.7239 },
      "Trzciel": { lat: 52.3695, lng: 15.8739 },
      "Kargowa": { lat: 52.0695, lng: 15.8839 },
      "Oty≈Ñ": { lat: 51.8395, lng: 15.2439 },
      "Szlichtyngowa": { lat: 51.6595, lng: 16.1639 },

      // ≈Å√≥dzkie
      "≈Å√≥d≈∫": { lat: 51.7592, lng: 19.4560 },
      "Piotrk√≥w Trybunalski": { lat: 51.4058, lng: 19.7034 },
      "Pabianice": { lat: 51.6654, lng: 19.3564 },
      "Be≈Çchat√≥w": { lat: 51.3677, lng: 19.3671 },
      "Zgierz": { lat: 51.8562, lng: 19.4077 },
      "Tomasz√≥w Mazowiecki": { lat: 51.5309, lng: 20.0088 },
      "Sieradz": { lat: 51.5951, lng: 18.7307 },
      "Kutno": { lat: 52.2316, lng: 19.3640 },
      "Skierniewice": { lat: 51.9537, lng: 20.1538 },
      "Ozork√≥w": { lat: 51.9679, lng: 19.2847 },
      "Radomsko": { lat: 51.0656, lng: 19.4502 },
      "≈Åask": { lat: 51.5901, lng: 19.1347 },
      "Brzeziny": { lat: 51.7977, lng: 19.7565 },
      "Wielu≈Ñ": { lat: 51.2187, lng: 18.5698 },
      "Zdu≈Ñska Wola": { lat: 51.6059, lng: 18.9359 },
      "≈Åowicz": { lat: 52.1059, lng: 19.9459 },
      "Konstantyn√≥w ≈Å√≥dzki": { lat: 51.7459, lng: 19.3259 },
      "Aleksandr√≥w ≈Å√≥dzki": { lat: 51.8159, lng: 19.3059 },
      "Opoczno": { lat: 51.3759, lng: 20.2759 },
      "Rawa Mazowiecka": { lat: 51.7659, lng: 20.2559 },
      "≈Åƒôczyca": { lat: 52.0559, lng: 19.2059 },
      "Koluszki": { lat: 51.7359, lng: 19.8159 },
      "G≈Çowno": { lat: 51.9659, lng: 19.7159 },
      "Tuszyn": { lat: 51.6259, lng: 19.3759 },
      "Zel√≥w": { lat: 51.4459, lng: 19.1659 },
      "Wierusz√≥w": { lat: 51.2959, lng: 18.1559 },
      "Pajƒôczno": { lat: 50.9959, lng: 19.1159 },
      "Sulej√≥w": { lat: 51.3559, lng: 19.8759 },
      "Poddƒôbice": { lat: 52.0159, lng: 18.9759 },
      "Przedb√≥rz": { lat: 51.0959, lng: 20.1459 },
      "Kro≈õniewice": { lat: 52.2459, lng: 19.1759 },
      "≈ªychlin": { lat: 52.2259, lng: 18.9659 },
      "Dzia≈Çoszyn": { lat: 51.2059, lng: 18.8159 },
      "Z≈Çoczew": { lat: 51.3359, lng: 18.4359 },
      "Bia≈Ça Rawska": { lat: 51.8059, lng: 20.4159 },
      "Drzewica": { lat: 51.4759, lng: 20.4459 },
      "Uniej√≥w": { lat: 52.0659, lng: 18.7959 },
      "Wolb√≥rz": { lat: 51.5659, lng: 19.7759 },
      "Kamie≈Ñsk": { lat: 51.2759, lng: 19.5359 },
      "Stryk√≥w": { lat: 51.9259, lng: 19.6159 },
      "Rzg√≥w": { lat: 51.7159, lng: 19.5959 },
      "B≈Çaszki": { lat: 51.6359, lng: 18.2859 },
      "Warta": { lat: 51.7259, lng: 18.7959 },
      "Szadek": { lat: 51.6759, lng: 18.9859 },
      "Strzelce": { lat: 51.3459, lng: 18.8859 },
      "Ksawer√≥w": { lat: 51.7759, lng: 19.5259 },
      "Dru≈ºbice": { lat: 51.6059, lng: 18.6359 },

      // Ma≈Çopolskie
      "Krak√≥w": { lat: 50.0647, lng: 19.9450 },
      "Tarn√≥w": { lat: 50.0121, lng: 20.9858 },
      "Nowy SƒÖcz": { lat: 49.6249, lng: 20.7144 },
      "O≈õwiƒôcim": { lat: 50.0348, lng: 19.2319 },
      "Chrzan√≥w": { lat: 50.1355, lng: 19.4015 },
      "Olkusz": { lat: 50.2804, lng: 19.5610 },
      "Zakopane": { lat: 49.2992, lng: 19.9496 },
      "Wadowice": { lat: 49.8794, lng: 19.4840 },
      "Andrych√≥w": { lat: 49.8556, lng: 19.3406 },
      "Skawina": { lat: 49.9695, lng: 19.8298 },
      "Bochnia": { lat: 49.9691, lng: 20.4307 },
      "Gorlice": { lat: 49.6556, lng: 21.1596 },
      "Kƒôty": { lat: 49.8830, lng: 19.2288 },
      "My≈õlenice": { lat: 49.9364, lng: 19.9324 },
      "Brzeszcze": { lat: 50.0115, lng: 19.1625 },
      "Wieliczka": { lat: 49.9847, lng: 20.0659 },
      "Miech√≥w": { lat: 50.3547, lng: 20.0359 },
      "LibiƒÖ≈º": { lat: 50.1047, lng: 19.3759 },
      "Krzeszowice": { lat: 50.1447, lng: 19.6159 },
      "Trzebinia": { lat: 50.1647, lng: 19.4659 },
      "Nowy Targ": { lat: 49.4847, lng: 20.0359 },
      "Brzesko": { lat: 49.9747, lng: 20.6159 },
      "Proszowice": { lat: 50.1947, lng: 20.2459 },
      "Sucha Beskidzka": { lat: 49.7447, lng: 19.5959 },
      "Wolbrom": { lat: 50.3747, lng: 19.7659 },
      "DƒÖbrowa Tarnowska": { lat: 50.1647, lng: 20.8359 },
      "Stary SƒÖcz": { lat: 49.5647, lng: 20.6359 },
      "Krynica-Zdr√≥j": { lat: 49.4147, lng: 20.9659 },
      "Muszyna": { lat: 49.3547, lng: 20.8959 },
      "Piwniczna-Zdr√≥j": { lat: 49.4347, lng: 20.7159 },
      "Szczawnica": { lat: 49.4047, lng: 20.4659 },
      "Gryb√≥w": { lat: 49.6147, lng: 20.9459 },
      "Tuch√≥w": { lat: 49.9047, lng: 20.8159 },
      "Ryglice": { lat: 49.9447, lng: 21.0159 },
      "Wojnicz": { lat: 49.9647, lng: 20.8459 },
      "Rad≈Ç√≥w": { lat: 50.0247, lng: 20.9859 },
      "≈ªabno": { lat: 50.0947, lng: 20.8859 },
      "Czch√≥w": { lat: 49.8447, lng: 20.7159 },
      "Nowe Brzesko": { lat: 50.1247, lng: 20.5659 },
      "Koszyce": { lat: 49.6847, lng: 21.1559 },
      "Mak√≥w Podhala≈Ñski": { lat: 49.7147, lng: 19.6459 },
      "Jordan√≥w": { lat: 49.6647, lng: 19.8159 },
      "Rabka-Zdr√≥j": { lat: 49.6047, lng: 19.9659 },
      "Mszana Dolna": { lat: 49.6747, lng: 20.0759 },
      "Limanowa": { lat: 49.7047, lng: 20.4259 },
      "Dobczyce": { lat: 49.8747, lng: 20.1259 },
      "Su≈Çkowice": { lat: 49.7847, lng: 19.6659 },
      "S≈Çomniki": { lat: 50.2547, lng: 20.0759 },
      "Niepo≈Çomice": { lat: 50.0347, lng: 20.2159 },
      "Bukowno": { lat: 50.2847, lng: 19.4759 },
      "Szczucin": { lat: 50.1047, lng: 20.7459 },
      "Zakliczyn": { lat: 49.8547, lng: 20.8059 },
      "Ciƒô≈ºkowice": { lat: 49.7247, lng: 20.9759 },
      "Bobowa": { lat: 49.7347, lng: 20.9659 },
      "Biecz": { lat: 49.7347, lng: 21.2559 },
      "Zator": { lat: 50.0047, lng: 19.4359 },
      "Kalwaria Zebrzydowska": { lat: 49.8647, lng: 19.6759 },
      "Alwernia": { lat: 50.0859, lng: 19.5259 },
      "Koscierzyna": { lat: 54.1258, lng: 17.9744 },
      "Bytow": { lat: 54.1658, lng: 17.4944 },

      // Mazowieckie
      "Warszawa": { lat: 52.2297, lng: 21.0122 },
      "Radom": { lat: 51.4027, lng: 21.1471 },
      "P≈Çock": { lat: 52.5463, lng: 19.7065 },
      "Siedlce": { lat: 52.1676, lng: 22.2902 },
      "Pruszk√≥w": { lat: 52.1704, lng: 20.8067 },
      "Legionowo": { lat: 52.4054, lng: 20.9304 },
      "Ostro≈Çƒôka": { lat: 53.0839, lng: 21.5654 },
      "ZƒÖbki": { lat: 52.2946, lng: 21.1017 },
      "Piaseczno": { lat: 52.0745, lng: 21.0254 },
      "Marki": { lat: 52.3215, lng: 21.1056 },
      "Wo≈Çomin": { lat: 52.3407, lng: 21.2422 },
      "Piast√≥w": { lat: 52.1859, lng: 20.8374 },
      "Sochaczew": { lat: 52.2331, lng: 20.2371 },
      "Ciechan√≥w": { lat: 52.8806, lng: 20.6120 },
      "Mi≈Ñsk Mazowiecki": { lat: 52.1794, lng: 21.5715 },
      "Otwock": { lat: 52.1058, lng: 21.2611 },
      "M≈Çawa": { lat: 53.1082, lng: 20.3847 },
      "Grodzisk Mazowiecki": { lat: 52.1078, lng: 20.6374 },
      "Nowy Dw√≥r Mazowiecki": { lat: 52.4378, lng: 20.7174 },
      "O≈ºar√≥w Mazowiecki": { lat: 52.2478, lng: 20.8074 },
      "Wyszk√≥w": { lat: 52.5978, lng: 21.4574 },
      "Pu≈Çtusk": { lat: 52.7078, lng: 21.0874 },
      "J√≥zef√≥w": { lat: 52.1378, lng: 21.2374 },
      "Koby≈Çka": { lat: 52.3278, lng: 21.0674 },
      "Konstancin-Jeziorna": { lat: 52.0878, lng: 21.1174 },
      "Zielonka": { lat: 52.3078, lng: 21.1674 },
      "Mi≈Çan√≥wek": { lat: 52.1278, lng: 20.6774 },
      "Brwin√≥w": { lat: 52.1478, lng: 20.7174 },
      "Radzymy≈Ñ": { lat: 52.4178, lng: 21.1874 },
      "≈Åomianki": { lat: 52.3378, lng: 20.8874 },
      "B≈Çonie": { lat: 52.1878, lng: 20.6074 },
      "G√≥ra Kalwaria": { lat: 51.9678, lng: 21.2174 },
      "Sulej√≥wek": { lat: 52.2578, lng: 21.2774 },
      "Halin√≥w": { lat: 52.1178, lng: 21.3674 },
      "Karczew": { lat: 52.0778, lng: 21.2474 },
      "Gostynin": { lat: 52.4278, lng: 19.4674 },
      "Sierpc": { lat: 52.8578, lng: 19.6674 },
      "P≈Ço≈Ñsk": { lat: 52.6278, lng: 20.3774 },
      "Przasnysz": { lat: 53.0178, lng: 20.8774 },
      "Mak√≥w Mazowiecki": { lat: 52.8878, lng: 20.4374 },
      "Wyszogr√≥d": { lat: 52.4878, lng: 20.1174 },
      "Nasielsk": { lat: 52.5778, lng: 20.8074 },
      "Zakroczym": { lat: 52.4378, lng: 20.6174 },
      "Serock": { lat: 52.5178, lng: 21.0574 },
      "T≈Çuszcz": { lat: 52.4678, lng: 21.3474 },
      "Garwolin": { lat: 51.8978, lng: 21.6174 },
      "Pilawa": { lat: 51.6278, lng: 21.4474 },
      "Kozienice": { lat: 51.5578, lng: 21.5574 },
      "Zwole≈Ñ": { lat: 51.3478, lng: 21.5774 },
      "Pionki": { lat: 51.4778, lng: 21.4574 },
      "I≈ºa": { lat: 51.2378, lng: 21.4774 },
      "Bia≈Çobrzegi": { lat: 51.6478, lng: 20.9574 },
      "Przysucha": { lat: 51.3578, lng: 20.6074 },
      "Szyd≈Çowiec": { lat: 51.2278, lng: 20.8574 },
      "Warka": { lat: 51.7778, lng: 21.1874 },
      "Gr√≥jec": { lat: 51.8678, lng: 20.8674 },
      "Mogielnica": { lat: 51.9078, lng: 20.6374 },
      "Nowe Miasto nad PilicƒÖ": { lat: 51.6178, lng: 20.7074 },
      "Mszczon√≥w": { lat: 52.0278, lng: 20.5174 },
      "≈ªyrard√≥w": { lat: 52.0578, lng: 20.4474 },
      "Raszyn": { lat: 52.1378, lng: 20.9174 },
      "Podkowa Le≈õna": { lat: 52.1178, lng: 20.7274 },
      "Chyn√≥w": { lat: 51.9278, lng: 21.0474 },
      "Tarczyn": { lat: 52.0478, lng: 20.8274 },
      "Nadarzyn": { lat: 52.1078, lng: 20.7974 },
      "Zabki": { lat: 52.2999, lng: 21.1022 },
      "Ozarow Mazowiecki": { lat: 52.2499, lng: 20.8022 },
      "Plock": { lat: 52.5463, lng: 19.7065 },
      "Mlawa": { lat: 53.1199, lng: 20.3822 },
      "Pultu—Å–∫": { lat: 52.7099, lng: 21.0822 },
      "Lomianki": { lat: 52.3299, lng: 20.8722 },
      "Blonie": { lat: 52.1999, lng: 20.6222 },

      // Opolskie
      "Opole": { lat: 50.6751, lng: 17.9213 },
      "Kƒôdzierzyn-Ko≈∫le": { lat: 50.3490, lng: 18.2136 },
      "Nysa": { lat: 50.4737, lng: 17.3335 },
      "Brzeg": { lat: 50.8609, lng: 17.4666 },
      "Kluczbork": { lat: 50.9722, lng: 18.2184 },
      "Prudnik": { lat: 50.3232, lng: 17.5859 },
      "Strzelce Opolskie": { lat: 50.5084, lng: 18.3070 },
      "Krapkowice": { lat: 50.4748, lng: 17.9647 },
      "G≈Çubczyce": { lat: 50.2021, lng: 17.8293 },
      "Namys≈Ç√≥w": { lat: 51.0721, lng: 17.7293 },
      "Ozimek": { lat: 50.6721, lng: 18.2193 },
      "Zdzieszowice": { lat: 50.4021, lng: 18.1393 },
      "G≈Çog√≥wek": { lat: 50.3521, lng: 17.8593 },
      "Niemodlin": { lat: 50.6421, lng: 17.6293 },
      "Paczk√≥w": { lat: 50.4621, lng: 17.0093 },
      "Otmuch√≥w": { lat: 50.4521, lng: 17.1693 },
      "Gogolin": { lat: 50.4821, lng: 18.0193 },
      "Le≈õnica": { lat: 50.8321, lng: 17.8493 },
      "Ujazd": { lat: 50.6021, lng: 18.0993 },
      "Kolonowskie": { lat: 50.6521, lng: 18.3093 },
      "Bia≈Ça": { lat: 50.1621, lng: 17.5093 },
      "Korfant√≥w": { lat: 50.1721, lng: 17.5593 },
      "Babor√≥w": { lat: 50.1421, lng: 18.0393 },
      "Kietrz": { lat: 50.0821, lng: 18.1993 },
      "Zawadzkie": { lat: 50.6321, lng: 18.4693 },
      "Dobrodzien": { lat: 50.7321, lng: 18.4093 },
      "Wo≈Çcz√≥w": { lat: 50.7021, lng: 18.4893 },
      "Byczyna": { lat: 51.1121, lng: 18.2193 },
      "Praszka": { lat: 51.0521, lng: 18.4593 },
      "Gorz√≥w ≈ölƒÖski": { lat: 50.9321, lng: 18.4393 },

      // Podkarpackie
      "Rzesz√≥w": { lat: 50.0413, lng: 21.9990 },
      "Przemy≈õl": { lat: 49.7839, lng: 22.7681 },
      "Stalowa Wola": { lat: 50.5820, lng: 22.0528 },
      "Mielec": { lat: 50.2876, lng: 21.4242 },
      "Tarnobrzeg": { lat: 50.5734, lng: 21.6795 },
      "Krosno": { lat: 49.6886, lng: 21.7707 },
      "Jaros≈Çaw": { lat: 50.0167, lng: 22.6774 },
      "Sanok": { lat: 49.5556, lng: 22.2069 },
      "Dƒôbica": { lat: 50.0516, lng: 21.4110 },
      "≈Åa≈Ñcut": { lat: 50.0670, lng: 22.2291 },
      "Jas≈Ço": { lat: 49.7452, lng: 21.4722 },
      "Przeworsk": { lat: 50.0589, lng: 22.4941 },
      "Ropczyce": { lat: 50.0504, lng: 21.6084 },
      "Le≈ºajsk": { lat: 50.2604, lng: 22.4184 },
      "Nisko": { lat: 50.5204, lng: 22.1384 },
      "Lubacz√≥w": { lat: 50.1604, lng: 23.1284 },
      "Ustrzyki Dolne": { lat: 49.4304, lng: 22.5984 },
      "Lesko": { lat: 49.4704, lng: 22.3284 },
      "Brzoz√≥w": { lat: 49.6904, lng: 22.0184 },
      "Strzy≈º√≥w": { lat: 49.8804, lng: 21.7784 },
      "Kolbuszowa": { lat: 50.2304, lng: 21.7684 },
      "Sƒôdzisz√≥w Ma≈Çopolski": { lat: 50.0504, lng: 21.9384 },
      "G≈Çog√≥w Ma≈Çopolski": { lat: 50.1604, lng: 21.9684 },
      "Soko≈Ç√≥w Ma≈Çopolski": { lat: 50.2404, lng: 21.8684 },
      "Rudnik nad Sanem": { lat: 50.4404, lng: 22.2484 },
      "Ulan√≥w": { lat: 50.4804, lng: 22.2784 },
      "Baran√≥w Sandomierski": { lat: 50.5104, lng: 21.7384 },
      "Ka≈Ñczuga": { lat: 49.9704, lng: 22.4084 },
      "Sieniawa": { lat: 50.1704, lng: 22.6084 },
      "Radymno": { lat: 49.9504, lng: 22.8084 },
      "Dyn√≥w": { lat: 49.8204, lng: 22.2284 },
      "B≈Ça≈ºowa": { lat: 49.9804, lng: 21.8384 },
      "Tyczyn": { lat: 49.9504, lng: 21.8984 },
      "Ryman√≥w": { lat: 49.5804, lng: 21.8584 },
      "Dukla": { lat: 49.5604, lng: 21.6784 },
      "Jedlicze": { lat: 49.6504, lng: 21.6084 },
      "Iwonicz-Zdr√≥j": { lat: 49.5704, lng: 21.7784 },
      "Ko≈Çaczyce": { lat: 49.8104, lng: 21.4584 },
      "Pilzno": { lat: 49.9804, lng: 21.2884 },
      "Czudec": { lat: 50.0404, lng: 21.8784 },
      "Niebylec": { lat: 50.0704, lng: 21.7484 },
      "Zag√≥rz": { lat: 49.5104, lng: 22.2784 },
      "Oleszyce": { lat: 50.0804, lng: 23.0384 },
      "Narol": { lat: 50.3404, lng: 23.3284 },
      "Cieszan√≥w": { lat: 50.1904, lng: 23.1784 },
      "Nowa Dƒôba": { lat: 50.4304, lng: 21.7584 },
      "Nowa Sarzyna": { lat: 50.3204, lng: 22.3284 },
      "Przec≈Çaw": { lat: 50.2804, lng: 22.4784 },
      "Radomy≈õl Wielki": { lat: 50.2004, lng: 21.2784 },

      // Podlaskie
      "Bia≈Çystok": { lat: 53.1325, lng: 23.1688 },
      "≈Åom≈ºa": { lat: 53.1780, lng: 22.0585 },
      "Suwa≈Çki": { lat: 54.1116, lng: 22.9308 },
      "August√≥w": { lat: 53.8433, lng: 22.9800 },
      "Grajewo": { lat: 53.6478, lng: 22.4565 },
      "Hajn√≥wka": { lat: 52.7441, lng: 23.5812 },
      "Zambr√≥w": { lat: 52.9854, lng: 22.2434 },
      "Bielsk Podlaski": { lat: 52.7666, lng: 23.1917 },
      "Sok√≥≈Çka": { lat: 53.4044, lng: 23.5052 },
      "Wysokie Mazowieckie": { lat: 52.9178, lng: 22.5179 },
      "Mo≈Ñki": { lat: 53.4078, lng: 22.8179 },
      "Sejny": { lat: 54.1078, lng: 23.3479 },
      "Kolno": { lat: 53.4178, lng: 22.0379 },
      "Siemiatycze": { lat: 52.4278, lng: 22.8679 },
      "DƒÖbrowa Bia≈Çostocka": { lat: 53.2078, lng: 23.2279 },
      "Supra≈õl": { lat: 53.2178, lng: 23.3379 },
      "Wasilk√≥w": { lat: 53.1978, lng: 23.2079 },
      "Czarna Bia≈Çostocka": { lat: 53.6378, lng: 23.2579 },
      "Choroszcz": { lat: 53.1478, lng: 23.0879 },
      "≈Åapy": { lat: 53.0778, lng: 22.8879 },
      "Nowogr√≥d": { lat: 53.3378, lng: 22.3379 },
      "Jedwabne": { lat: 53.2878, lng: 22.3079 },
      "Stawiski": { lat: 53.3678, lng: 22.1279 },
      "Knyszyn": { lat: 53.3178, lng: 22.9279 },
      "GoniƒÖdz": { lat: 53.4878, lng: 22.7379 },
      "Suchowola": { lat: 53.5778, lng: 23.1179 },
      "Krynki": { lat: 53.4678, lng: 23.7579 },
      "Lipsk": { lat: 52.7378, lng: 23.4579 },
      "Szczuczyn": { lat: 53.5678, lng: 22.2879 },
      "Rajgr√≥d": { lat: 53.7278, lng: 22.6779 },
      "Bra≈Ñsk": { lat: 52.7478, lng: 22.8479 },
      "Ciechanowiec": { lat: 52.6778, lng: 22.5079 },
      "Czy≈ºew": { lat: 52.8778, lng: 22.6679 },
      "Kleszczele": { lat: 52.6478, lng: 23.3179 },
      "Drohiczyn": { lat: 52.3978, lng: 22.6579 },
      "Tykocin": { lat: 53.2078, lng: 22.7679 },
      "Zab≈Çud√≥w": { lat: 53.0178, lng: 23.3179 },
      "Micha≈Çowo": { lat: 53.0478, lng: 23.7279 },
      "Sura≈º": { lat: 53.0678, lng: 22.9579 },
      "Bia≈Çowie≈ºa": { lat: 52.7078, lng: 23.8679 },
      "Narew": { lat: 52.7178, lng: 23.5079 },
      "Turo≈õ≈Ñ Ko≈õcielna": { lat: 53.0578, lng: 22.9979 },
      "Juchnowiec Ko≈õcielny": { lat: 53.1178, lng: 23.1479 },
      "Boƒáki": { lat: 52.6678, lng: 22.8579 },
      "Rudka": { lat: 52.5578, lng: 23.0279 },
      "Czeremcha": { lat: 52.5878, lng: 23.3479 },
      "Narewka": { lat: 52.8678, lng: 23.7079 },
      "Dubicze Cerkiewne": { lat: 52.3778, lng: 23.2879 },
      "Orla": { lat: 52.7278, lng: 23.3279 },
      "Kruszyniany": { lat: 53.2578, lng: 23.7679 },
      "Filip√≥w": { lat: 54.0778, lng: 22.7279 },
      "Punsk": { lat: 54.2578, lng: 22.8379 },
      "Przero≈õl": { lat: 54.1478, lng: 22.4679 },
      "Giby": { lat: 54.1178, lng: 22.6579 },
      "Rutka-Tartak": { lat: 54.3778, lng: 22.4979 },
      "Raczki": { lat: 54.0878, lng: 22.8179 },
      "Szypliszki": { lat: 54.2778, lng: 22.6879 },
      "Wi≈ºajny": { lat: 54.4078, lng: 22.8779 },
      "Go≈Çdap": { lat: 54.3078, lng: 22.3079 },

      // Pomorskie
      "Gda≈Ñsk": { lat: 54.3520, lng: 18.6466 },
      "Gdynia": { lat: 54.5189, lng: 18.5305 },
      "S≈Çupsk": { lat: 54.4641, lng: 17.0286 },
      "Sopot": { lat: 54.4418, lng: 18.5601 },
      "Tczew": { lat: 54.0913, lng: 18.7799 },
      "Starogard Gda≈Ñski": { lat: 53.9679, lng: 18.5258 },
      "Wejherowo": { lat: 54.6056, lng: 18.2370 },
      "Rumia": { lat: 54.5682, lng: 18.3895 },
      "Reda": { lat: 54.6054, lng: 18.3433 },
      "Pruszcz Gda≈Ñski": { lat: 54.2574, lng: 18.6329 },
      "Lƒôbork": { lat: 54.5406, lng: 17.7493 },
      "Malbork": { lat: 54.0364, lng: 19.0345 },
      "Ko≈õcierzyna": { lat: 54.1207, lng: 17.9756 },
      "Kartuzy": { lat: 54.3358, lng: 18.2044 },
      "Chojnice": { lat: 53.6958, lng: 17.5544 },
      "Kwidzyn": { lat: 53.7258, lng: 18.9344 },
      "Sztum": { lat: 53.9958, lng: 19.0244 },
      "Puck": { lat: 54.7258, lng: 18.4144 },
      "W≈Çadys≈Çawowo": { lat: 54.7958, lng: 18.4044 },
      "Jastarnia": { lat: 54.6958, lng: 18.6744 },
      "Hel": { lat: 54.6058, lng: 18.8044 },
      "Ustka": { lat: 54.5858, lng: 16.8644 },
      "≈Åeba": { lat: 54.7558, lng: 17.5644 },
      "Bytow": { lat: 54.1658, lng: 17.4944 },
      "Cz≈Çuch√≥w": { lat: 53.6658, lng: 17.3644 },
      "Gniew": { lat: 54.0058, lng: 18.8244 },
      "Pe≈Çplin": { lat: 53.9158, lng: 18.6544 },
      "Skarszewy": { lat: 54.0558, lng: 18.4644 },
      "Sk√≥rcz": { lat: 53.8858, lng: 18.7944 },
      "Czarna a": { lat: 53.9958, lng: 18.4644 },
      "Brusy": { lat: 54.0858, lng: 17.7044 },
      "Dzierzgo≈Ñ": { lat: 54.0258, lng: 19.3444 },
      "Prabuty": { lat: 53.7558, lng: 19.2144 },
      "Nowy Dw√≥r Gda≈Ñski": { lat: 54.2158, lng: 19.1244 },
      "Krynica Morska": { lat: 54.3758, lng: 19.4344 },
      "Czersk": { lat: 54.0158, lng: 17.9744 },
      "≈ªukowo": { lat: 54.3358, lng: 18.1444 },
      "Koscierzyna": { lat: 54.1258, lng: 17.9744 },
      "Debrzno": { lat: 54.4258, lng: 17.3444 },
      "Czarne": { lat: 54.2858, lng: 17.9044 },
      "Jastrzƒôbia G√≥ra": { lat: 54.8358, lng: 18.3044 },
      "Karwia": { lat: 54.8658, lng: 18.2344 },

      // ≈ölƒÖskie
      "Katowice": { lat: 50.2649, lng: 19.0238 },
      "Czƒôstochowa": { lat: 50.7971, lng: 19.1200 },
      "Sosnowiec": { lat: 50.2862, lng: 19.1041 },
      "Gliwice": { lat: 50.2945, lng: 18.6714 },
      "Zabrze": { lat: 50.3249, lng: 18.7856 },
      "Bytom": { lat: 50.3483, lng: 18.9384 },
      "Ruda ≈ölƒÖska": { lat: 50.2593, lng: 18.8644 },
      "Tychy": { lat: 50.1357, lng: 18.9985 },
      "DƒÖbrowa G√≥rnicza": { lat: 50.3249, lng: 19.2182 },
      "Chorz√≥w": { lat: 50.2946, lng: 18.9539 },
      "Jaworzno": { lat: 50.2053, lng: 19.2750 },
      "Jastrzƒôbie-Zdr√≥j": { lat: 49.9629, lng: 18.5937 },
      "Mys≈Çowice": { lat: 50.2084, lng: 19.1344 },
      "Siemianowice ≈ölƒÖskie": { lat: 50.3077, lng: 19.0357 },
      "≈ªory": { lat: 50.0453, lng: 18.7005 },
      "≈öwiƒôtoch≈Çowice": { lat: 50.2941, lng: 18.9173 },
      "Bƒôdzin": { lat: 50.3291, lng: 19.1269 },
      "Piekary ≈ölƒÖskie": { lat: 50.3825, lng: 18.9467 },
      "Tarnowskie G√≥ry": { lat: 50.4488, lng: 18.8564 },
      "Bielsko-Bia≈Ça": { lat: 49.8223, lng: 19.0448 },
      "Racib√≥rz": { lat: 50.0914, lng: 18.2186 },
      "Czelad≈∫": { lat: 50.3074, lng: 19.0787 },
      "Rybnik": { lat: 50.0971, lng: 18.5420 },
      "Miko≈Ç√≥w": { lat: 50.1734, lng: 18.9074 },
      "Knur√≥w": { lat: 50.2134, lng: 18.6574 },
      "Pszczyna": { lat: 49.9774, lng: 18.9474 },
      "Czechowice-Dziedzice": { lat: 49.9174, lng: 19.0074 },
      "O≈õwiƒôcim": { lat: 50.0374, lng: 19.2374 },
      "≈ªywiec": { lat: 49.6874, lng: 19.1974 },
      "Rydultowy": { lat: 50.1574, lng: 18.3874 },
      "Cieszy≈Ñ": { lat: 49.7474, lng: 18.6374 },
      "Ustro≈Ñ": { lat: 49.7174, lng: 18.8074 },
      "Wis≈Ça": { lat: 49.6574, lng: 18.8574 },
      "Skocz√≥w": { lat: 49.7774, lng: 18.8174 },
      "Bieru≈Ñ": { lat: 50.1074, lng: 19.1074 },
      "Radlin": { lat: 50.0674, lng: 18.4674 },
      "zis≈Çaw ≈ölƒÖski": { lat: 49.9974, lng: 18.4574 },
      "Czerwionka-Leszczyny": { lat: 50.1474, lng: 18.6374 },
      "Radzionk√≥w": { lat: 50.3774, lng: 18.9674 },
      "≈öwierklany": { lat: 50.1174, lng: 18.9374 },
      "Lƒôdziny": { lat: 50.1374, lng: 19.1374 },
      "Wojkowice": { lat: 50.3474, lng: 19.0474 },
      "Siewierz": { lat: 50.4574, lng: 19.2274 },
      "Orzesz√≥w": { lat: 50.1874, lng: 18.8874 },
      "Kozieg≈Çowy": { lat: 50.5774, lng: 19.1974 },
      "Poczesna": { lat: 50.8174, lng: 18.9974 },
      "Krzepice": { lat: 50.9674, lng: 18.6174 },
      "K≈Çobuck": { lat: 50.9074, lng: 18.9374 },
      "Myszk√≥w": { lat: 50.5774, lng: 19.3174 },
      "≈ªarki": { lat: 50.6274, lng: 19.3774 },
      "Koniecpol": { lat: 50.7774, lng: 19.6974 },
      "Blachownia": { lat: 50.8274, lng: 19.0574 },
      "Szczekociny": { lat: 50.6074, lng: 19.8274 },
      "Kazimierz G√≥rniczy": { lat: 50.2574, lng: 19.3074 },
      "≈Åazy": { lat: 50.4174, lng: 19.3974 },
      "Ogrodzieniec": { lat: 50.4474, lng: 19.5274 },
      "Pilica": { lat: 50.4674, lng: 19.6374 },
      "Krzanowice": { lat: 49.8874, lng: 18.1874 },
      "Ku≈∫nia Raciborska": { lat: 50.0574, lng: 18.3474 },
      "Toszek": { lat: 50.4274, lng: 18.4874 },
      "Pyskowice": { lat: 50.3874, lng: 18.6274 },
      "Ujazd": { lat: 50.6074, lng: 18.0974 },
      "Kalety": { lat: 50.5274, lng: 18.9174 },
      "Miasteczko ≈ölƒÖskie": { lat: 50.4774, lng: 18.9374 },
      "Szczyrk": { lat: 49.7174, lng: 19.0374 },
      "Buczkowice": { lat: 49.8574, lng: 19.1174 },
      "Wilamowice": { lat: 49.9474, lng: 19.0974 },
      "Koz≈Çy": { lat: 50.0874, lng: 18.2374 },
      "Bƒôdziny": { lat: 50.3274, lng: 19.1274 },
      "W≈Çadys≈Çawice": { lat: 50.1774, lng: 18.8474 },
      "Sosz≈Çowice": { lat: 50.8774, lng: 19.0874 },
      "Worek": { lat: 50.3774, lng: 19.4574 },
      "Sosnicowice": { lat: 50.4874, lng: 18.6374 },
      "Poreby": { lat: 49.7074, lng: 19.0774 },

      // ≈öwiƒôtokrzyskie
      "Kielce": { lat: 50.8661, lng: 20.6286 },
      "Ostrowiec ≈öwiƒôtokrzyski": { lat: 50.9293, lng: 21.3854 },
      "Starachowice": { lat: 51.0377, lng: 21.0712 },
      "Skar≈ºysko-Kamienna": { lat: 51.1157, lng: 20.8658 },
      "Ko≈Ñskie": { lat: 51.1936, lng: 20.4066 },
      "Sandomierz": { lat: 50.6803, lng: 21.7492 },
      "Jƒôdrzej√≥w": { lat: 50.6364, lng: 20.3035 },
      "Busko-Zdr√≥j": { lat: 50.4706, lng: 20.7186 },
      "W≈Çoszczowa": { lat: 50.8506, lng: 19.9686 },
      "Stasz√≥w": { lat: 50.5606, lng: 21.1686 },
      "Pi≈Ñcz√≥w": { lat: 50.5206, lng: 20.5286 },
      "Po≈Çaniec": { lat: 50.4306, lng: 21.2886 },
      "Kazimierza Wielka": { lat: 50.2706, lng: 20.4886 },
      "Chmielnik": { lat: 50.3906, lng: 20.7586 },
      "Wi≈õlica": { lat: 50.3506, lng: 20.6686 },
      "Dzia≈Çoszyce": { lat: 50.3606, lng: 20.3286 },
      "Skalbmierz": { lat: 50.3306, lng: 20.4586 },
      "Nowy Korczyn": { lat: 50.2906, lng: 21.1586 },
      "Opat√≥w": { lat: 50.7906, lng: 21.4586 },
      "O≈ºar√≥w": { lat: 50.8906, lng: 21.6186 },
      "Klimont√≥w": { lat: 50.6706, lng: 21.4886 },
      "Koprzywnica": { lat: 50.5906, lng: 21.5586 },
      "Zawichost": { lat: 50.8006, lng: 21.8586 },
      "Tar≈Ç√≥w": { lat: 50.3406, lng: 21.2786 },
      "Ole≈õnica": { lat: 50.9506, lng: 21.2286 },
      "Kun√≥w": { lat: 51.0306, lng: 21.3086 },
      "I≈Ç≈ºa": { lat: 51.1606, lng: 21.2786 },
      "Lipsko": { lat: 51.1006, lng: 21.6386 },
      "Zwole≈Ñ": { lat: 51.3406, lng: 21.5786 },
      "Rytwiany": { lat: 50.6206, lng: 20.9486 },
      "Pacan√≥w": { lat: 50.4706, lng: 20.9486 },
      "Stopnica": { lat: 50.4506, lng: 20.9086 },
      "S≈Çomniki": { lat: 50.2406, lng: 20.0686 },
      "Szczucin": { lat: 50.1106, lng: 20.7586 },
      "DƒÖbrowa Tarnowska": { lat: 50.1306, lng: 20.6286 },
      "Radgoszcz": { lat: 50.9306, lng: 20.2586 },
      "Secemin": { lat: 50.7506, lng: 20.4886 },
      "Ma≈Çogoszcz": { lat: 50.8206, lng: 20.2786 },
      "Sopo≈õcice": { lat: 50.8906, lng: 20.4286 },
      "Opat√≥w": { lat: 50.7906, lng: 21.4586 },
      "Suched≈Ç√≥w": { lat: 50.9106, lng: 20.8486 },
      "Chƒôciny": { lat: 50.7906, lng: 20.4586 },
      "Daleszyce": { lat: 50.7706, lng: 20.6786 },
      "Kun√≥w": { lat: 51.0306, lng: 21.3086 },
      "O≈ºar√≥w": { lat: 50.8906, lng: 21.6186 },
      "Osiek": { lat: 50.5406, lng: 21.8986 },
      "zis≈Çaw": { lat: 50.4906, lng: 20.3586 },
      "Staporku√≥w": { lat: 50.6606, lng: 21.4786 },
      "≈Åag√≥w": { lat: 50.8806, lng: 20.6986 },
      "Nowa S≈Çupia": { lat: 50.8506, lng: 20.9786 },
      "Wielebn√≥w": { lat: 50.4806, lng: 20.6486 },
      "Soko≈Ç√≥w": { lat: 50.3306, lng: 20.9286 },
      "Miƒôdzyg√≥rz": { lat: 50.2706, lng: 21.1886 },

      // Warmi≈Ñsko-Mazurskie
      "Olsztyn": { lat: 53.7799, lng: 20.4942 },
      "ElblƒÖg": { lat: 54.1564, lng: 19.4038 },
      "E≈Çk": { lat: 53.8280, lng: 22.3683 },
      "Ostr√≥da": { lat: 53.6946, lng: 19.9714 },
      "I≈Çawa": { lat: 53.5957, lng: 19.5693 },
      "Kƒôtrzyn": { lat: 54.0770, lng: 21.3756 },
      "Gi≈ºycko": { lat: 54.0402, lng: 21.7686 },
      "Braniewo": { lat: 54.3825, lng: 19.8239 },
      "MrƒÖgowo": { lat: 53.8643, lng: 21.3043 },
      "Bartoszyce": { lat: 54.2536, lng: 20.8082 },
      "Lidzbark Warmi≈Ñski": { lat: 54.1214, lng: 20.5769 },
      "Szczytno": { lat: 53.5599, lng: 20.9969 },
      "Pisz": { lat: 53.6299, lng: 21.8069 },
      "Nidzica": { lat: 53.3599, lng: 20.4269 },
      "Dzia≈Çdowo": { lat: 53.2399, lng: 20.1769 },
      "Goldap": { lat: 54.3099, lng: 22.3069 },
      "Olecko": { lat: 54.0399, lng: 22.5069 },
      "Wƒôgorzewo": { lat: 54.2099, lng: 21.7469 },
      "Go≈Çdap": { lat: 54.3099, lng: 22.3069 },
      "Pas≈Çƒôk": { lat: 54.0699, lng: 19.6569 },
      "Reszel": { lat: 53.9599, lng: 21.1369 },
      "Sƒôpopol": { lat: 54.2699, lng: 21.0069 },
      "Korsze": { lat: 54.1599, lng: 21.1669 },
      "Barczewo": { lat: 53.8099, lng: 20.7069 },
      "Dobre Miasto": { lat: 53.9899, lng: 20.3869 },
      "Orneta": { lat: 54.1199, lng: 20.1269 },
      "Frombork": { lat: 54.3599, lng: 19.6869 },
      "Tolkmicko": { lat: 54.3299, lng: 19.4369 },
      "M≈Çynary": { lat: 54.1899, lng: 19.3269 },
      "MorƒÖg": { lat: 54.0899, lng: 19.9269 },
      "G√≥rowo I≈Çaweckie": { lat: 54.2799, lng: 20.4969 },
      "Susz": { lat: 53.7399, lng: 19.3569 },
      "Zalewo": { lat: 53.8799, lng: 19.5569 },
      "Mi≈Çakowo": { lat: 53.9699, lng: 20.4869 },
      "Mi≈Çom≈Çyn": { lat: 53.7699, lng: 19.8669 },
      "Lubawa": { lat: 53.6199, lng: 19.7469 },
      "Biskupiec": { lat: 53.8699, lng: 20.9569 },
      "Bisztynek": { lat: 54.0899, lng: 20.8869 },
      "Ryn": { lat: 53.9399, lng: 21.5469 },
      "Miko≈Çajki": { lat: 53.8099, lng: 21.5669 },
      "Orzysz": { lat: 53.8399, lng: 21.9469 },
      "Bia≈Ça Piska": { lat: 53.5999, lng: 21.4669 },
      "Ruciane-Nida": { lat: 53.8199, lng: 21.5269 },
      "Wƒôgorzyn": { lat: 53.8599, lng: 21.8569 },
      "Nowe Miasto Lubawskie": { lat: 53.4199, lng: 19.9569 },
      "MorƒÖg": { lat: 54.0899, lng: 19.9269 },
      "Jeziorany": { lat: 53.6999, lng: 20.5569 },
      "Kisielice": { lat: 53.5999, lng: 19.9769 },
      "Pieniƒô≈ºno": { lat: 54.2199, lng: 20.2369 },
      "Sƒôp√≥lno I≈Çaweckie": { lat: 53.6599, lng: 19.6669 },
      "Lidzbark": { lat: 54.1199, lng: 20.5769 },

      // Wielkopolskie
      "Pozna≈Ñ": { lat: 52.4064, lng: 16.9252 },
      "Kalisz": { lat: 51.7687, lng: 18.0901 },
      "Konin": { lat: 52.2230, lng: 18.2515 },
      "Leszno": { lat: 51.8407, lng: 16.5750 },
      "Gniezno": { lat: 52.5348, lng: 17.5828 },
      "Pi≈Ça": { lat: 53.1512, lng: 16.7384 },
      "Ostr√≥w Wielkopolski": { lat: 51.6523, lng: 17.8106 },
      "Krotoszyn": { lat: 51.6976, lng: 17.4376 },
      "Turek": { lat: 52.0164, lng: 18.5005 },
      "Jarocin": { lat: 51.9739, lng: 17.5008 },
      "≈örem": { lat: 52.0858, lng: 17.0147 },
      "Gosty≈Ñ": { lat: 51.8830, lng: 17.0106 },
      "Swarzƒôdz": { lat: 52.4130, lng: 17.0779 },
      "Lubo≈Ñ": { lat: 52.3453, lng: 16.8647 },
      "Mosina": { lat: 52.2456, lng: 16.9460 },
      "Wrze≈õnia": { lat: 52.3251, lng: 17.5666 },
      "Ko≈Ço": { lat: 52.2020, lng: 18.6379 },
      "S≈Çupca": { lat: 52.2892, lng: 17.8741 },
      "Wagrowiec": { lat: 52.8076, lng: 17.2008 },
      "Oborniku": { lat: 52.6521, lng: 16.8074 },
      "Wolsztyn": { lat: 52.1142, lng: 16.1142 },
      "Koscian": { lat: 52.0863, lng: 16.6500 },
      "Ko≈∫min Wielkopolski": { lat: 51.8370, lng: 17.4355 },
      "Pleszew": { lat: 51.9015, lng: 17.7865 },
      "Witkowo": { lat: 52.3165, lng: 17.3765 },
      "Rogo≈∫no": { lat: 52.7365, lng: 17.0365 },
      "Trzemeszno": { lat: 52.5665, lng: 17.8265 },
      "Murowana Go≈õlina": { lat: 52.6365, lng: 17.0065 },
      "Puszczykowo": { lat: 52.2765, lng: 16.8765 },
      "K√≥rnik": { lat: 52.2465, lng: 17.0965 },
      "Buk": { lat: 52.3565, lng: 16.7965 },
      "Kostrzyn": { lat: 52.4165, lng: 17.0565 },
      "Pobiedziska": { lat: 52.4765, lng: 17.2965 },
      "Opalenica": { lat: 52.2965, lng: 16.4165 },
      "Nowy Tomy≈õl": { lat: 52.3165, lng: 16.1365 },
      "Zbasy≈Ñ": { lat: 52.2465, lng: 15.9065 },
      "Grodzisk Wielkopolski": { lat: 52.2065, lng: 16.2765 },
      "Szamotu≈Çy": { lat: 52.6165, lng: 16.5765 },
      "Pniewy": { lat: 52.5165, lng: 16.3565 },
      "Krajenka": { lat: 53.3165, lng: 16.9065 },
      "Z≈Çot√≥w": { lat: 53.3565, lng: 17.0465 },
      "Chodzie≈º": { lat: 52.9965, lng: 17.0165 },
      "Czarnkow": { lat: 53.1365, lng: 16.5665 },
      "Trzcianka": { lat: 53.0365, lng: 16.4665 },
      "Wie≈Çe≈Ñ": { lat: 52.9165, lng: 16.1765 },
      "Krzy≈º Wielkopolski": { lat: 52.9065, lng: 15.8165 },
      "Ostrzesz√≥w": { lat: 51.4265, lng: 18.1365 },
      "Wrze≈õnia": { lat: 52.3268, lng: 17.5621 },
      "Ko≈Ço": { lat: 52.2068, lng: 18.6421 },
      "S≈Çupca": { lat: 52.2768, lng: 17.8721 },
      "WƒÖgrowiec": { lat: 52.8068, lng: 17.2021 },
      "Oborniki": { lat: 52.6568, lng: 16.8221 },
      "Wolsztyn": { lat: 52.1168, lng: 16.1121 },
      "Ko≈õcian": { lat: 52.0868, lng: 16.6521 },
      "Ko≈∫min Wielkopolski": { lat: 51.8368, lng: 17.4421 },
      "Pleszew": { lat: 51.9068, lng: 17.7921 },
      "Witkowo": { lat: 52.4768, lng: 17.7721 },
      "Rogo≈∫no": { lat: 52.7468, lng: 16.9321 },
      "Trzemeszno": { lat: 52.5668, lng: 17.8321 },
      "Murowana Go≈õlina": { lat: 52.5868, lng: 16.9121 },
      "Puszczykowo": { lat: 52.2868, lng: 16.8421 },
      "K√≥rnik": { lat: 52.2468, lng: 17.0921 },
      "Buk": { lat: 52.3368, lng: 16.7721 },
      "Kostrzyn": { lat: 52.4068, lng: 17.0521 },
      "Pobiedziska": { lat: 52.4768, lng: 17.2821 },
      "Rakoniewice": { lat: 52.1468, lng: 16.1021 },
      "Wielichowo": { lat: 52.1268, lng: 16.3521 },
      "Miedzych√≥d": { lat: 52.5968, lng: 15.8821 },
      "Sierak√≥w": { lat: 52.6468, lng: 15.7721 },
      "Wronki": { lat: 52.7068, lng: 16.3821 },
      "Margonin": { lat: 52.9768, lng: 17.2421 },
      "Uj≈õcie": { lat: 53.0868, lng: 16.7721 },
      "Drawsko": { lat: 52.8968, lng: 15.7121 },
      "Borek Wielkopolski": { lat: 51.9668, lng: 17.4721 },
      "Poniec": { lat: 51.7668, lng: 16.8121 },
      "Miejska G√≥rka": { lat: 51.6768, lng: 17.3621 },
      "Jutrosin": { lat: 51.5968, lng: 17.5421 },
      "Pyzdry": { lat: 52.1268, lng: 17.6921 },
      "Zag√≥r√≥w": { lat: 52.1668, lng: 17.8921 },
      "≈ölesin": { lat: 52.1968, lng: 18.4221 },
      "Kleczew": { lat: 52.1468, lng: 18.2021 },
      "Sompolno": { lat: 52.3968, lng: 18.5021 },
      "Golina": { lat: 52.2268, lng: 17.9521 },
      "Kazimierz Biskupi": { lat: 52.2768, lng: 18.0821 },
      "Wilczyn": { lat: 52.1168, lng: 18.0021 },
      "Grab√≥w nad ProsnƒÖ": { lat: 51.3668, lng: 18.1021 },
      "Nekla": { lat: 52.3768, lng: 17.4021 },
      "Czerniejewo": { lat: 52.4968, lng: 17.7021 },
      "Kƒôpno": { lat: 51.2768, lng: 17.9921 },
      "Kleparz": { lat: 52.4668, lng: 17.9821 },
      "Stresz√≥w": { lat: 52.4368, lng: 17.1821 },
      "Zbasy≈Ñ": { lat: 52.2468, lng: 15.9121 },
      "Grzywna": { lat: 52.2168, lng: 16.0821 },
      "Knƒôpowo": { lat: 52.1968, lng: 16.3721 },
      "Kapiel": { lat: 53.2868, lng: 16.8921 },
      "Jastrowice": { lat: 53.3768, lng: 17.1221 },
      "Rawicko": { lat: 51.9568, lng: 17.5821 },
      "Kro≈õnice": { lat: 51.7268, lng: 17.4721 },
      "Sieraki": { lat: 51.5668, lng: 17.6521 },
      "Mieszk√≥w": { lat: 51.4868, lng: 17.7221 },
      "Czemio": { lat: 51.4268, lng: 17.8521 },
      "Brodniƒá": { lat: 51.7568, lng: 17.8721 },
      "Dolsk": { lat: 52.1168, lng: 17.0821 },
      "Klecz√≥w": { lat: 52.0768, lng: 17.4821 },
      "Stawiszyn": { lat: 52.0368, lng: 18.1221 },
      "Gozdowo": { lat: 52.3568, lng: 18.4721 },
      "Rych≈Çy": { lat: 52.1968, lng: 18.6821 },
      "Lw√≥wek": { lat: 52.4868, lng: 17.7821 },
      "Orchowo": { lat: 52.1568, lng: 18.1021 },
      "Miko≈Çaj√≥w": { lat: 51.3968, lng: 18.0421 },
      "Dorgon": { lat: 51.2968, lng: 18.0721 },
      "Olsz√≥wka": { lat: 52.3568, lng: 17.5021 },
      "Soboty": { lat: 51.2568, lng: 18.0121 },

      // Zachodniopomorskie
      "Szczecin": { lat: 54.4285, lng: 14.5528 },
      "Koszalin": { lat: 54.1943, lng: 16.1714 },
      "Stargard": { lat: 53.3369, lng: 15.0505 },
      "Ko≈Çobrzeg": { lat: 54.1759, lng: 15.5831 },
      "≈öwinouj≈õcie": { lat: 53.9076, lng: 14.2472 },
      "Szczecinek": { lat: 53.7090, lng: 16.6932 },
      "Wa≈Çcz": { lat: 53.2742, lng: 16.4764 },
      "≈öwidwin": { lat: 53.7766, lng: 15.7850 },
      "Bia≈Çogard": { lat: 54.0071, lng: 15.9899 },
      "Gryfino": { lat: 53.2532, lng: 14.4892 },
      "Kamie≈Ñ Pomorski": { lat: 53.9678, lng: 14.7693 },
      "≈Åobez": { lat: 53.6373, lng: 15.6200 },
      "My≈õlib√≥rz": { lat: 52.9322, lng: 14.8692 },
      "Goleni√≥w": { lat: 53.5615, lng: 14.8285 },
      "Nowogard": { lat: 53.6715, lng: 15.1185 },
      "Police": { lat: 53.5515, lng: 14.5685 },
      "Gryfice": { lat: 54.2915, lng: 15.1985 },
      "Trzebiat√≥w": { lat: 54.0815, lng: 15.2685 },
      "Dar≈Çowo": { lat: 54.4215, lng: 16.4085 },
      "S≈Çawno": { lat: 54.3615, lng: 16.6785 },
      "Ustka": { lat: 54.5815, lng: 16.8585 },
      "Sian√≥w": { lat: 54.2315, lng: 16.4785 },
      "Polany": { lat: 53.8615, lng: 16.7985 },
      "Bobolice": { lat: 54.1315, lng: 16.5785 },
      "Barwice": { lat: 53.7415, lng: 16.2985 },
      "Borne Sulinowo": { lat: 53.5715, lng: 16.4885 },
      "Czaplinek": { lat: 53.5515, lng: 16.2285 },
      "Drawsko Pomorskie": { lat: 53.5315, lng: 15.8085 },
      "Z≈Çocieniec": { lat: 53.5415, lng: 16.0185 },
      "Miros≈Çawiec": { lat: 53.3915, lng: 16.0885 },
      "Tuczno": { lat: 53.3715, lng: 16.1485 },
      "P≈Çoty": { lat: 53.7915, lng: 15.2685 },
      "Resko": { lat: 53.7715, lng: 15.4085 },
      "Wƒôgorzyno": { lat: 53.6515, lng: 15.2385 },
      "Dobra": { lat: 53.2115, lng: 14.6785 },
      "Chocin": { lat: 53.5115, lng: 14.6585 },
      "Maszewo": { lat: 53.4815, lng: 14.6285 },
      "Golczewo": { lat: 53.8115, lng: 15.2985 },
      "Stepnica": { lat: 53.6715, lng: 14.6085 },
      "Miƒôdzyzdroje": { lat: 53.9215, lng: 14.4485 },
      "Wolin": { lat: 53.8415, lng: 14.6185 },
      "Dziwn√≥w": { lat: 54.0315, lng: 14.7485 },
      "Rewal": { lat: 54.0915, lng: 15.0185 },
      "Pogorzelica": { lat: 54.1315, lng: 15.0985 },
      "Niechorze": { lat: 54.0815, lng: 14.8285 },
      "Trzeb√≥sz": { lat: 53.8715, lng: 15.3585 },
      "Mielno": { lat: 54.2615, lng: 16.0685 },
      "Ustronie Morskie": { lat: 54.2715, lng: 16.1485 },
      "Sarbinowo": { lat: 54.3315, lng: 15.7885 },
      "I≈Ñsko": { lat: 53.4215, lng: 15.5385 },
      "P√≥≈Çczno": { lat: 53.6815, lng: 16.4585 },
      "Recz": { lat: 53.3315, lng: 15.3885 },
      "Dobrzany": { lat: 53.0815, lng: 15.7685 },
      "Wieduchowa": { lat: 53.0315, lng: 14.6885 },
      "Chojnino": { lat: 52.9815, lng: 14.8485 },
      "Trzci≈Ñsko-Zdr√≥j": { lat: 52.9615, lng: 14.8985 },
      "Cedynia": { lat: 52.8715, lng: 14.1885 },
      "Mieszkowice": { lat: 52.7715, lng: 14.3385 },
      "Dƒôbno": { lat: 52.6615, lng: 14.6685 },
      "Barlinek": { lat: 52.9615, lng: 15.2185 },
      "Pe≈Çczyce": { lat: 52.8615, lng: 14.4085 },
      "Lipiany": { lat: 52.8915, lng: 15.1885 },
      "Pyrzyce": { lat: 53.1415, lng: 14.8985 },
      "Bielice": { lat: 53.0615, lng: 15.1985 },
      "Kozielice": { lat: 53.3915, lng: 14.9985 },
      "Warnice": { lat: 53.2515, lng: 14.7285 },
      "Stare Czarnowo": { lat: 53.1715, lng: 14.9185 }
    };


    // Globalne zmienne
    let currentVoivodeship = null;
    let currentCity = null;
    let selectedVoivodeship = null;
    let selectedCity = null;
    let map = null;
    let elements = [];
    let userLocation = null;
    let activeFilters = new Set(['drinking_water', 'toilets_free', 'toilets_paid', 'toilets_unknown', 'atm', 'pharmacy', "restaurant"]);
    let markersLayers = {};
    let currentPointForComment = null;
    let selectedCommentStatus = null;

    // Inicjalizacja
    document.addEventListener('DOMContentLoaded', function() {
      generateVoivodeshipCards();
      loadFilterPreferences();
    });

    // Generowanie kart wojew√≥dztw
    function generateVoivodeshipCards() {
      const grid = document.getElementById('voivodeship-grid');
      grid.innerHTML = '';
      
      Object.keys(WOJ_MIASTA).forEach(voivodeship => {
        const data = WOJ_MIASTA[voivodeship];
        const card = document.createElement('div');
        card.className = 'voivodeship-card';
        card.onclick = () => selectVoivodeship(voivodeship);
        
        let imageName;
        if (voivodeship === 'Mazowieckie') {
          imageName = 'mazowieckie';
        } else {
          imageName = voivodeship.toLowerCase()
            .replace(/ƒÖ/g, 'a')
            .replace(/ƒá/g, 'c')
            .replace(/ƒô/g, 'e')
            .replace(/≈Ç/g, 'l')
            .replace(/≈Ñ/g, 'n')
            .replace(/√≥/g, 'o')
            .replace(/≈õ/g, 's')
            .replace(/≈∫/g, 'z')
            .replace(/≈º/g, 'z')
            .replace(/\s+/g, '-');
        }
        
        card.innerHTML = `
          <img src="/${imageName}.png" alt="${voivodeship}" class="voivodeship-image" loading="lazy">
          <div class="voivodeship-content">
            <div class="voivodeship-name">${voivodeship}</div>
            <div class="voivodeship-cities">
              <i class="fas fa-city"></i>
              ${data.cities.length} miast
            </div>
          </div>
        `;
        
        grid.appendChild(card);
      });
    }

    // Wyb√≥r wojew√≥dztwa
    function selectVoivodeship(voivodeship) {
      currentVoivodeship = voivodeship;
      document.getElementById('city-title').textContent = `Miasta w wojew√≥dztwie ${voivodeship}`;
      
      const grid = document.getElementById('city-grid');
      grid.innerHTML = '';
      
      WOJ_MIASTA[voivodeship].cities.forEach(city => {
        const card = document.createElement('div');
        card.className = 'city-card';
        card.textContent = city;
        card.onclick = () => selectCity(city);
        grid.appendChild(card);
      });
      
      document.getElementById('voivodeship-section').classList.add('hidden');
      document.getElementById('city-section').classList.remove('hidden');
   document.getElementById('main-header').classList.add('hidden');
    
      showHomeButton();
      
    }

    // Wyb√≥r miasta
    function selectCity(city) {
      currentCity = city;
      document.getElementById('selected-title').textContent = `${city}, ${currentVoivodeship}`;
      
      document.getElementById('city-section').classList.add('hidden');
      document.getElementById('selected-section').classList.remove('hidden');
    }

    // Powr√≥t do wojew√≥dztw
    function showVoivodeshipSelection() {
      currentVoivodeship = null;
      currentCity = null;
      elements = [];
      
      document.getElementById('city-section').classList.add('hidden');
      document.getElementById('selected-section').classList.add('hidden');
      // removed old filter-card line;
      document.getElementById('map-card').style.display = 'none';
      document.getElementById('voivodeship-section').classList.remove('hidden');
   document.getElementById('main-header').classList.remove('hidden');
   hideHomeButton();
    }

    // Powr√≥t do miast
    function showCitySelection() {
      currentCity = null;
      elements = [];
      
      document.getElementById('selected-section').classList.add('hidden');
      // removed old filter-card line;
      document.getElementById('map-card').style.display = 'none';
      document.getElementById('city-section').classList.remove('hidden');
    }

// Geolokalizacja - ciƒÖg≈Çe ≈õledzenie
let watchId = null;
let mapInitialized = false;

function getUserLocation() {
  if (!navigator.geolocation) {
    showError('Geolokalizacja nie jest obs≈Çugiwana przez TwojƒÖ przeglƒÖdarkƒô.');
    return;
  }

  const button = document.querySelector('.geolocation-btn');
  const locationText = document.getElementById('location-text');

  button.disabled = true;
  locationText.textContent = 'Okre≈õlanie lokalizacji...';

  watchId = navigator.geolocation.watchPosition(
    (position) => {
      userLocation = {
        latitude: position.coords.latitude,
        longitude: position.coords.longitude
      };

      button.disabled = false;
      locationText.textContent = 'Lokalizacja okre≈õlona ‚úì';
      hideError();

      if (!mapInitialized) {
        // üîπ reverse geocoding ‚Üí ustalenie miasta
        fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${userLocation.latitude}&lon=${userLocation.longitude}&zoom=10&addressdetails=1`)
          .then(r => r.json())
          .then(data => {
            const addr = data.address || {};
            currentCity = addr.city || addr.town || addr.village || addr.county;
            currentVoivodeship = addr.state || "nieokre≈õlone";
            showCityOnMap(); // teraz siƒô odpali poprawnie
          })
          .catch(err => console.error("Reverse geocode error", err));

        addUserLocationMarker();
        mapInitialized = true;

        // üîπ Schowaj stronƒô g≈Ç√≥wnƒÖ / wyb√≥r wojew√≥dztw
        const home = document.getElementById('home-section');
        const voivodeships = document.getElementById('voivodeship-section');
        if (home) home.style.display = 'none';
        if (voivodeships) voivodeships.style.display = 'none';

        // üîπ Poka≈º mapƒô na pe≈Çny ekran
        const mapContainer = document.getElementById('map');
        if (mapContainer) {
          mapContainer.style.display = 'block';
          mapContainer.style.height = '100vh'; // pe≈Çna wysoko≈õƒá
        }

      } else {
        if (userMarker) {
          userMarker.setLatLng([userLocation.latitude, userLocation.longitude]);
        }
      }
    },
    (error) => {
      button.disabled = false;
      locationText.textContent = 'Okre≈õl swojƒÖ lokalizacjƒô';

      let errorMessage = 'Nie uda≈Ço siƒô uzyskaƒá lokalizacji.';
      switch (error.code) {
        case error.PERMISSION_DENIED:
          errorMessage = 'Dostƒôp do lokalizacji zosta≈Ç odrzucony.';
          break;
        case error.POSITION_UNAVAILABLE:
          errorMessage = 'Informacje o lokalizacji sƒÖ niedostƒôpne.';
          break;
        case error.TIMEOUT:
          errorMessage = 'Przekroczono czas oczekiwania na lokalizacjƒô.';
          break;
      }
      showError(errorMessage);
    },
    {
      enableHighAccuracy: true,
      timeout: 10000,
      maximumAge: 0
    }
  );
}
    // Pokazanie miasta na mapie
// Pokazanie miasta na mapie
function showCityOnMap() {
  if (!currentCity) {
    showToast('Wybierz miasto przed pokazaniem mapy.', 'error');
    return;
  }

  // przewi≈Ñ do mapy
  setTimeout(() => {
    const mapEl = document.getElementById('map');
    if (mapEl) {
      mapEl.scrollIntoView({ behavior: 'smooth' });
    }
  }, 300);

  // Poka≈º sekcje mapy i filtr√≥w
  // removed old filter-card line;
  document.getElementById('map-card').style.display = 'block';

  if (!map) {
    initializeMap();
  }

  loadCityData();

  // üëâ schowaj nag≈Ç√≥wek
  document.getElementById('main-header').classList.add('hidden');
}

    // Reset widoku mapy
    function resetMapView() {
      if (map) {
        map.setView([52.0693, 19.4803], 6);
        userLocation = null;
        elements = [];
        clearAllMarkers();
        updateFilterCounts();
      }
    }

    // Inicjalizacja mapy
    function initializeMap() {
      map = L.map('map').setView([52.0693, 19.4803], 6);
      
      L.tileLayer(`https://api.maptiler.com/maps/streets/{z}/{x}/{y}.png?key=JMMIrX9Vv3G5aDeQsQlD`, {
  attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://www.maptiler.com/">MapTiler</a>',
  tileSize: 512,
  zoomOffset: -1,
  crossOrigin: true
}).addTo(map);

    }

    // ≈Åadowanie danych miasta z Overpass API
    async function loadCityData() {
      if (!currentCity || !currentVoivodeship) {
        showToast('Brak wybranego miasta.', 'error');
        return;
      }

      showLoading();
      hideError();

      // Pobierz wsp√≥≈Çrzƒôdne miasta
      let cityCoords = CITY_COORDINATES[currentCity];
      
      // Je≈õli nie ma wsp√≥≈Çrzƒôdnych w bazie, pobierz z Nominatim API
      if (!cityCoords) {
        try {
          const nominatimUrl = `https://nominatim.openstreetmap.org/search?q=${encodeURIComponent(currentCity)},Poland&format=json&limit=1`;
          const response = await fetch(nominatimUrl, {
            headers: {
              'User-Agent': 'JAMIASTO-Poland-Facilities-Finder'
            }
          });
          
          if (!response.ok) {
            throw new Error('Nie mo≈ºna pobraƒá wsp√≥≈Çrzƒôdnych miasta');
          }
          
          const data = await response.json();
          
          if (data && data.length > 0) {
            cityCoords = {
              lat: parseFloat(data[0].lat),
              lng: parseFloat(data[0].lon)
            };
            
            // Zapisz wsp√≥≈Çrzƒôdne w pamiƒôci podrƒôcznej
            CITY_COORDINATES[currentCity] = cityCoords;
          } else {
            showError(`Nie znaleziono miasta ${currentCity} na mapie.`);
            hideLoading();
            return;
          }
        } catch (error) {
          console.error('B≈ÇƒÖd pobierania wsp√≥≈Çrzƒôdnych:', error);
          showError('Nie mo≈ºna pobraƒá wsp√≥≈Çrzƒôdnych miasta. Spr√≥buj ponownie.');
          hideLoading();
          return;
        }
      }

      // Zapytanie do Overpass API o punkty w promieniu 25km od centrum miasta
      const radius = 10000; // 10km w metrach
      const query = `
        [out:json][timeout:60];
              (
          node["amenity"~"^(drinking_water|toilets|atm|pharmacy)$"](around:${radius},${cityCoords.lat},${cityCoords.lng});
          way["amenity"~"^(drinking_water|toilets|atm|pharmacy)$"](around:${radius},${cityCoords.lat},${cityCoords.lng});
          relation["amenity"~"^(drinking_water|toilets|atm|pharmacy)$"](around:${radius},${cityCoords.lat},${cityCoords.lng});
          node["leisure"="playground"](around:${radius},${cityCoords.lat},${cityCoords.lng});
          way["leisure"="playground"](around:${radius},${cityCoords.lat},${cityCoords.lng});
          node["sport"="skateboard"](around:${radius},${cityCoords.lat},${cityCoords.lng});
          way["sport"="skateboard"](around:${radius},${cityCoords.lat},${cityCoords.lng});
        node["amenity"="restaurant"](around:${radius},${cityCoords.lat},${cityCoords.lng});
    way["amenity"="restaurant"](around:${radius},${cityCoords.lat},${cityCoords.lng});
    relation["amenity"="restaurant"](around:${radius},${cityCoords.lat},${cityCoords.lng});
        );
        out center meta;
      `;

      console.log('üîç Szukam punkt√≥w dla:', currentCity, 'Wsp√≥≈Çrzƒôdne:', cityCoords, 'Promie≈Ñ:', radius+'m');
      
      const overpassUrl = 'https://overpass-api.de/api/interpreter';
      
      fetch(overpassUrl, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/x-www-form-urlencoded',
        },
        body: `data=${encodeURIComponent(query)}`
      })
      .then(response => {
        console.log('üì° Odpowied≈∫ API status:', response.status);
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        return response.json();
      })
      .then(data => {
        console.log('üìä Dane z Overpass:', data);
        hideLoading();
        
        elements = data.elements || [];
        
        console.log('üéØ Znaleziono element√≥w:', elements.length);
        if (elements.length > 0) {
          console.log('üîç Pierwsze 3 elementy:', elements.slice(0,3));
        }
        
        if (elements.length === 0) {
          showToast(`‚ö†Ô∏è Brak publicznych punkt√≥w w okolicy ${currentCity}. Spr√≥buj wiƒôksze miasto lub sprawd≈∫ inne wojew√≥dztwo.`, 'warning');
        } else {
          showToast(`‚úÖ Znaleziono ${elements.length} punkt√≥w w okolicy ${currentCity}!`, 'success');
        }

        processMapData();
updateFilterCounts();

// flaga ustawiana z selectCityFromSearch() ‚Äî je≈õli true, wymusimy centrowanie na mie≈õcie
const forceCity = (window._forceCenterToCity === true);

if (userLocation && !forceCity) {
  // mamy lokalizacjƒô u≈ºytkownika i nie wymuszono centrowania na mie≈õcie
  map.setView([userLocation.latitude, userLocation.longitude], 13);
  addUserLocationMarker();
} else {
  // centrujemy na wpisanym mie≈õcie (domy≈õlnie)
  map.setView([cityCoords.lat, cityCoords.lng], 12);

  if (elements.length > 0) {
    const coords = elements.map(el => {
      const lat = el.lat || (el.center && el.center.lat);
      const lon = el.lon || (el.center && el.center.lon);
      return (lat && lon) ? [lat, lon] : null;
    }).filter(Boolean);

    if (coords.length) {
      const bounds = L.latLngBounds(coords);
      if (bounds.isValid()) map.fitBounds(bounds, { padding: [20, 20] });
    }
  }
}

// resetujemy flagƒô ≈ºeby kolejne wywo≈Çania dzia≈Ça≈Çy normalnie
window._forceCenterToCity = false;
      })
      .catch(error => {
        hideLoading();
        console.error('B≈ÇƒÖd podczas pobierania danych:', error);
        
        // Pokazuj bardziej szczeg√≥≈Çowe b≈Çƒôdy
        let errorMessage = 'B≈ÇƒÖd podczas pobierania danych';
        if (error.name === 'TypeError') {
          errorMessage = 'Brak po≈ÇƒÖczenia z internetem lub serwer niedostƒôpny';
        } else if (error.message.includes('timeout')) {
          errorMessage = 'Przekroczono czas oczekiwania. Spr√≥buj ponownie.';
        } else {
          errorMessage = `B≈ÇƒÖd: ${error.message}`;
        }

        
        showError(errorMessage);
      });
    }
    // Przetwarzanie danych mapy
    function processMapData() {
      console.log('üîÑ Przetwarzam dane mapy, element√≥w:', elements.length);
      
      // Wyczy≈õƒá istniejƒÖce markery
      clearAllMarkers();

      // Grupuj elementy wed≈Çug typu
      const groupedElements = {
        drinking_water: [],
        toilets_free: [],
        toilets_paid: [],
        toilets_unknown: [],
        atm: [],
        pharmacy: [],
        skatepark: [],
        playground: [],
        restaurant: []
     };

      elements.forEach((element, index) => {
        const filterType = getFilterType(element);
        console.log(`üìç Element ${index+1}:`, element.tags?.amenity, '‚Üí', filterType);
        if (filterType && groupedElements[filterType]) {
          groupedElements[filterType].push(element);
        }
      });
      
      console.log('üìä Pogrupowane elementy:', Object.entries(groupedElements).map(([type, arr]) => `${type}: ${arr.length}`));

      // Utw√≥rz warstwy marker√≥w dla ka≈ºdego typu
      Object.entries(groupedElements).forEach(([filterType, elementList]) => {
        console.log(`üèóÔ∏è Tworzƒô markery dla ${filterType}: ${elementList.length} element√≥w`);
        const layer = L.layerGroup();
        
        elementList.forEach((element, idx) => {
          const marker = createMarker(element);
          if (marker) {
            layer.addLayer(marker);
            console.log(`‚úÖ Marker ${idx+1}/${elementList.length} utworzony dla ${filterType}`);
          } else {
            console.warn(`‚ùå Nie mo≈ºna utworzyƒá markera ${idx+1} dla ${filterType}:`, element);
          }
        });
        
        markersLayers[filterType] = layer;
        console.log(`üìå Warstwa ${filterType} ma ${layer.getLayers().length} marker√≥w`);
      });

      console.log('üéØ Aktywne filtry:', [...activeFilters]);
      // Zastosuj filtry
      applyFilters();
    }
// --- helpery wymagane do obs≈Çugi godzin i tel ---
function formatTime(d) {
  if (!(d instanceof Date)) d = new Date(d);
  return d.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
}

function escapeHtml(str) {
  return String(str || '').replace(/[&<>"']/g, s => ({
    '&': '&amp;',
    '<': '&lt;',
    '>': '&gt;',
    '"': '&quot;',
    "'": '&#39;'
  })[s]);
}

function formatPhoneDisplay(p) {
  if (!p) return '';
  const digits = p.replace(/\\D/g,'');
  if (digits.length === 9) return digits.replace(/(\\d{3})(\\d{3})(\\d{3})/,'$1 $2 $3');
  if (digits.length === 11 && digits.startsWith('48')) return '+'+digits.replace(/(\\d{2})(\\d{3})(\\d{3})(\\d{3})/,'$1 $2 $3 $4');
  return p;
}
    // Tworzenie markera
    function createMarker(element) {
      const lat = element.lat || (element.center && element.center.lat);
      const lon = element.lon || (element.center && element.center.lon);
      
      if (!lat || !lon) return null;

      const color = getColor(element);
      const description = getDescription(element);
      const icon = createColored(color);
      
      const marker = L.marker([lat, lon], { icon: L.icon(icon) });
      
      // Pobierz informacje o nazwie i adresie
      const name = element.tags?.name || description;
      const addr = [
        element.tags?.['addr:street'],
        element.tags?.['addr:housenumber'],
        element.tags?.['addr:city']
      ].filter(Boolean).join(' ') || 'Brak dok≈Çadnego adresu';

      // Pobierz komentarze dla tego punktu
      const pointId = `${element.type}-${element.id}`;
      const comments = getCommentsForPoint(pointId);
      const commentsCount = comments.length;
      const averageRating = getAverageRating(comments);
      
// Utw√≥rz popup z informacjami i przyciskami
const amenity = element.tags?.amenity;
const website = element.tags?.website || element.tags?.url || null;
const phone = element.tags?.phone || element.tags?.contact_phone || null;
const displayName = element.tags?.name || getDescription(element);

const openingHours = element.tags?.opening_hours;
let openingInfo = "";

if (openingHours && typeof openingHours === 'string' && openingHours.trim() !== '') {
  try {
    if (typeof opening_hours !== 'undefined') {
      const oh = new opening_hours(openingHours);
      const now = new Date();
      const isOpen = oh.getState();
      // czytelny skr√≥t tygodniowy, np. "Mo-Fr 08:00-20:00; Sa 10:00-17:00; Su off"
      const weekPretty = oh.prettifyValue ? oh.prettifyValue({ conf: { rule_sep_string: '; ' } }) : String(openingHours);
      // dzi≈õ ‚Äî przedzia≈Çy (je≈õli biblioteka wspiera getOpenIntervals)
      let todayRange = 'zamkniƒôte';
      if (oh.getOpenIntervals) {
        const startOfDay = new Date(); startOfDay.setHours(0,0,0,0);
        const endOfDay = new Date(startOfDay); endOfDay.setHours(23,59,59,999);
        const intervals = oh.getOpenIntervals(startOfDay, endOfDay) || [];
        if (intervals.length) {
          todayRange = intervals.map(i => `${formatTime(i[0])}‚Äì${formatTime(i[1])}`).join(', ');
        }
      } else {
        // fallback: spr√≥buj u≈ºyƒá prettifyValue dla dziennego zakresu
        if (oh.prettifyValue) {
          todayRange = oh.prettifyValue({ compact: true }) || String(openingHours);
        } else {
          todayRange = String(openingHours);
        }
      }

      openingInfo = `
        <div style="margin:0 0 8px 0; font-size:13px; color:${isOpen ? '#2e7d32' : '#d32f2f'}; font-weight:500;">
          ${isOpen ? '‚úÖ Otwarte' : '‚ùå Zamkniƒôte'} ‚Äî ${todayRange}
        </div>
        <div style="font-size:12px; color:#666; margin-bottom:6px;">
          üïí Tygodniowo: ${escapeHtml(weekPretty)}
        </div>
      `;
    } else {
      // brak biblioteki opening_hours.js ‚Äî poka≈º surowy tekst bez crasha
      openingInfo = `<div style="margin:0 0 8px 0; font-size:13px; color:#666;">üïí Godziny: ${escapeHtml(openingHours)}</div>`;
    }
  } catch (err) {
    console.warn('Nie mo≈ºna sparsowaƒá opening_hours:', openingHours, err);
    openingInfo = `<div style="margin:0 0 8px 0; font-size:13px; color:#666;">üïí Godziny: ${escapeHtml(openingHours)}</div>`;
  }
} else {
  // brak danych -> nic nie wy≈õwietlamy
  openingInfo = '';
}

let popupContent = `
  <div style="min-width: 250px; font-family: 'Inter', sans-serif;">
    <h3 style="margin: 0 0 8px 0; font-family: 'Pops', sans-serif; font-weight: 600; color: #333; font-size: 16px;">
      ${displayName}
    </h3>
    ${openingInfo}
    <p style="margin: 0 0 8px 0; color: #666; font-size: 14px;">
      <i class="fas fa-map-marker-alt" style="margin-right: 4px;"></i>
      ${addr}
    </p>
    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px; flex-wrap: wrap;">
      <span style="background: ${color}; color: white; padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: 500;">
        ${description}
      </span>
    `;

// üîπ Dodatkowe przyciski dla restauracji
if (amenity === "restaurant") {
  if (website || phone) {
    popupContent += `<div style="display:flex; gap:6px; margin-top:6px; flex-wrap:wrap;">`;
    
    if (website) {
      popupContent += `
        <a href="${website}" target="_blank"
           style="flex:1; text-align:center; background:#007bff; color:white; padding:6px 10px; border-radius:6px; font-size:12px; text-decoration:none;">
          üåê Strona internetowa
        </a>`;
    }
    if (phone) {
      popupContent += `
        <a href="tel:${phone}"
           style="flex:1; text-align:center; background:#28a745; color:white; padding:6px 10px; border-radius:6px; font-size:12px; text-decoration:none;">
          üìû Zadzwo≈Ñ
        </a>`;
    }

    popupContent += `</div>`;
  }
}

// üîπ Oceny
if (averageRating > 0) {
  popupContent += `
      <div style="display: flex; align-items: center; gap: 4px; background: #fff3cd; padding: 4px 8px; border-radius: 12px; border: 1px solid #ffeaa7;">
        <span style="font-size: 12px; font-weight: 600; color: #856404;">
          ${getRatingStars(Math.round(averageRating))} ${averageRating}
        </span>
        <span style="font-size: 10px; color: #856404;">(${comments.filter(c => c.rating > 0).length} ocen)</span>
      </div>`;
}

popupContent += `</div>`;

// üîπ Reszta kodu (opinie, przyciski, Google Maps, itp.) ‚Äî zostaje bez zmian

      // Przyciski akcji
      popupContent += `
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 6px; margin-top: 8px;">
   
          <button onclick="openNavigation(${lat}, ${lon}, '${name.replace(/'/g, '\\\'')}')"
                  style="background: #2e7d32; color: white; border: none; padding: 6px 8px; border-radius: 6px; cursor: pointer; font-size: 11px; font-weight: 500;">
            <i class="fas fa-route"></i> Nawigacja
          </button>
    
          </div>
        <div style="display: grid; grid-template-columns: 1fr; gap: 6px; margin-top: 6px;">
          <button onclick="window.open('https://www.google.com/maps/dir//${lat},${lon}', '_blank')"
                  style="background: #f57c00; color: white; border: none; padding: 6px 8px; border-radius: 6px; cursor: pointer; font-size: 11px; font-weight: 500;">
            <i class="fas fa-external-link-alt"></i> Otw√≥rz w Google Maps
          </button>
        </div>
      `;

    

     

    // Bindujemy poczƒÖtkowy popup (bez dystansu)
marker.bindPopup(popupContent, {
  maxWidth: 300,
  className: 'custom-popup'
});

// ====== REPLACEMENT: marker click ‚Äî show distance (replace, don't append) ======
marker.on('click', function () {
  // preferuj globalny userLocation (ustawiany w getUserLocation)
  const UL = (typeof userLocation !== 'undefined' && userLocation) ? userLocation : (window.userLocation || null);

  // Je≈õli mapa nie istnieje, po prostu otw√≥rz popup bez liczenia
  if (typeof map === 'undefined' || !map) {
    marker.openPopup();
    return;
  }

  // Zawsze u≈ºywamy oryginalnej popupContent jako bazy, ≈ºeby nie doklejaƒá wielokrotnie.
  const baseContent = popupContent; // <--- TU jest kluczowa zmiana (nie u≈ºywaj popup.getContent())

  if (UL && typeof UL.latitude === 'number' && typeof UL.longitude === 'number') {
    // Oblicz dystans (Leaflet zwraca metry)
    const distMeters = map.distance(
      L.latLng(UL.latitude, UL.longitude),
      L.latLng(lat, lon)
    );

    const distanceText = distMeters >= 1000
      ? (distMeters / 1000).toFixed(2) + ' km'
      : Math.round(distMeters) + ' m';

    const newContent = baseContent + `
      <div style="margin-top:8px; font-weight:600; color:#444;">
        üìè Odleg≈Ço≈õƒá od Ciebie: ${distanceText}
      </div>`;

    const popup = marker.getPopup();
    if (popup) {
      popup.setContent(newContent); // zastƒôpuje zawarto≈õƒá ‚Äî nie dokleja
      marker.openPopup();
    } else {
      marker.bindPopup(newContent, { maxWidth: 300, className: 'custom-popup' }).openPopup();
    }
  } else {
    // brak lokalizacji
    const newContent = baseContent + `
      <div style="margin-top:8px; color:#777;">
        <i>Ustaw lokalizacjƒô (przycisk "Okre≈õl swojƒÖ lokalizacjƒô"), aby zobaczyƒá odleg≈Ço≈õƒá.</i>
      </div>`;
    const popup = marker.getPopup();
    if (popup) {
      popup.setContent(newContent);
      marker.openPopup();
    } else {
      marker.bindPopup(newContent, { maxWidth: 300, className: 'custom-popup' }).openPopup();
    }
  }

// ====== end replacement ======
  if (UL && typeof UL.latitude === 'number' && typeof UL.longitude === 'number') {
    // U≈ºywamy L.latLng ≈ºeby mieƒá pewno≈õƒá, ≈ºe Leaflet obliczy poprawnie
    const distMeters = map.distance(
      L.latLng(UL.latitude, UL.longitude),
      L.latLng(lat, lon)
    );

    const distanceText = distMeters >= 1000
      ? (distMeters / 1000).toFixed(2) + ' km'
      : Math.round(distMeters) + ' m';

    const newContent = baseContent + `
      <div style="margin-top:8px; font-weight:600; color:#444;">
        üìè Odleg≈Ço≈õƒá od Ciebie: ${distanceText}
      </div>`;

    if (popup) {
      popup.setContent(newContent);
      marker.openPopup();
    } else {
      marker.bindPopup(newContent, { maxWidth: 300, className: 'custom-popup' }).openPopup();
    }
  } else {
    // Nie mamy lokalizacji ‚Äî podpowied≈∫
    const newContent = baseContent + `
      <div style="margin-top:8px; color:#777;">
        <i>Ustaw lokalizacjƒô (przycisk "Okre≈õl swojƒÖ lokalizacjƒô"), aby zobaczyƒá odleg≈Ço≈õƒá.</i>
      </div>`;
    if (popup) {
      popup.setContent(newContent);
      marker.openPopup();
    } else {
      marker.bindPopup(newContent, { maxWidth: 300, className: 'custom-popup' }).openPopup();
    }
  }
});
return marker;
}
    // Dodawanie markera lokalizacji u≈ºytkownika
    function addUserLocationMarker() {
      if (!map || !userLocation) return;

      // Usu≈Ñ istniejƒÖcy marker u≈ºytkownika
      if (window.userMarker) {
        map.removeLayer(window.userMarker);
      }

      // Utw√≥rz ikonƒô dla lokalizacji u≈ºytkownika
      const userIcon = L.divIcon({
        html: `
          <div style="
            background: #1976d2; 
            border: 3px solid white; 
            border-radius: 50%; 
            width: 20px; 
            height: 20px; 
            box-shadow: 0 2px 10px rgba(25, 118, 210, 0.4);
            position: relative;
          ">
            <div style="
              position: absolute;
              background: #1976d2;
              width: 40px;
              height: 40px;
              border-radius: 50%;
              opacity: 0.3;
              top: -10px;
              left: -10px;
              animation: pulse 2s infinite;
            "></div>
          </div>
          <style>
            @keyframes pulse {
              0% { transform: scale(0.8); opacity: 0.3; }
              50% { transform: scale(1.2); opacity: 0.1; }
              100% { transform: scale(0.8); opacity: 0.3; }
            }
          </style>
        `,
        iconSize: [20, 20],
        iconAnchor: [10, 10],
        className: 'user-location-marker'
      });

      window.userMarker = L.marker([userLocation.latitude, userLocation.longitude], { 
        icon: userIcon,
        zIndexOffset: 1000
      }).addTo(map);

      window.userMarker.bindPopup(`
        <div style="text-align: center; font-family: 'Inter', sans-serif;">
          <h4 style="margin: 0 0 8px 0; color: #1976d2; font-family: 'Pops', sans-serif;">
            <i class="fas fa-location-arrow"></i> Twoja lokalizacja
          </h4>
          <p style="margin: 0; font-size: 12px; color: #666;">
            Wsp√≥≈Çrzƒôdne: ${userLocation.latitude.toFixed(6)}, ${userLocation.longitude.toFixed(6)}
          </p>
        </div>
      `, {
        offset: [0, -10]
      });
    }

    // Wyczyszczenie wszystkich marker√≥w
    function clearAllMarkers() {
      Object.values(markersLayers).forEach(layer => {
        if (map.hasLayer(layer)) {
          map.removeLayer(layer);
        }
      });
      markersLayers = {};
    }

    // Komentarze - funkcje
    function openCommentModal(pointId, pointName) {
      currentPointForComment = pointId;
      selectedCommentStatus = null;
      selectedRating = 0;
      
      document.getElementById('modal-point-name').textContent = pointName;
      document.getElementById('comment-text').value = '';
      document.getElementById('comment-author').value = '';
      
      // Resetuj przyciski statusu
      document.querySelectorAll('.status-btn').forEach(btn => {
        btn.classList.remove('active', 'working', 'needs-repair', 'not-working');
      });
      
      // Resetuj gwiazdki oceny
      updateStarDisplay(0);
      document.getElementById('rating-text').textContent = 'Kliknij gwiazdki aby oceniƒá';
      
      // Ukryj b≈Çƒôdy
      document.getElementById('status-error').style.display = 'none';
      document.getElementById('rating-error').style.display = 'none';
      document.getElementById('text-error').style.display = 'none';
      document.getElementById('author-error').style.display = 'none';
      
      updateCharCounter();
      document.getElementById('comment-modal').classList.add('show');
    }

    function closeCommentModal() {
      document.getElementById('comment-modal').classList.remove('show');
      currentPointForComment = null;
      selectedCommentStatus = null;
      selectedRating = 0;
    }

    function selectStatus(status) {
      selectedCommentStatus = status;
      
      // Resetuj wszystkie przyciski
      document.querySelectorAll('.status-btn').forEach(btn => {
        btn.classList.remove('active', 'working', 'needs-repair', 'not-working');
      });
      
      // Aktywuj wybrany przycisk
      const selectedBtn = document.querySelector(`[data-status="${status}"]`);
      selectedBtn.classList.add('active', status);
      
      // Ukryj b≈ÇƒÖd
      document.getElementById('status-error').style.display = 'none';
    }

    function updateCharCounter() {
      const textarea = document.getElementById('comment-text');
      const counter = document.getElementById('char-counter');
      const length = textarea.value.length;
      const maxLength = 500;
      
      counter.textContent = `${length}/${maxLength} znak√≥w`;
      
      // Zmie≈Ñ kolor w zale≈ºno≈õci od d≈Çugo≈õci
      counter.classList.remove('warning', 'danger');
      if (length > maxLength * 0.8) {
        counter.classList.add('warning');
      }
      if (length > maxLength * 0.95) {
        counter.classList.add('danger');
      }
    }

    // Obs≈Çuga formularza komentarza
    document.getElementById('comment-form').addEventListener('submit', function(e) {
      e.preventDefault();
      
      // Resetuj b≈Çƒôdy
      document.getElementById('status-error').style.display = 'none';
      document.getElementById('rating-error').style.display = 'none';
      document.getElementById('text-error').style.display = 'none';
      document.getElementById('author-error').style.display = 'none';
      
      // Walidacja
      let hasErrors = false;
      
      if (!selectedCommentStatus) {
        document.getElementById('status-error').style.display = 'flex';
        hasErrors = true;
      }
      
      if (!selectedRating || selectedRating === 0) {
        document.getElementById('rating-error').style.display = 'flex';
        hasErrors = true;
      }
      
      const commentText = document.getElementById('comment-text').value.trim();
      if (!commentText) {
        const textError = document.getElementById('text-error');
        textError.querySelector('span').textContent = 'Opis jest wymagany';
        textError.style.display = 'flex';
        hasErrors = true;
      } else if (commentText.length < 10) {
        const textError = document.getElementById('text-error');
        textError.querySelector('span').textContent = 'Opis musi mieƒá co najmniej 10 znak√≥w';
        textError.style.display = 'flex';
        hasErrors = true;
      }
      
      const authorName = document.getElementById('comment-author').value.trim();
      if (!authorName) {
        const authorError = document.getElementById('author-error');
        authorError.querySelector('span').textContent = 'Imiƒô/pseudonim jest wymagane';
        authorError.style.display = 'flex';
        hasErrors = true;
      } else if (authorName.length < 2) {
        const authorError = document.getElementById('author-error');
        authorError.querySelector('span').textContent = 'Imiƒô/pseudonim musi mieƒá co najmniej 2 znaki';
        authorError.style.display = 'flex';
        hasErrors = true;
      }
      
      if (hasErrors) return;
      
      // Zapisz komentarz
      const comment = {
        id: Date.now().toString(),
        pointId: currentPointForComment || 
            (window._currentAttractionForComment && window._currentAttractionForComment.id) || null,
        author: authorName,
        text: commentText,
        status: selectedCommentStatus,
        rating: selectedRating,
        createdAt: new Date().toISOString()
      };
      
      saveComment(comment);
      closeCommentModal();
      showToast('Opinia zosta≈Ça dodana pomy≈õlnie!', 'success');
      
      // Od≈õwie≈º dane na mapie
      processMapData();
    });

    // ZarzƒÖdzanie komentarzami w localStorage
    function saveComment(comment) {
      try {
        const comments = JSON.parse(localStorage.getItem('jamiasto_comments') || '[]');
        comments.push(comment);
        localStorage.setItem('jamiasto_comments', JSON.stringify(comments));
      } catch (error) {
        console.error('Error saving comment:', error);
      }
    }

    function getCommentsForPoint(pointId) {
      try {
        const comments = JSON.parse(localStorage.getItem('jamiasto_comments') || '[]');
        return comments.filter(comment => comment.pointId === pointId);
      } catch (error) {
        console.error('Error loading comments:', error);
        return [];
      }
    }

    function getStatusText(status) {
      switch (status) {
        case 'working': return 'Dzia≈Ça';
        case 'needs-repair': return 'Wymaga naprawy';
        case 'not-working': return 'Nie dzia≈Ça';
        default: return 'Nieznany';
      }
    }

    function getStatusColor(status) {
      switch (status) {
        case 'working': return '#2e7d32';
        case 'needs-repair': return '#f57c00';
        case 'not-working': return '#d32f2f';
        default: return '#666';
      }
    }

    // Toast notifications
    function showToast(message, type = 'info') {
      const toast = document.createElement('div');
      toast.className = 'toast';
      toast.style.transform = 'translateX(100%)';
      
      if (type === 'error') {
        toast.style.background = 'linear-gradient(135deg, #d32f2f, #b71c1c)';
        toast.innerHTML = `<i class="fas fa-exclamation-triangle" style="margin-right: 0.5rem;"></i>${message}`;
      } else if (type === 'success') {
        toast.style.background = 'linear-gradient(135deg, #2e7d32, #1b5e20)';
        toast.innerHTML = `<i class="fas fa-check-circle" style="margin-right: 0.5rem;"></i>${message}`;
      } else if (type === 'warning') {
        toast.style.background = 'linear-gradient(135deg, #f57c00, #ef6c00)';
        toast.innerHTML = `<i class="fas fa-exclamation-triangle" style="margin-right: 0.5rem;"></i>${message}`;
      } else {
        toast.style.background = 'linear-gradient(135deg, #1976d2, #1565c0)';
        toast.innerHTML = `<i class="fas fa-info-circle" style="margin-right: 0.5rem;"></i>${message}`;
      }
      
      document.body.appendChild(toast);
      
      // Animacja
      setTimeout(() => {
        toast.style.transform = 'translateX(0)';
      }, 100);
      
      // Usuniƒôcie po 3 sekundach
      setTimeout(() => {
        toast.style.transform = 'translateX(100%)';
        setTimeout(() => {
          document.body.removeChild(toast);
        }, 300);
      }, 3000);
    }

    // Pokazanie wszystkich opini dla punktu
    function showAllComments(pointId, pointName) {
      const comments = getCommentsForPoint(pointId);
      
      let content = `<div style="max-height: 400px; overflow-y: auto;">`;
      content += `<h3 style="margin-bottom: 1rem; color: #333;">üí¨ Wszystkie opinie: ${pointName}</h3>`;
      
      if (comments.length === 0) {
        content += `<p style="color: #666; text-align: center; padding: 2rem;">Brak opini dla tego punktu.</p>`;
      } else {
        comments.reverse().forEach(comment => {
          const statusText = getStatusText(comment.status);
          const statusColor = getStatusColor(comment.status);
          content += `<div style="border: 1px solid #eee; border-radius: 8px; padding: 1rem; margin-bottom: 1rem; background: white;">`;
          content += `<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">`;
          content += `<span style="font-weight: 600; color: #333;">${comment.author}</span>`;
          content += `<span style="background: ${statusColor}; color: white; padding: 0.2rem 0.6rem; border-radius: 0.4rem; font-size: 0.8rem; font-weight: 600;">${statusText}</span>`;
          content += `</div>`;
          
          // Dodaj ocenƒô gwiazdkowƒÖ je≈õli istnieje
          if (comment.rating && comment.rating > 0) {
            content += `<div style="margin-bottom: 0.5rem;">`;
            content += `<span style="font-size: 0.9rem;">${getRatingStars(comment.rating)}</span>`;
            content += ` <span style="color: #666; font-size: 0.8rem;">(${comment.rating}/5)</span>`;
            content += `</div>`;
          }
          
          content += `<div style="color: #555; line-height: 1.5; margin-bottom: 0.5rem;">${comment.text}</div>`;
          content += `<div style="color: #888; font-size: 0.8rem;">${new Date(comment.createdAt).toLocaleString('pl-PL')}</div>`;
          content += `</div>`;
        });
      }
      content += `</div>`;
      
      // Tworzenie prostego modala
      const modal = document.createElement('div');
      modal.style.cssText = `
        position: fixed;
        inset: 0;
        background: rgba(0,0,0,0.7);
        backdrop-filter: blur(4px);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1001;
        padding: 1rem;
      `;
      
      modal.innerHTML = `
        <div style="background: white; border-radius: 1rem; max-width: 600px; width: 100%; max-height: 80vh; position: relative;">
          <button onclick="this.closest('.modal-overlay, div').remove()" 
                  style="position: absolute; top: 1rem; right: 1rem; background: #f5f5f5; border: none; border-radius: 50%; width: 30px; height: 30px; cursor: pointer; display: flex; align-items: center; justify-content: center;">
            √ó
          </button>
          <div style="padding: 2rem;">
            ${content}
          </div>
        </div>
      `;
      
      document.body.appendChild(modal);
      
      // Zamkniƒôcie po klikniƒôciu t≈Ça
      modal.addEventListener('click', function(e) {
        if (e.target === modal) {
          document.body.removeChild(modal);
        }
      });
    }

    // Pomocnicze funkcje
 function getFilterType(element) {
  const amenity = element.tags?.amenity;
  const leisure = element.tags?.leisure;
  const sport = element.tags?.sport;
  
  if (amenity === "drinking_water") return "drinking_water";
  if (amenity === "atm") return "atm";
  if (amenity === "pharmacy") return "pharmacy";
  if (sport === "skateboard" || amenity === "skateboard_park") return "skatepark";
  if (leisure === "playground" || amenity === "playground") return "playground";
   if (amenity === "restaurant") return "restaurant";
   if (amenity === "toilets") {
    if (element.tags?.fee === "yes") return "toilets_paid";
    if (element.tags?.fee === "no") return "toilets_free";
    return "toilets_unknown";
  }
  return null;
}
function getColor(element) {
  const amenity = element.tags?.amenity;
  const sport = element.tags?.sport;
  const leisure = element.tags?.leisure;

  if (amenity === "drinking_water") return "blue";
  if (amenity === "atm") return "orange";
  if (amenity === "pharmacy") return "purple";

  if (amenity === "toilets") {
    if (element.tags?.fee === "yes") return "red";
    if (element.tags?.fee === "no") return "green";
    return "gray";
  }

  if (sport === "skateboard" || amenity === "skatepark" || amenity === "skateboard_park") return "black";
  if (leisure === "playground" || amenity === "playground") return "yellow";
  if (amenity === "restaurant") return "brown";

  return "gray";
}
    
   function getDescription(element) {
  const amenity = element.tags?.amenity;
  const sport = element.tags?.sport;
  const leisure = element.tags?.leisure;

  if (amenity === "drinking_water") return "wodop√≥j";
  if (amenity === "atm") return "Bankomat";
  if (amenity === "pharmacy") return "Apteka";

  if (amenity === "toilets") {
    if (element.tags?.fee === "yes") return "Toaleta (p≈Çatna)";
    if (element.tags?.fee === "no") return "Toaleta (bezp≈Çatna)";
    return "Toaleta";
  }

  if (sport === "skateboard" || amenity === "skatepark" || amenity === "skateboard_park") return "Skatepark";
  if (leisure === "playground" || amenity === "playground") return "Plac zabaw";
  if (amenity === "restaurant") return "Restauracja";

  return "Punkt";
}
 
    function createColored(color) {
      const svg = `
        <svg xmlns='http://www.w3.org/2000/svg' width='30' height='42' viewBox='0 0 24 34'>
          <path d='M12 0C6 0 1.5 4.7 1.5 10.2C1.5 16.9 12 34 12 34C12 34 22.5 16.9 22.5 10.2C22.5 4.7 18 0 12 0Z'
                fill='${color}' stroke='black' stroke-width='1'/>
          <circle cx='12' cy='10.2' r='4.0' fill='#ffffff' fill-opacity='0.9'
                  stroke='rgba(0,0,0,0.25)' stroke-width='0.4'/>
        </svg>`;
      
      const url = 'data:image/svg+xml;charset=UTF-8,' + encodeURIComponent(svg);
      return {
        iconUrl: url,
        iconSize: [30, 42],
        iconAnchor: [15, 42],
        popupAnchor: [0, -36]
      };
    }

    // Filtry
    function updateFilterCounts() {
      const counts = {
        drinking_water: 0,
        toilets_free: 0,
        toilets_paid: 0,
        toilets_unknown: 0,
        atm: 0,
        pharmacy: 0,
        skatepark: 0,
        playground: 0,
        restaurant: 0
      };

      elements.forEach(element => {
        const filterType = getFilterType(element);
        if (filterType) {
          counts[filterType]++;
        }
      });

      // Aktualizacja wy≈õwietlania liczb
      Object.keys(counts).forEach(filterType => {
        const filterItem = document.querySelector(`[data-type="${filterType}"]`);
        if (filterItem) {
          const countElement = filterItem.querySelector('.filter-count');
          const count = counts[filterType];
          countElement.textContent = count === 1 ? '1 punkt' : `${count} punkt√≥w`;
        }
      });

      updateFilterStatus();
    }

    function toggleFilter(filterType) {
      const filterItem = document.querySelector(`[data-type="${filterType}"]`);
      
      if (activeFilters.has(filterType)) {
        activeFilters.delete(filterType);
        filterItem.classList.remove('active');
      } else {
        activeFilters.add(filterType);
        filterItem.classList.add('active');
      }
      
      applyFilters();
      updateFilterStatus();
      saveFilterPreferences();
    }

    function selectAllFilters() {
      activeFilters = new Set(['drinking_water', 'toilets_free', 'toilets_paid', 'toilets_unknown', 'atm', 'pharmacy', 'skatepark', 'playground', "restaurant"]);
      
      document.querySelectorAll('.filter-item').forEach(item => {
        item.classList.add('active');
      });
      
      applyFilters();
      updateFilterStatus();
      saveFilterPreferences();
    }

    function deselectAllFilters() {
      activeFilters.clear();
      
      document.querySelectorAll('.filter-item').forEach(item => {
        item.classList.remove('active');
      });
      
      applyFilters();
      updateFilterStatus();
      saveFilterPreferences();
    }

    function applyFilters() {
      if (!map) return;

      console.log('üîß Aplikujƒô filtry:', [...activeFilters]);
      Object.entries(markersLayers).forEach(([filterType, layer]) => {
        const isActive = activeFilters.has(filterType);
        const isOnMap = map.hasLayer(layer);
        const markerCount = layer.getLayers().length;
        
        console.log(`üéõÔ∏è Filtr ${filterType}: aktywny=${isActive}, na mapie=${isOnMap}, marker√≥w=${markerCount}`);
        
        if (isActive) {
          if (!isOnMap) {
            map.addLayer(layer);
            console.log(`‚ûï Dodano warstwƒô ${filterType} do mapy`);
          }
        } else {
          if (isOnMap) {
            map.removeLayer(layer);
            console.log(`‚ûñ Usuniƒôto warstwƒô ${filterType} z mapy`);
          }
        }
      });
    }

    function updateFilterStatus() {
      const statusElement = document.getElementById('filter-status');
      const activeCount = activeFilters.size;
      const totalCount = 8;
      
      if (activeCount === 0) {
        statusElement.style.display = 'block';
        statusElement.style.background = '#ffebee';
        statusElement.style.borderColor = '#f44336';
        statusElement.style.color = '#c62828';
        statusElement.innerHTML = '<i class="fas fa-exclamation-triangle" style="margin-right: 0.5rem;"></i>Wszystkie kategorie sƒÖ ukryte';
      } else if (activeCount < totalCount) {
        statusElement.style.display = 'block';
        statusElement.style.background = '#e3f2fd';
        statusElement.style.borderColor = '#1976d2';
        statusElement.style.color = '#1565c0';
        statusElement.innerHTML = `Pokazujƒô <strong>${activeCount}</strong> z <strong>${totalCount}</strong> kategorii punkt√≥w`;
      } else {
        statusElement.style.display = 'none';
      }
    }

    function saveFilterPreferences() {
      try {
        localStorage.setItem('jamiasto_filters', JSON.stringify([...activeFilters]));
      } catch (error) {
        console.log('Could not save filter preferences:', error);
      }
    }

    function loadFilterPreferences() {
      try {
        const savedFilters = localStorage.getItem('jamiasto_filters');
        if (savedFilters) {
          const filters = JSON.parse(savedFilters);
          activeFilters = new Set(filters);
          
          // Aktualizacja UI
          document.querySelectorAll('.filter-item').forEach(item => {
            const filterType = item.getAttribute('data-type');
            if (activeFilters.has(filterType)) {
              item.classList.add('active');
            } else {
              item.classList.remove('active');
            }
          });
        }
      } catch (error) {
        console.log('Could not load filter preferences:', error);
      }
    }

    // Funkcje pomocnicze UI
    function showLoading() {
      document.getElementById('loading').classList.add('show');
    }

    function hideLoading() {
      document.getElementById('loading').classList.remove('show');
    }

    function showError(message) {
      const errorElement = document.getElementById('location-error');
      errorElement.querySelector('span').textContent = message;
      errorElement.style.display = 'flex';
    }

    function hideError() {
      document.getElementById('location-error').style.display = 'none';
    }

    // NEW: Search functionality for cities
    function searchCities(query) {
      const searchResults = document.getElementById('search-results');
      
      if (!query || query.length < 2) {
        searchResults.style.display = 'none';
        return;
      }
// ukryj nag≈Ç√≥wek (po wyborze z wyszukiwarki)
const hdr = document.getElementById('main-header') || document.querySelector('.hero-header');
if (hdr) hdr.classList.add('hidden');
      // Search through all cities in all voivodeships
      const allCities = [];
      Object.entries(WOJ_MIASTA).forEach(([voivodeship, data]) => {
        data.cities.forEach(city => {
          allCities.push({ city: city, voivodeship: voivodeship });
        });
      });

      // Filter cities that match the query (case-insensitive)
      const matches = allCities.filter(item => 
        item.city.toLowerCase().includes(query.toLowerCase())
      );

      if (matches.length === 0) {
        searchResults.innerHTML = `
          <div style="padding: 1rem; text-align: center; color: #666;">
            <i class="fas fa-search" style="margin-right: 0.5rem;"></i>
            Nie znaleziono miast pasujƒÖcych do "${query}"
          </div>
        `;
        searchResults.style.display = 'block';
        return;
      }

      // Limit results to first 10 matches
      const limitedMatches = matches.slice(0, 10);
      
      let resultsHTML = '';
      limitedMatches.forEach((match, index) => {
        resultsHTML += `
          <div class="search-result-item" 
               style="padding: 0.8rem 1rem; border-bottom: 1px solid #f0f0f0; cursor: pointer; transition: background-color 0.2s;"
               onmouseover="this.style.backgroundColor='#f8f9fa'"
               onmouseout="this.style.backgroundColor='white'"
               onclick
="selectCityFromSearch('${match.city}', '${match.voivodeship}')">
            <div style="font-weight: 600; color: #333; margin-bottom: 0.2rem;">
              <i class="fas fa-map-marker-alt" style="color: #1976d2; margin-right: 0.5rem; width: 12px;"></i>
              ${match.city}
            </div>
            <div style="font-size: 0.85rem; color: #666;">
              ${match.voivodeship}
            </div>
          </div>
        `;
      });
      if (matches.length > 10) {
        resultsHTML += `
          <div style="padding: 0.5rem 1rem; text-align: center; color: #888; font-size: 0.85rem; background: #f8f9fa;">
            <i class="fas fa-ellipsis-h" style="margin-right: 0.3rem;"></i>
            i ${matches.length - 10} wiƒôcej wynik√≥w...
          </div>
        `;
      }

      searchResults.innerHTML = resultsHTML;
      searchResults.style.display = 'block';
    }

 function selectCityFromSearch(cityName, voivodeshipName) {
  console.log(`üîç Wybrano z wyszukiwarki: ${cityName} (${voivodeshipName})`);
  
  // Hide search results
  document.getElementById('search-results').style.display = 'none';
  document.getElementById('city-search').value = '';
  
  // Set the selected voivodeship and city
  selectedVoivodeship = voivodeshipName;
  selectedCity = cityName;
  currentVoivodeship = voivodeshipName;
  currentCity = cityName;

  // NEW: wymu≈õ centrowanie mapy na wybrane miasto (ignoruj chwilowo lokalizacjƒô u≈ºytkownika)
  window._forceCenterToCity = true;
  
  // Update the UI to show the selected city
  document.getElementById('voivodeship-section').classList.add('hidden');
  document.getElementById('city-section').classList.add('hidden');
  document.getElementById('selected-section').classList.remove('hidden');
  document.getElementById('selected-title').textContent = `${cityName}, ${voivodeshipName}`;
  
  // Show filter and map cards
  // removed old filter-card line;
  document.getElementById('map-card').style.display = 'block';
  
  // Clear any previous data
  userLocation = null;
  elements = [];
  clearAllMarkers();
  
  // Show success message
  showToast(`Wybrano miasto: ${cityName}`, 'success');
  
  // Initialize map and load data
  try {
    if (!map) {
      initializeMap();
    } else {
      // Reset map view to Poland if map exists
      map.setView([52.0693, 19.4803], 6);
    }
    loadCityData();
  } catch (error) {
    console.error('B≈ÇƒÖd podczas inicjalizacji:', error);
    showToast('WystƒÖpi≈Ç b≈ÇƒÖd podczas ≈Çadowania miasta', 'error');
  }
  
  // Scroll to map
  setTimeout(() => {
    document.getElementById('map-card').scrollIntoView({ 
      behavior: 'smooth', 
      block: 'start' 
    });
  }, 300);
}


    // Hide search results when clicking outside
    document.addEventListener('click', function(e) {
      const searchSection = e.target.closest('.search-section');
      if (!searchSection) {
        document.getElementById('search-results').style.display = 'none';
      }
    });

    // NEW: Star rating system functions
    let selectedRating = 0;
    
    function selectRating(rating) {
      selectedRating = rating;
      updateStarDisplay(rating);
      
      const ratingTexts = {
        1: "‚≠ê Bardzo s≈Çabo",
        2: "‚≠ê‚≠ê S≈Çabo", 
        3: "‚≠ê‚≠ê‚≠ê W porzƒÖdku",
        4: "‚≠ê‚≠ê‚≠ê‚≠ê Dobrze",
        5: "‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê Bardzo dobrze"
      };
      
      document.getElementById('rating-text').textContent = ratingTexts[rating];
      document.getElementById('rating-error').style.display = 'none';
    }
    
    function hoverRating(rating) {
      updateStarDisplay(rating, true);
    }
    
    function resetRatingHover() {
      updateStarDisplay(selectedRating);
    }
    
    function updateStarDisplay(rating, isHover = false) {
      const stars = document.querySelectorAll('.star');
      stars.forEach((star, index) => {
        const starRating = index + 1;
        if (starRating <= rating) {
          star.style.color = isHover ? '#ffed4e' : '#ffd700';
        } else {
          star.style.color = '#ddd';
        }
      });
    }
    
    function getRatingStars(rating) {
      let stars = '';
      for (let i = 1; i <= 5; i++) {
        if (i <= rating) {
          stars += '<span style="color: #ffd700;">‚òÖ</span>';
        } else {
          stars += '<span style="color: #ddd;">‚òÖ</span>';
        }
      }
      return stars;
    }
    
    function getAverageRating(comments) {
      if (!comments || comments.length === 0) return 0;
      const ratingsWithValues = comments.filter(c => c.rating && c.rating > 0);
      if (ratingsWithValues.length === 0) return 0;
      
      const sum = ratingsWithValues.reduce((acc, comment) => acc + comment.rating, 0);
      return Math.round((sum / ratingsWithValues.length) * 10) / 10;
    }

    // Zamykanie modala po klikniƒôciu t≈Ça
    document.getElementById('comment-modal').addEventListener('click', function(e) {
      if (e.target === this) {
        closeCommentModal();
      }
    });

    // ================================
    // SYSTEM NAWIGACJI
    // ================================
    let currentDestination = null;
    let currentNavigationType = 'walking';
    let currentRoute = null;
    let routePolyline = null;

    // Otw√≥rz panel nawigacji
    function openNavigation(lat, lon, name) {
      currentDestination = { lat, lon, name };
      
      // Aktualizuj informacje o celu
      document.getElementById('nav-destination-name').textContent = name;
      document.getElementById('nav-destination-address').textContent = `${lat.toFixed(6)}, ${lon.toFixed(6)}`;
      
      // Poka≈º panel nawigacji
      document.getElementById('navigation-card').style.display = 'block';
      
      // Oblicz trasƒô
      calculateRoute();
    }

    // Zamknij panel nawigacji
    function closeNavigation() {
      document.getElementById('navigation-card').style.display = 'none';
      
      // Usu≈Ñ trasƒô z mapy
      if (routePolyline && map.hasLayer(routePolyline)) {
        map.removeLayer(routePolyline);
      }
      
      currentDestination = null;
      currentRoute = null;
      routePolyline = null;
    }

    // Ustaw typ nawigacji (pieszo/samochodem)
    function setNavigationType(type) {
      currentNavigationType = type;
      
      // Aktualizuj przyciski
      document.querySelectorAll('.nav-option-btn').forEach(btn => {
        btn.classList.remove('active');
      });
      document.querySelector(`[data-type="${type}"]`).classList.add('active');
      
      // Przelicz trasƒô
      if (currentDestination) {
        calculateRoute();
      }
    }

    // Oblicz trasƒô przy u≈ºyciu OSRM (Open Source Routing Machine)
    async function calculateRoute() {
      if (!userLocation || !currentDestination) {
        showToast('Brak lokalizacji u≈ºytkownika lub celu podr√≥≈ºy', 'error');
        return;
      }

      const profile = currentNavigationType === 'walking' ? 'foot' : 'car';
      const url = `https://router.project-osrm.org/route/v1/${profile}/${userLocation.longitude},${userLocation.latitude};${currentDestination.lon},${currentDestination.lat}?steps=true&geometries=geojson&overview=full`;

      try {
        showToast('Obliczanie trasy...', 'info');
        
        const response = await fetch(url);
        const data = await response.json();
        
        if (data.code === 'Ok' && data.routes && data.routes.length > 0) {
          currentRoute = data.routes[0];
          displayRoute();
          displayDirections();
          showToast('Trasa zosta≈Ça obliczona!', 'success');
        } else {
          throw new Error('Nie mo≈ºna obliczyƒá trasy');
        }
      } catch (error) {
        console.error('B≈ÇƒÖd obliczania trasy:', error);
        showToast('Nie mo≈ºna obliczyƒá trasy. Pokazujƒô liniƒô prostƒÖ.', 'warning');
        
        // Fallback - poka≈º prostƒÖ liniƒô
        showStraightLine();
      }
    }

    // Wy≈õwietl trasƒô na mapie
    function displayRoute() {
      if (!currentRoute || !map) return;
      
      // Usu≈Ñ poprzedniƒÖ trasƒô
      if (routePolyline && map.hasLayer(routePolyline)) {
        map.removeLayer(routePolyline);
      }
      
      // Utw√≥rz nowƒÖ trasƒô
      const coordinates = currentRoute.geometry.coordinates.map(coord => [coord[1], coord[0]]);
      routePolyline = L.polyline(coordinates, {
        color: '#1976d2',
        weight: 4,
        opacity: 0.8
      }).addTo(map);
      
      // Dostosuj widok mapy do trasy
      const bounds = routePolyline.getBounds();
      map.fitBounds(bounds, { padding: [20, 20] });
      
      // Poka≈º podsumowanie trasy
      const distance = (currentRoute.distance / 1000).toFixed(1) + ' km';
      const duration = Math.round(currentRoute.duration / 60) + ' min';
      
      document.getElementById('route-distance').textContent = distance;
      document.getElementById('route-duration').textContent = duration;
      document.getElementById('route-summary').style.display = 'block';
     showMapTopDistance(distance + ' ‚Ä¢ ' + duration);
    }

    // Wy≈õwietl instrukcje krok po kroku
    function displayDirections() {
      if (!currentRoute || !currentRoute.legs) return;
      
      const directionsContainer = document.getElementById('navigation-directions');
      directionsContainer.innerHTML = '';
      
      let stepNumber = 1;
      currentRoute.legs.forEach(leg => {
        leg.steps.forEach(step => {
          const stepDiv = document.createElement('div');
          stepDiv.className = 'direction-step';
          
          const instruction = step.maneuver.instruction || getInstructionFromType(step.maneuver.type);
          const distance = step.distance > 1000 
            ? (step.distance / 1000).toFixed(1) + ' km' 
            : Math.round(step.distance) + ' m';
          
          stepDiv.innerHTML = `
            <div class="step-icon">${stepNumber}</div>
            <div class="step-content">
              <div class="step-instruction">${instruction}</div>
              <div class="step-distance">${distance}</div>
            </div>
          `;
          
          directionsContainer.appendChild(stepDiv);
          stepNumber++;
        });
      });
    }
// ====== helpers: show/hide top distance box ======
function showMapTopDistance(text, autoHideMs = 8000) {
  const el = document.getElementById('map-top-distance');
  if (!el) return;
  document.getElementById('map-top-distance-value').textContent = text;
  el.style.display = 'block';
  // opcjonalne auto-hide
  if (el._hideTimeout) clearTimeout(el._hideTimeout);
  if (autoHideMs > 0) {
    el._hideTimeout = setTimeout(() => { el.style.display = 'none'; }, autoHideMs);
  }
}

function hideMapTopDistance() {
  const el = document.getElementById('map-top-distance');
  if (!el) return;
  if (el._hideTimeout) { clearTimeout(el._hideTimeout); el._hideTimeout = null; }
  el.style.display = 'none';
}

// zamkniƒôcie przez przycisk X
document.addEventListener('click', function (e) {
  if (e.target && e.target.id === 'map-top-distance-close') hideMapTopDistance();
});
    // Poka≈º prostƒÖ liniƒô jako fallback
    function showStraightLine() {
      if (!userLocation || !currentDestination || !map) return;
      
      // Usu≈Ñ poprzedniƒÖ trasƒô
      if (routePolyline && map.hasLayer(routePolyline)) {
        map.removeLayer(routePolyline);
      }
      
      // Utw√≥rz prostƒÖ liniƒô
      const coordinates = [
        [userLocation.latitude, userLocation.longitude],
        [currentDestination.lat, currentDestination.lon]
      ];
      
      routePolyline = L.polyline(coordinates, {
        color: '#ff5722',
        weight: 3,
        opacity: 0.7,
        dashArray: '5, 10'
      }).addTo(map);
      
      // Oblicz odleg≈Ço≈õƒá w linii prostej
      const distance = map.distance(
        [userLocation.latitude, userLocation.longitude],
        [currentDestination.lat, currentDestination.lon]
      );
      
      const distanceKm = (distance / 1000).toFixed(1) + ' km';
      const estimatedTime = currentNavigationType === 'walking' 
        ? Math.round(distance / 1000 * 12) + ' min' // ~5 km/h
        : Math.round(distance / 1000 * 2) + ' min';  // ~30 km/h
      
      document.getElementById('route-distance').textContent = distanceKm + ' (linia prosta)';
      document.getElementById('route-duration').textContent = 'ok. ' + estimatedTime;
      document.getElementById('route-summary').style.display = 'block';
      
      // Dostosuj widok mapy
      const bounds = routePolyline.getBounds();
      map.fitBounds(bounds, { padding: [20, 20] });
      
      // Poka≈º proste instrukcje
      const directionsContainer = document.getElementById('navigation-directions');
      directionsContainer.innerHTML = `
        <div class="direction-step">
          <div class="step-icon">1</div>
          <div class="step-content">
            <div class="step-instruction">Id≈∫ prosto w kierunku ${currentDestination.name}</div>
            <div class="step-distance">${distanceKm} w linii prostej</div>
          </div>
        </div>
      `;
    }

    // Rozpocznij nawigacjƒô (otw√≥rz w domy≈õlnej aplikacji)
    function startNavigation() {
      if (!currentDestination) return;
      
      const url = `https://www.google.com/maps/dir//${currentDestination.lat},${currentDestination.lon}`;
      window.open(url, '_blank');
      
      showToast('Otwieranie nawigacji w Google Maps...', 'success');
    }

    // Pomocnicza funkcja do konwersji typ√≥w manewr√≥w na instrukcje
    function getInstructionFromType(type) {
      const instructions = {
        'turn-straight': 'Jed≈∫ prosto',
        'turn-right': 'Skrƒôƒá w prawo',
        'turn-left': 'Skrƒôƒá w lewo',
        'turn-sharp-right': 'Skrƒôƒá ostro w prawo',
        'turn-sharp-left': 'Skrƒôƒá ostro w lewo',
        'turn-slight-right': 'Skrƒôƒá lekko w prawo',
        'turn-slight-left': 'Skrƒôƒá lekko w lewo',
        'merge': 'W≈ÇƒÖcz siƒô do ruchu',
        'ramp': 'Wjed≈∫ na zjazd',
        'on-ramp': 'Wjed≈∫ na autostradƒô',
        'off-ramp': 'Zjed≈∫ z autostrady',
        'fork': 'Trzymaj siƒô rozwidlenia',
        'continue': 'Kontynuuj prosto',
        'arrive': 'Dotar≈Çe≈õ do celu'
      };
      
      return instructions[type] || 'Kontynuuj podƒÖ≈ºanie trasƒÖ';
    }

  </script>
<script>
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("./service-worker.js")
    .then(() => console.log("‚úÖ Service Worker zarejestrowany!"))
    .catch(err => console.log("‚ùå B≈ÇƒÖd Service Workera:", err));
}
</script>
<script>
let deferredPrompt;

// Je≈õli PWA nie zosta≈Ça jeszcze dodana
window.addEventListener('beforeinstallprompt', (e) => {
  e.preventDefault(); // blokujemy domy≈õlny prompt
  deferredPrompt = e;
  const btn = document.getElementById('installBtn');
  btn.style.display = 'inline-block'; // pokazujemy przycisk
});

// Obs≈Çuga klikniƒôcia przycisku
document.getElementById('installBtn').addEventListener('click', async () => {
  if (deferredPrompt) {
    deferredPrompt.prompt(); // pokazujemy prompt instalacji
    const { outcome } = await deferredPrompt.userChoice;
    deferredPrompt = null;

    if (outcome === 'accepted') {
      console.log('U≈ºytkownik zainstalowa≈Ç aplikacjƒô');
      document.getElementById('installBtn').style.display = 'none'; // ukrywamy przycisk po instalacji
    } else {
      console.log('U≈ºytkownik anulowa≈Ç instalacjƒô');
    }
  }
});
</script>
<script>
function hideGeoButton() {
  const geoBtn = document.getElementById('geo-btn');
  if (geoBtn) {
    geoBtn.style.setProperty("display", "none", "important");
  }
}

function showGeoButton() {
  const geoBtn = document.getElementById('geo-btn');
  if (geoBtn) {
    geoBtn.style.setProperty("display", "block", "important");
  }
}
</script>
<script>
function openFilterPanel() {
  const filterContent = document.getElementById("filter-content");
  const filterArrow = document.getElementById("filter-arrow");

  if (filterContent && filterContent.style.display === "none") {
    filterContent.style.display = "block";
    if (filterArrow) {
      filterArrow.classList.remove("fa-chevron-down");
      filterArrow.classList.add("fa-chevron-up");
    }
  }

  const filterCard = document.getElementById("filter-card");
  if (filterCard) {
    filterCard.scrollIntoView({ behavior: "smooth" });
  }
}
</script>
<script src="https://unpkg.com/opening_hours@3.6.0/opening_hours.js"></script>
<script>
  function goHome() {
    window.location.href = window.location.pathname;
  }
</script>
<script>
  // prze≈Çadowanie aplikacji
  function goHome() {
    window.location.href = window.location.pathname;
  }

  // pokazywanie/ukrywanie przycisku
  function showHomeButton() {
    document.getElementById("home-btn").style.display = "inline-flex";
  }
  function hideHomeButton() {
    document.getElementById("home-btn").style.display = "none";
  }
</script>
<script>
// ---------- ATRAKCJE (Attractions) - Overpass + UI ----------
const ATTRACTION_CATEGORIES = {
  zoo:        { label: 'Zoo', queryTags: [['tourism','zoo']], emoji: 'ü¶Å' },
  waterpark:  { label: 'Akwaparki', queryTags: [['leisure','water_park']], emoji: 'üåä' },
  pool:       { label: 'Baseny', queryTags: [['leisure','swimming_pool'], ['amenity','swimming_pool']], emoji: 'üèä' },
  museum:     { label: 'Muzea', queryTags: [['tourism','museum']], emoji: 'üèõ' },
  art_gallery:{ label: 'Galerie sztuki', queryTags: [['tourism','art_gallery']], emoji: 'üé®' },
  amusement:  { label: 'Parki rozrywki', queryTags: [['tourism','theme_park'], ['leisure','amusement_arcade']], emoji: 'üé¢' },
  theatre:    { label: 'Teatry', queryTags: [['amenity','theatre']], emoji: 'üé≠' },
  cinema:     { label: 'Kina', queryTags: [['amenity','cinema']], emoji: 'üé¨' },
  planetarium:{ label: 'Planetaria', queryTags: [['amenity','planetarium']], emoji: 'üåå' },
  skansen:    { label: 'Skanseny', queryTags: [['tourism','open_air_museum']], emoji: 'üè°' },
  stadium:    { label: 'Stadiony', queryTags: [['leisure','stadium']], emoji: 'üèü' },
  escape:     { label: 'Escape roomy', queryTags: [['leisure','escape_game'], ['leisure','escape_room']], emoji: 'üß©' },
  rope_park:  { label: 'Parki linowe', queryTags: [['leisure','rope_course']], emoji: 'üßó' },


  golf:       { label: 'Pola golfowe', queryTags: [['leisure','golf_course']], emoji: '‚õ≥' },
  bowling:    { label: 'Krƒôgielnie', queryTags: [['leisure','bowling_alley'], ['sport','bowling']], emoji: 'üé≥' },

beach:      { label: 'Pla≈ºe', queryTags: [['natural','beach'], ['leisure','beach']], emoji: 'üèñÔ∏è' },
castle:     { label: 'Zamki', queryTags: [['historic','castle']], emoji: 'üè∞' },
  palace:     { label: 'Pa≈Çace', queryTags: [['historic','palace']], emoji: 'üèØ' },
  market:     { label: 'Rynek', queryTags: [['place','square'], ['highway','pedestrian']], emoji: 'üè§' },

  monument:   { label: 'Pomniki', queryTags: [['historic','monument'], ['memorial','yes']], emoji: 'üóø' },
  trampoline: { label: 'Parki trampolin', queryTags: [['leisure','trampoline_park']], emoji: 'ü§∏' },
  paintball:  { label: 'Paintball', queryTags: [['sport','paintball']], emoji: 'üéØ' },
  climbing:   { label: '≈öcianki wspinaczkowe', queryTags: [['sport','climbing'], ['sport','climbing_wall']], emoji: 'üßó' }
};


let attractionsCache = {};   // category -> array of OSM elements
let attractionMarkers = {};  // osm_id -> L.marker (not always added to map)
let attractionsFetchedForCity = null;

/**
 * Otwiera modal z listƒÖ atrakcji. Je≈õli jeszcze nie pobrano dla bie≈ºƒÖcego miasta - pobieramy.
 */
 // Funkcja do liczenia odleg≈Ço≈õci miƒôdzy dwoma punktami (Haversine)
function haversineDistanceMeters(lat1, lon1, lat2, lon2) {
  const R = 6371000; // promie≈Ñ Ziemi w metrach
  const toRad = deg => deg * Math.PI / 180;

  const dLat = toRad(lat2 - lat1);
  const dLon = toRad(lon2 - lon1);

  const a =
    Math.sin(dLat / 2) * Math.sin(dLat / 2) +
    Math.cos(toRad(lat1)) * Math.cos(toRad(lat2)) *
    Math.sin(dLon / 2) * Math.sin(dLon / 2);

  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));

  return R * c; // odleg≈Ço≈õƒá w metrach
}
async function openAttractionsPanel() {
  // Obs≈Çuga bez lokalizacji u≈ºytkownika:
  // 1) currentCity je≈õli jest
  // 2) je≈õli brak ‚Üí pole #city-search
  // 3) je≈õli dalej brak ‚Üí reverse geocode na ≈õrodku mapy
  // 4) je≈õli dalej brak ‚Üí komunikat

  let cityToUse = typeof currentCity !== 'undefined' ? currentCity : null;

  // spr√≥buj pobraƒá z pola wyszukiwania
  const searchInput = document.getElementById('city-search');
  if ((!cityToUse || cityToUse === null) && searchInput && searchInput.value.trim()) {
    cityToUse = searchInput.value.trim();
  }

  // spr√≥buj reverse-geocode na mapie
  if ((!cityToUse || cityToUse === null) && typeof map !== 'undefined' && map && typeof map.getCenter === 'function') {
    try {
      const center = map.getCenter();
      const resp = await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${center.lat}&lon=${center.lng}&zoom=10&addressdetails=1`);
      if (resp.ok) {
        const d = await resp.json();
        const addr = d.address || {};
        cityToUse = addr.city || addr.town || addr.village || addr.county || null;
      }
    } catch (e) {
      console.warn("Reverse geocode failed:", e);
    }
  }

  // je≈õli nadal brak miasta ‚Üí komunikat i koniec
  if (!cityToUse) {
    if (typeof showToast === 'function') {
      showToast('Wybierz miasto (w polu wyszukiwania) albo ustaw mapƒô, aby zobaczyƒá atrakcje.', 'error');
    } else {
      alert('Wybierz miasto (w polu wyszukiwania) albo ustaw mapƒô, aby zobaczyƒá atrakcje.');
    }
    return;
  }

  // zapisz poprzednie miasto
  const prevCity = typeof currentCity !== 'undefined' ? currentCity : null;
  currentCity = cityToUse;

  // stw√≥rz modal
  const modal = document.createElement('div');
  modal.className = 'attractions-modal';
  modal.innerHTML = `
    <div class="modal-card" role="dialog" aria-modal="true">
      <button class="close-btn" aria-label="Zamknij" onclick="document.body.removeChild(this.closest('.attractions-modal'))">√ó</button>
      <div style="padding:1rem 1.25rem; border-bottom:1px solid #eee;">
        <h3 style="margin:0; font-size:1.05rem;">Atrakcje w <strong>${escapeHtml(cityToUse)}</strong></h3>
        <div style="font-size:0.9rem; color:#666; margin-top:0.35rem;">Wybierz kategoriƒô lub kliknij atrakcjƒô aby zobaczyƒá na mapie.</div>
      </div>
      <div id="attractions-content" class="attractions-list-section">
        <div style="padding:1rem; text-align:center; color:#666;">≈Åadowanie atrakcji‚Ä¶</div>
      </div>
    </div>
  `;
  document.body.appendChild(modal);

  // klik poza kartƒô zamyka modal
  modal.addEventListener('click', e => {
    if (e.target === modal) document.body.removeChild(modal);
  });

  try {
    if (attractionsFetchedForCity !== cityToUse) {
      const dataByCat = await fetchAttractionsForCity();
      buildAttractionsList(dataByCat);
      attractionsFetchedForCity = cityToUse;
      attractionsCache = Object.assign({}, attractionsCache, dataByCat);
    } else {
      buildAttractionsList(attractionsCache);
    }
  } catch (err) {
    const cont = document.getElementById('attractions-content');
    if (cont) cont.innerHTML = `<div style="padding:1rem; color:#900;">B≈ÇƒÖd pobierania: ${escapeHtml(err.message || String(err))}</div>`;
    console.error("Attractions error:", err);
  } finally {
    // przywr√≥ƒá poprzednie miasto je≈õli by≈Ço
    currentCity = prevCity || cityToUse;
  }
}

/**
 * Pobiera elementy z Overpass dla wszystkich kategorii jednocze≈õnie (w obrƒôbie promienia).
 * Zwraca obiekt category -> [elements].
 */
async function fetchAttractionsForCity() {
  showLoading();
  let cityCoords = CITY_COORDINATES[currentCity];

  if (!cityCoords) {
    // pobierz z Nominatim (kopiuj logikƒô z loadCityData)
    const nomUrl = `https://nominatim.openstreetmap.org/search?q=${encodeURIComponent(currentCity)},Poland&format=json&limit=1`;
    const r = await fetch(nomUrl, { headers: {'User-Agent':'JAMIASTO-Attractions-Fetcher'} });
    if (!r.ok) throw new Error('Nie uda≈Ço siƒô pobraƒá wsp√≥≈Çrzƒôdnych miasta (Nominatim).');
    const d = await r.json();
    if (!d || d.length === 0) throw new Error('Nominatim nie zwr√≥ci≈Ç wsp√≥≈Çrzƒôdnych dla miasta.');
    cityCoords = { lat: parseFloat(d[0].lat), lng: parseFloat(d[0].lon) };
  }

  const radius = 12000; // w metrach - mo≈ºna zmniejszyƒá/powiƒôkszyƒá
  // zbuduj zapytanie Overpass agregujƒÖce wszystkie tagi
  const parts = [];
  Object.entries(ATTRACTION_CATEGORIES).forEach(([catKey, cat]) => {
    if (!cat || !Array.isArray(cat.queryTags)) return;
    cat.queryTags.forEach(([k,v]) => {
      // For swimming_pool try to exclude private/customers/residents at query time
      if ((k === 'leisure' || k === 'amenity') && v === 'swimming_pool') {
        const accessNeg = '["access"!~"^(private|customers|residents)$"]';
        parts.push(`node["${k}"="${v}"]${accessNeg}(around:${radius},${cityCoords.lat},${cityCoords.lng});`);
        parts.push(`way["${k}"="${v}"]${accessNeg}(around:${radius},${cityCoords.lat},${cityCoords.lng});`);
        parts.push(`relation["${k}"="${v}"]${accessNeg}(around:${radius},${cityCoords.lat},${cityCoords.lng});`);
      } else {
        parts.push(`node["${k}"="${v}"](around:${radius},${cityCoords.lat},${cityCoords.lng});`);
        parts.push(`way["${k}"="${v}"](around:${radius},${cityCoords.lat},${cityCoords.lng});`);
        parts.push(`relation["${k}"="${v}"](around:${radius},${cityCoords.lat},${cityCoords.lng});`);
      }
    });
  });

  const overpassQuery = `[out:json][timeout:60];(${parts.join('')});out center meta;`;
  const overpassUrl = 'https://overpass-api.de/api/interpreter';

  const resp = await fetch(overpassUrl, {
    method: 'POST',
    headers: {'Content-Type': 'application/x-www-form-urlencoded'},
    body: `data=${encodeURIComponent(overpassQuery)}`
  });
  if (!resp.ok) {
    hideLoading();
    throw new Error('B≈ÇƒÖd Overpass API: ' + resp.status);
  }
  const json = await resp.json();
  hideLoading();

  // przygotuj strukturƒô wynikowƒÖ
  const byCat = {};
  Object.keys(ATTRACTION_CATEGORIES).forEach(k => byCat[k] = []);
  (json.elements || []).forEach(el => {
    const cat = detectAttractionCategory(el);
    if (cat) byCat[cat].push(el);
  });


// --- IMPROVED DEDUP & FILTER for Rynki and Baseny ---
function deduplicateByIdOrName(arr) {
  const map = new Map();
  for (const el of arr) {
    // prefer a stable key: if name exists use name+type, else use osm id
    const name = (el.tags && el.tags.name && String(el.tags.name).trim()) || null;
    const typeHint = el.type || '';
    const key = name ? (name.toString().toLowerCase() + '::' + typeHint) : (el.type + '::' + el.id);
    if (!map.has(key)) {
      map.set(key, el);
    } else {
      // keep the one with center coordinates (prefer way/relation with center) or node with lat/lon
      const existing = map.get(key);
      const existingHasCenter = !!(existing.center || (existing.lat && existing.lon));
      const currentHasCenter = !!(el.center || (el.lat && el.lon));
      if (currentHasCenter && !existingHasCenter) map.set(key, el);
    }
  }
  return Array.from(map.values());
}

function filterMarketsStrict(byCat, cityCoords) {
  if (!Array.isArray(byCat.market)) return;
  // keep only items that have a name containing word 'rynek' (polish, word boundary)
  const marketsNamed = byCat.market.filter(el => {
    const name = (el.tags && el.tags.name) ? String(el.tags.name).toLowerCase() : '';
    if (!name) return false;
    return /\brynek\b/.test(name);
  });

  if (marketsNamed.length === 0) {
    byCat.market = [];
    return;
  }

  // dedupe by name/type
  const unique = deduplicateByIdOrName(marketsNamed);

  // sort by distance to city center and keep one
  unique.sort((a,b) => {
    const aLat = a.lat || (a.center && a.center.lat) || 0;
    const aLon = a.lon || (a.center && a.center.lon) || 0;
    const bLat = b.lat || (b.center && b.center.lat) || 0;
    const bLon = b.lon || (b.center && b.center.lon) || 0;
    const da = haversineDistanceMeters(cityCoords.lat, cityCoords.lng, aLat, aLon);
    const db = haversineDistanceMeters(cityCoords.lat, cityCoords.lng, bLat, bLon);
    return da - db;
  });

  byCat.market = [ unique[0] ];
}


function filterPoolsStrict(byCat) {
  if (!Array.isArray(byCat.pool)) return;
  // Tylko dok≈Çadne dopasowania nazw lub dobrze opisane obiekty z tagiem swimming_pool
  const allowedNameRegex = /\b(?:p≈Çywalnia(?: odkryta| zakryta)?|basen(?: odkryty| zakryty)?)\b/i;

  function looksPrivate(tags) {
    if (!tags) return false;
    const access = String(tags.access || tags.private || '').toLowerCase();
    if (access.includes('private') || access.includes('customers') || access.includes('residents') || access.includes('prywat')) return true;
    const note = String(tags.note || tags.description || tags.operator || '').toLowerCase();
    if (note.includes('prywat')) return true;
    if (String(tags.usage || '').toLowerCase().includes('private')) return true;
    return false;
  }

  function hasPublicMetadata(tags) {
    if (!tags) return false;
    return Boolean(tags.operator || tags.website || tags['opening_hours'] || tags['addr:street'] || tags.phone || tags['contact:phone'] || tags.email);
  }

  const filtered = byCat.pool.filter(el => {
    const t = el.tags || {};
    const name = (t.name || '').trim();
    const nameMatches = !!name && allowedNameRegex.test(name);
    const isPoolTag = t.leisure === 'swimming_pool' || t.amenity === 'swimming_pool';
    const clearlyWaterBody = t.natural === 'water' || t.landuse === 'reservoir' || Boolean(t.waterway);

    if (clearlyWaterBody) return false;
    if (looksPrivate(t)) return false;
    if (nameMatches) return true;
    // Je≈õli brak nazwy, akceptuj tylko gdy jest tag swimming_pool i jakie≈õ publiczne metadane (operator/website/addr/etc.)
    if (isPoolTag && hasPublicMetadata(t)) return true;
    return false;
  });

  byCat.pool = deduplicateByIdOrName(filtered);
}


  // cache
  filterMarketsStrict(byCat, cityCoords);
  filterPoolsStrict(byCat);
  attractionsCache = byCat;
  // nie tw√≥rz marker√≥w od razu ‚Äî tworzymy je dopiero po klikniƒôciu (zgodnie z wymaganiem)
  attractionMarkers = {}; // reset
  return byCat;
}

/** 
 * Rozpoznaj kategoriƒô pojedynczego elementu OSM
 */
function detectAttractionCategory(el) {
  const tags = el.tags || {};

  // Najpierw obs≈Çu≈º kilka wyjƒÖtk√≥w ze starego kodu (≈ºeby nic nie uciek≈Ço)
  if (tags.leisure === 'water_park') return 'waterpark';
  if (tags.leisure === 'swimming_pool' || tags.amenity === 'swimming_pool') return 'pool';

  // Teraz przeleƒá po wszystkich kategoriach zdefiniowanych w ATTRACTION_CATEGORIES
  for (const [catKey, meta] of Object.entries(ATTRACTION_CATEGORIES)) {
    const qTags = meta.queryTags || [];
    for (const q of qTags) {
      const [k, v] = q || [];
      if (!k) continue;
      const val = tags[k];
      if (!val) continue;

      // 1) idealne dopasowanie
      if (String(val) === String(v)) return catKey;

      // 2) obs≈Çuga warto≈õci wielokrotnych (np. "restaurant;bar")
      const parts = String(val).split(/[;,|]/).map(s => s.trim());
      if (parts.includes(String(v))) return catKey;

      // 3) czƒô≈õciowe dopasowanie (np. "museum:history")
      if (String(val).includes(String(v))) return catKey;
    }
  }

  return null;
}

/**
 * Buduje HTML listy atrakcji w modalu (z CTA do wy≈õwietlenia na mapie).
 * Lista pokazuje nazwy i przycisk ‚ÄûPoka≈º‚Äù.
 */
// --- REPLACEMENT: buildAttractionsList (bardziej odporne na puste dane) ---

function buildAttractionsList(dataByCat) {
  const content = document.getElementById('attractions-content') || document.querySelector('.attractions-list-section') || null;
  if (!content) return;
  // Je≈õli w pliku zawarto≈õƒá to kontener, wyczy≈õƒá jƒÖ
  content.innerHTML = '';

  const categories = Object.entries(ATTRACTION_CATEGORIES || {});
  let anyShown = false;

  categories.forEach(([key, meta]) => {
    const items = (dataByCat && dataByCat[key]) ? dataByCat[key] : [];
    // Je≈õli brak element√≥w - NIE TWORZƒò sekcji (ca≈Çkowicie ukrywam kategoriƒô)
    if (!items || items.length === 0) return;

    anyShown = true;

    // Tworzƒô sekcjƒô w taki spos√≥b, ≈ºeby u≈ºyƒá tych samych klas/struktury co oryginalny design
    const section = document.createElement('div');
    section.className = 'attractions-list-section';

    const titleWrapper = document.createElement('div');
    titleWrapper.className = 'attractions-section-title';

    const left = document.createElement('div');
    left.style.display = 'flex';
    left.style.alignItems = 'center';
    left.style.gap = '0.6rem';

    const emojiSpan = document.createElement('span');
    emojiSpan.className = 'attraction-emoji';
    emojiSpan.textContent = meta.emoji || '';

    const labelStrong = document.createElement('strong');
    labelStrong.textContent = meta.label || key;

    const countSpan = document.createElement('span');
    countSpan.className = 'attraction-count';
    countSpan.style.marginLeft = '0.4rem';
    countSpan.style.color = '#666';
    countSpan.style.fontSize = '0.95rem';
    countSpan.textContent = `(${items.length})`;

    left.appendChild(emojiSpan);
    left.appendChild(labelStrong);
    left.appendChild(countSpan);

    const right = document.createElement('div');
    // zachowaj przycisk "Poka≈º" je≈õli gdzie≈õ w UI zale≈ºy od niego
    const btn = document.createElement('button');
    btn.className = 'modern-btn btn-primary';
    btn.style.padding = '0.4rem 0.8rem';
    btn.style.fontSize = '0.95rem';
    btn.textContent = 'Poka≈º';
    btn.addEventListener('click', (e) => {
      e.preventDefault();
      toggleAttractionList(key, btn);
      if ((attractionsCache[key] || []).length) toggleAttractionCategory(key);
    });

    right.appendChild(btn);

    titleWrapper.appendChild(left);
    titleWrapper.appendChild(right);

    section.appendChild(titleWrapper);

    const ul = document.createElement('ul');
    ul.className = 'attraction-list';
    ul.id = 'list-' + key;
    ul.style.display = 'none';

    items.forEach(el => {
      const li = document.createElement('li');
      li.className = 'attraction-item';
      const name = (el.tags && (el.tags.name || el.tags.operator)) || 'Bez nazwy';
      const hint = el.tags && el.tags['addr:street'] ? ` ‚Äî ${el.tags['addr:street']}` : '';
      li.innerHTML = `<span style="font-weight:600;">${escapeHtml(name)}</span> <small style="color:#666;">${escapeHtml(hint)}</small>`;
      li.addEventListener('click', () => showAttractionFromList(key, el.id));
      ul.appendChild(li);
    });

    section.appendChild(ul);
    // Je≈õli content to konkretny kontener, dodaj tam sekcjƒô. W przeciwnym wypadku spr√≥buj znale≈∫ƒá element o id 'attractions-content'
    if (content.classList && content.classList.contains('attractions-list-section')) {
      // je≈õli content jest pojedynczƒÖ sekcjƒÖ, dodaj wewnƒÖtrz (przyjmij, ≈ºe istnieje wrapper o id 'attractions-content-wrapper')
      content.appendChild(section);
    } else {
      content.appendChild(section);
    }
  });

  if (!anyShown) {
    content.innerHTML = '<div class="attraction-empty">Brak atrakcji w tej okolicy.</div>';
  }
}


// --- LEKKA POPRAWKA toggleAttractionList (bezpieczne pokazywanie/ukrywanie) ---
function toggleAttractionList(category, btn) {
  const ul = document.getElementById('list-' + category);
  if (!ul) return;
  const isHidden = (ul.style.display === 'none') || (getComputedStyle(ul).display === 'none');
  if (isHidden) {
    ul.style.display = 'block';
    if (btn) btn.textContent = 'Ukryj';
    // tylko pokazuj marker gdy sƒÖ punkty
    if ((attractionsCache[category] || []).length) toggleAttractionCategory(category);
  } else {
    ul.style.display = 'none';
    if (btn) btn.textContent = ((attractionsCache[category] || []).length ? 'Poka≈º' : 'Brak punkt√≥w');
    // ukryj markery je≈ºeli by≈Çy dodane
    if ((attractionsCache[category] || []).length) toggleAttractionCategory(category);
  }
}
function showAttractionFromList(category, osmId) {
  const arr = attractionsCache[category] || [];
  const el = arr.find(i => i.id === osmId);
  if (!el) {
    showToast('Nie znaleziono tej atrakcji.', 'error');
    return;
  }

  // zamknij modal
  const modal = document.querySelector('.attractions-modal');
  if (modal) modal.remove();

  // je≈õli chcesz, poka≈º tylko tƒô atrakcjƒô na mapie:
  // clearAttractionMarkers(); // <- globalna funkcja (zdefiniowana gdzie indziej) usuwa warstwy z mapy (nie resetuje obiektu attractionMarkers).
  // UWAGA: w pliku masz globalnƒÖ funkcjƒô clearAttractionMarkers() ‚Äî nie resetowaƒá attractionMarkers = {}. Ó®Å10Ó®Ç

  if (!attractionMarkers[osmId]) {
    attractionMarkers[osmId] = createEmojiMarker(el, ATTRACTION_CATEGORIES[category]?.emoji || 'üìç');
  }

  const marker = attractionMarkers[osmId];
  if (!map.hasLayer(marker)) marker.addTo(map);

  const lat = el.lat || (el.center && el.center.lat);
  const lon = el.lon || (el.center && el.center.lon);
  if (lat && lon) {
    map.setView([lat, lon], 15);
    marker.bindPopup(generateAttractionPopup(el)).openPopup();
  }

function toggleAttractionCategory(category) {
  const list = attractionsCache[category] || [];
  if (list.length === 0) {
    showToast('Brak punkt√≥w dla tej kategorii w pobli≈ºu.', 'warning');
    return;
  }

  // je≈õli nie ma ≈ºadnych marker√≥w dodanych -> dodaj wszystkie
  const addedAny = list.some(el => attractionMarkers[el.id] && map.hasLayer(attractionMarkers[el.id]));
  if (addedAny) {
    // usu≈Ñ wszystkie mapowane markery tej kategorii
    list.forEach(el => {
      const m = attractionMarkers[el.id];
      if (m && map.hasLayer(m)) map.removeLayer(m);
    });
  } else {
    // dodaj wszystkie
    const bounds = [];
    list.forEach(el => {
      if (!attractionMarkers[el.id]) {
        attractionMarkers[el.id] = createEmojiMarker(el, ATTRACTION_CATEGORIES[category].emoji);
      }
      attractionMarkers[el.id].addTo(map);
      const lat = el.lat || (el.center && el.center.lat);
      const lon = el.lon || (el.center && el.center.lon);
      if (lat && lon) bounds.push([lat, lon]);
    });
    // dopasuj widok
    if (bounds.length) {
      try {
        map.fitBounds(bounds, { padding: [30,30] });
      } catch(e) { /* ignore */ }
    }
  }
}

/** Tworzy L.marker z ikonƒÖ emoji */
/** Tworzy L.marker z ikonƒÖ emoji (poprawiona wersja ‚Äî NIE czy≈õci innych marker√≥w) */
function createEmojiMarker(el, emoji) {
  const lat = el.lat || (el.center && el.center.lat);
  const lon = el.lon || (el.center && el.center.lon);
  if (!lat || !lon) return null;

  const html = `<div style="font-size:28px; line-height:1;">${emoji}</div>`;
  const icon = L.divIcon({
    className: 'attraction-emoji-icon',
    html: html,
    iconSize: [36,36],
    iconAnchor: [18,36]
  });

  const marker = L.marker([lat, lon], { icon: icon });

  marker.on('click', function () {
    if (!map.hasLayer(marker)) marker.addTo(map);
    let popupHtml;
    try {
      popupHtml = generateAttractionPopup(el);
    } catch (err) {
      console.error('generateAttractionPopup error:', err);
      popupHtml = `<div style="color:#b00020">B≈ÇƒÖd ≈Çadowania popupu</div>`;
    }
    marker.bindPopup(popupHtml, { maxWidth: 360, className: 'attraction-popup' });
    map.setView([lat, lon], 15, { animate: true });
    map.once('moveend', () => {
      try { marker.openPopup(); } catch (e) { console.error('openPopup error', e); }
    });
  });

  return marker;
}

  return marker;
}
function generateAttractionPopup(el) {
  // ‚Äî uzupe≈Çnij zmienne tak jak w createMarker z Index(3)
  const lat = el.lat || (el.center && el.center.lat);
  const lon = el.lon || (el.center && el.center.lon);
  const color = getColor(el);
  const description = getDescription(el);
  const name = el.tags?.name || description;
  const addr = [
    el.tags?.['addr:street'],
    el.tags?.['addr:housenumber'],
    el.tags?.['addr:city']
  ].filter(Boolean).join(' ') || 'Brak dok≈Çadnego adresu';

  const pointId = `${el.type || 'node'}-${el.id}`;
  const comments = getCommentsForPoint(pointId);
  const commentsCount = comments.length;
  const averageRating = getAverageRating(comments);

  const amenity = el.tags?.amenity;
  const website = el.tags?.website || el.tags?.url || null;
  const phone = el.tags?.phone || el.tags?.contact_phone || null;
  const displayName = el.tags?.name || getDescription(el);

  // openingInfo ‚Äî je≈õli masz parsing godzin w Index(3) to skopiuj tƒô czƒô≈õƒá te≈º; tutaj dla bezpiecze≈Ñstwa:
  let openingInfo = '';
  if (el.tags && el.tags.opening_hours) {
    try {
      // je≈õli masz w projekcie opening_hours.js u≈ºyj jej ‚Äî je≈õli nie, poka≈º surowy tekst
      if (typeof opening_hours !== 'undefined') {
        const oh = new opening_hours(el.tags.opening_hours);
        const isOpen = oh.getState();
        const todayRange = oh.getOpeningHoursAsString();
        openingInfo = `<div style="margin:0 0 8px 0; font-size:13px; color:${isOpen ? '#2e7d32' : '#d32f2f'}; font-weight:500;">
          ${isOpen ? '‚úÖ Otwarte' : '‚ùå Zamkniƒôte'} ‚Äî ${escapeHtml(todayRange)}
        </div>`;
      } else {
        openingInfo = `<div style="margin:0 0 8px 0; font-size:13px; color:#666;">üïí Godziny: ${escapeHtml(el.tags.opening_hours)}</div>`;
      }
    } catch(e) {
      openingInfo = `<div style="margin:0 0 8px 0; font-size:13px; color:#666;">üïí Godziny: ${escapeHtml(el.tags.opening_hours)}</div>`;
    }
  }

  // Tutaj zaczyna siƒô dos≈Çowny HTML popupu (kopiowany z Index(3))
  let popupContent = `
    <div style="min-width: 250px; font-family: 'Inter', sans-serif;">
      <h3 style="margin: 0 0 8px 0; font-family: 'Pops', sans-serif; font-weight: 600; color: #333; font-size: 16px;">
        ${displayName}
      </h3>
      ${openingInfo}
      <p style="margin: 0 0 8px 0; color: #666; font-size: 14px;">
        <i class="fas fa-map-marker-alt" style="margin-right: 4px;"></i>
        ${addr}
      </p>
      <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px; flex-wrap: wrap;">
        <span style="background: ${color}; color: white; padding: 6px 8px; border-radius: 12px; font-size: 12px; font-weight: 500;">
          ${description}
        </span>
      `;

  // opcjonalne przyciski (Telefon / Strona / Dodaj opiniƒô / Nawigacja)
  popupContent += `<div style="display:flex; gap:6px; margin-top:6px; flex-wrap:wrap;">`;

  if (phone) {
    popupContent += `
      <a href="tel:${phone}">
        <button style="background:#1976d2; color:#fff; border-radius:6px; padding:6px 8px; border:none; cursor:pointer; font-size:11px;">
          <i class="fas fa-phone"></i> Zadzwo≈Ñ
        </button>
      </a>
    `;
  }

  if (website) {
    popupContent += `
      <a href="${website}" target="_blank" rel="noopener">
        <button style="background:#616161; color:#fff; border-radius:6px; padding:6px 8px; border:none; cursor:pointer; font-size:11px;">
          <i class="fas fa-link"></i> Strona
        </button>
      </a>
    `;
  }
popupContent += `




  <button onclick="openNavigation(${lat}, ${lon}, '${escapeHtml(displayName).replace(/'/g,"\\'")}')"
          style="background:#2e7d32; color:#fff; border-radius:6px; padding:6px 8px; border:none; cursor:pointer; font-size:11px;">
    <i class="fas fa-route"></i> Nawigacja
  </button>
</div>
`;

  

  // Always provide open in Google Maps
  popupContent += `
    <div style="display:grid; grid-template-columns: 1fr; gap:6px; margin-top:6px;">
      <button onclick="window.open('https://www.google.com/maps/dir//${lat},${lon}', '_blank')"
              style="background:#f57c00; color:white; border:none; border-radius:6px; padding:8px; font-size:11px;">
        <i class="fas fa-external-link-alt"></i> Otw√≥rz w Google Maps
      </button>
    </div>
  `;

  popupContent += `</div>`; // zamknij wrapper

  // Zwr√≥ƒá gotowy HTML popupu (tak, aby index(4).js m√≥g≈Ç je bindowaƒá)
  return popupContent;
}
/* --- pomocnicze --- */
function escapeHtml(str) {
  if (!str) return '';
  return String(str).replace(/[&<>"']/g, function (s) {
    return ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[s]);
  });
}
function escapeHtmlAttr(s){ return escapeHtml(s); }
// global - id/coords aktualnej atrakcji, u≈ºywane przy wysy≈Çaniu opinii
window._currentAttractionForComment = null;

/**
 * Otwiera istniejƒÖcy modal opinii i prefilluje punkt docelowy.
 * Przyjmuje id (osm id) i opcjonalnie wsp√≥≈Çrzƒôdne + nazwƒô.
 */
function openCommentModalForAttraction(osmId, lat, lon, safeName) {
  currentPointForComment = osmId;
  window._currentAttractionForComment = { id: osmId, lat: lat, lon: lon, name: safeName };

  const modal = document.getElementById('comment-modal');
  if (!modal) return;
  const titleEl = document.getElementById('modal-point-name');
  if (titleEl) titleEl.textContent = (safeName || 'Wybrana atrakcja');

  const form = document.getElementById('comment-form');
  if (form) form.reset();
  selectedCommentStatus = null;
  selectedRating = 0;
  modal.classList.add('show');
  // fokus na textarea
  const ta = document.getElementById('comment-text');
  if (ta) setTimeout(() => ta.focus(), 200);
}

/**
 * Funkcja pomocnicza do u≈ºycia po submit'cie formularza opinii.
 * Zak≈Çada, ≈ºe masz handler submit (id="comment-form") ‚Äî w handlerze mo≈ºesz odczytaƒá window._currentAttractionForComment
 * i zapisaƒá opiniƒô w localStorage / backend. Tu tylko pokazujƒô helper do czyszczenia kontekstu.
 */
function clearCurrentAttractionForComment() {
  window._currentAttractionForComment = null;
}
</script>


<script>
function openFilterPanel() {
  document.getElementById("filter-modal").classList.remove("hidden");
}
function closeFilterModal() {
  document.getElementById("filter-modal").classList.add("hidden");
}
</script>


<!-- NOWY FILTER MODAL -->
<div class="attractions-modal hidden" id="filter-modal" aria-hidden="true" role="dialog" aria-label="Filtry punkt√≥w na mapie" style="position:fixed; inset:0; display:flex; align-items:center; justify-content:center; z-index:9999;">
  <div class="modal-backdrop" onclick="closeFilterModal()" style="position:fixed; inset:0; background:rgba(0,0,0,0.35);"></div>
  <div class="modal-card" style="max-width:520px; padding:0; background:#fff; border-radius:10px; box-shadow:0 8px 30px rgba(0,0,0,0.12);position:relative; z-index:10000;">
    <button class="close-btn" aria-label="Zamknij filtr" onclick="closeFilterModal()" style="position:absolute; right:8px; top:8px; border:none; background:transparent; font-size:20px;">√ó</button>

    <div style="padding:1rem 1.25rem; border-bottom:1px solid #eee; display:flex; align-items:center; justify-content:space-between; gap:0.75rem;">
      <div>
        <h3 style="margin:0; font-size:1.05rem;">Filtruj punkty na mapie</h3>
        <div style="font-size:0.9rem; color:#666; margin-top:0.25rem;">Wybierz kategorie‚Äù.</div>
      </div>
      <div style="display:flex; flex-direction:column; gap:0.35rem;">
        <button class="filter-btn filter-all-btn" onclick="selectAllFilters(); updateFilterModalCounts();" style="font-size:0.70rem; padding:0.45rem 0.6rem;">Zaznacz wszystkie</button>
        <button class="filter-btn filter-none-btn" onclick="deselectAllFilters(); updateFilterModalCounts();" style="font-size:0.70rem; padding:0.45rem 0.6rem;">Odznacz wszystkie</button>
      </div>
    </div>

    <div id="filter-modal-body" style="padding:0.75rem 1rem; max-height:62vh; overflow:auto;">
      <div id="filter-list" style="display:grid; grid-template-columns: 1fr; gap:0.5rem;"></div>
    </div>
  </div>
</div>

<script>
const FILTER_META = [
  { key: 'drinking_water', label: 'Wodopoje', emoji: 'üíß' },
  { key: 'toilets_free', label: 'Toalety (bezp≈Çatne)', emoji: 'üöΩ' },
  { key: 'toilets_paid', label: 'Toalety (p≈Çatne)', emoji: 'üöæ' },
  { key: 'toilets_unknown', label: 'Toalety (brak info)', emoji: 'üöª' },
  { key: 'atm', label: 'Bankomaty', emoji: 'üèß' },
  { key: 'pharmacy', label: 'Apteki', emoji: 'üíä' },
  { key: 'skatepark', label: 'Skateparki', emoji: 'üõπ' },
  { key: 'playground', label: 'Place zabaw', emoji: 'üõù' },
  { key: 'restaurant', label: 'Restauracje', emoji: 'üçΩ' }
];

function openFilterPanel() {
  const modal = document.getElementById('filter-modal');
  modal.classList.remove('hidden');
  modal.setAttribute('aria-hidden', 'false');
  buildFilterModal();
}

function closeFilterModal() {
  const modal = document.getElementById('filter-modal');
  modal.classList.add('hidden');
  modal.setAttribute('aria-hidden', 'true');
}

function buildFilterModal() {
  const container = document.getElementById('filter-list');
  container.innerHTML = '';
  FILTER_META.forEach(meta => {
    const item = document.createElement('div');
    item.className = 'filter-item';
    item.style.display = 'flex';
    item.style.justifyContent = 'space-between';
    item.style.alignItems = 'center';
    item.style.cursor = 'pointer';
    item.setAttribute('data-type', meta.key);
    item.innerHTML = `
      <div style="display:flex; align-items:center; gap:0.6rem;">
        <div class="filter-checkbox" style="width:22px;height:22px;border-radius:6px;border:2px solid #ccc;display:flex;align-items:center;justify-content:center;"></div>
        <div style="min-width:28px;text-align:center;font-size:1.2rem;">${meta.emoji}</div>
        <div style="display:flex;flex-direction:column;">
          <div style="font-weight:600;">${meta.label}</div>
          <div class="filter-count" style="font-size:0.85rem;color:#666;">0/0</div>
        </div>
      </div>
    `;
    item.addEventListener('click', () => {
      toggleFilter(meta.key);
      updateFilterModalCounts();
    });
    container.appendChild(item);
  });
  updateFilterModalCounts();
}

function updateFilterModalCounts() {
  const totals = {}; const visibles = {};
  FILTER_META.forEach(m => { totals[m.key]=0; visibles[m.key]=0; });
  if(window.elements) {
    elements.forEach(el => {
      const t = getFilterType(el);
      if(t && totals.hasOwnProperty(t)) totals[t]++;
    });
  }
  if(window.markersLayers) {
    Object.entries(markersLayers).forEach(([k,layer])=>{
      if(!(k in visibles)) return;
      const cnt = layer.getLayers().length;
      const onMap = map.hasLayer(layer);
      visibles[k] = onMap ? cnt : 0;
    });
  }
  document.querySelectorAll('#filter-list .filter-item').forEach(item => {
    const key=item.getAttribute('data-type');
    const countEl=item.querySelector('.filter-count');
    const checkbox=item.querySelector('.filter-checkbox');
    const active=activeFilters.has(key);
    const nameEl = item.querySelector('.filter-name');
if (nameEl) {
  const base = nameEl.textContent.split(' (')[0].trim();
  nameEl.textContent = `${base} (${totals[key]||0})`;
}
if (countEl) countEl.textContent = '';
    if(active) {
      item.style.background='rgba(0,122,255,0.06)';
      checkbox.style.background='rgb(0,122,255)';
      checkbox.style.borderColor='rgb(0,122,255)';
      checkbox.style.color='#fff';
      checkbox.innerHTML='‚úì';
    } else {
      item.style.background='transparent';
      checkbox.style.background='white';
      checkbox.style.borderColor='#ccc';
      checkbox.style.color='#000';
      checkbox.innerHTML='';
    }
  });
}

(function wrap(name){
  if(typeof window[name]==='function'){
    const orig=window[name];
    window[name]=function(){
      const r=orig.apply(this,arguments);
      updateFilterModalCounts();
      return r;
    }
  }
})('toggleFilter');
(function wrap(name){
  if(typeof window[name]==='function'){
    const orig=window[name];
    window[name]=function(){
      const r=orig.apply(this,arguments);
      updateFilterModalCounts();
      return r;
    }
  }
})('selectAllFilters');
(function wrap(name){
  if(typeof window[name]==='function'){
    const orig=window[name];
    window[name]=function(){
      const r=orig.apply(this,arguments);
      updateFilterModalCounts();
      return r;
    }
  }
})('deselectAllFilters');

document.addEventListener('DOMContentLoaded',()=>{
  const btn=document.getElementById('open-filter-btn');
  if(btn){ btn.style.display='flex'; btn.onclick=openFilterPanel; }
});
</script>
<script>
  [out:json][timeout:1800];
area["ISO3166-1"="PL"][admin_level=2]->.polska;
(
  node["amenity"="drinking_water"](area.polska);
  node["amenity"="toilets"](area.polska);
  node["amenity"="atm"](area.polska);
  node["amenity"="pharmacy"](area.polska);
  node["leisure"="skatepark"](area.polska);
  node["leisure"="playground"](area.polska);
  node["amenity"="restaurant"](area.polska);
);
out center;
</script>
<script>
(function(){
  const allowed = new Set(['drinking_water','toilets_free','toilets_paid','toilets_unknown']);
  function enforceFiltersOnce() {
    const items = document.querySelectorAll('.filter-item');
    if (!items || items.length === 0) return false;
    items.forEach(el => {
      const type = el.getAttribute('data-type');
      const shouldBeActive = allowed.has(type);
      const isActive = el.classList.contains('active');
      // Je≈õli istnieje funkcja toggleFilter, u≈ºyj jej do synchronizacji mapy i UI
      if (typeof window.toggleFilter === 'function') {
        if (isActive !== shouldBeActive) {
          try {
            window.toggleFilter(type);
          } catch (e) {
            if (shouldBeActive) el.classList.add('active');
            else el.classList.remove('active');
          }
        }
      } else {
        // Fallback ‚Äì tylko ustawienie klas
        if (shouldBeActive) el.classList.add('active');
        else el.classList.remove('active');
      }
    });
    return true;
  }

  // Kilka pr√≥b, ≈ºeby nadpisaƒá inicjalizacjƒô innych skrypt√≥w
  document.addEventListener('DOMContentLoaded', function(){
    enforceFiltersOnce();
    setTimeout(enforceFiltersOnce, 300);
    setTimeout(enforceFiltersOnce, 1200);
    window.addEventListener('load', function(){
      setTimeout(enforceFiltersOnce, 200);
      setTimeout(enforceFiltersOnce, 800);
    });
  });
})();
</script> 
</body>
</html>
